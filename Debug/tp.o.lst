   1              		.cpu arm7tdmi
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 18, 4
  11              		.file	"tp.c"
  21              	.Ltext0:
  22              		.file 1 "../tp.c"
 2124              		.align	2
 2125              	g_swap_xy:
 2126 0000 00000000 		.space	4
 2127              		.align	2
 2128              	g_kx_fp:
 2129 0004 00000000 		.space	4
 2130              		.align	2
 2131              	g_ky_fp:
 2132 0008 00000000 		.space	4
 2133              		.align	2
 2134              	g_ts_xc:
 2135 000c 00000000 		.space	4
 2136              		.align	2
 2137              	g_ts_yc:
 2138 0010 00000000 		.space	4
 2139              		.align	2
 2140              	g_lcd_xc:
 2141 0014 00000000 		.space	4
 2142              		.align	2
 2143              	g_lcd_yc:
 2144 0018 00000000 		.space	4
 2145              		.align	2
 2146              	g_ts_ready:
 2147 001c 00000000 		.space	4
 2148              		.align	2
 2149              	g_ts_raw_x:
 2150 0020 00000000 		.space	4
 2151              		.align	2
 2152              	g_ts_raw_y:
 2153 0024 00000000 		.space	4
 2154              		.align	2
 2155              	g_last_touch_time:
 2156 0028 00000000 		.space	4
 2157              		.text
 2158              		.align	2
 2159              		.global	TS_Test
 2161              	TS_Test:
 2162              	.LFB0:
   1:../tp.c       **** /*********************************************************************************************
   2:../tp.c       **** * File��	tp.c
   3:../tp.c       **** * Author:	embest	
   4:../tp.c       **** * Desc��	LCD touch screen control function
   5:../tp.c       **** * History:	
   6:../tp.c       **** *********************************************************************************************/
   7:../tp.c       **** 
   8:../tp.c       **** /*--- include files ---*/
   9:../tp.c       **** #include "tp.h"
  10:../tp.c       **** #include "lcd.h"
  11:../tp.c       **** #include "timer2.h"
  12:../tp.c       **** 
  13:../tp.c       **** void TSInt(void) __attribute__((interrupt("IRQ")));
  14:../tp.c       **** 
  15:../tp.c       **** /*===================================================================================
  16:../tp.c       ****  * VARIABLES GLOBALES DE CALIBRACIÓN (Método 5 puntos)
  17:../tp.c       ****  *===================================================================================*/
  18:../tp.c       **** static int g_swap_xy = 0;           // 1 si los ejes están intercambiados
  19:../tp.c       **** static long g_kx_fp;                // Factor de escala X en formato 16.16 fixed-point
  20:../tp.c       **** static long g_ky_fp;                // Factor de escala Y en formato 16.16 fixed-point
  21:../tp.c       **** static int g_ts_xc;                 // Centro X crudo del touch
  22:../tp.c       **** static int g_ts_yc;                 // Centro Y crudo del touch
  23:../tp.c       **** static int g_lcd_xc;                // Centro X del LCD
  24:../tp.c       **** static int g_lcd_yc;                // Centro Y del LCD
  25:../tp.c       **** static volatile int g_ts_ready = 0; // Flag para indicar que hay datos del touch
  26:../tp.c       **** static int g_ts_raw_x;              // Última lectura X cruda
  27:../tp.c       **** static int g_ts_raw_y;              // Última lectura Y cruda
  28:../tp.c       **** static unsigned int g_last_touch_time = 0;  // Último tiempo de toque válido (microsegundos)
  29:../tp.c       **** #define TOUCH_DEBOUNCE_TIME 300000  // Tiempo mínimo entre toques: 300ms = 300000us
  30:../tp.c       **** 
  31:../tp.c       **** void TS_Test(void)
  32:../tp.c       **** {
 2163              		.loc 1 32 0
 2164              		.cfi_startproc
 2165              		@ Function supports interworking.
 2166              		@ args = 0, pretend = 0, frame = 0
 2167              		@ frame_needed = 1, uses_anonymous_args = 0
 2168 0000 0DC0A0E1 		mov	ip, sp
 2169              	.LCFI0:
 2170              		.cfi_def_cfa_register 12
 2171 0004 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2172 0008 04B04CE2 		sub	fp, ip, #4
 2173              		.cfi_offset 14, -8
 2174              		.cfi_offset 13, -12
 2175              		.cfi_offset 11, -16
 2176              	.LCFI1:
 2177              		.cfi_def_cfa 11, 4
  33:../tp.c       **** 		Lcd_TC();
 2178              		.loc 1 33 0
 2179 000c FEFFFFEB 		bl	Lcd_TC
  34:../tp.c       **** 		TS_init();
 2180              		.loc 1 34 0
 2181 0010 FEFFFFEB 		bl	TS_init
  35:../tp.c       **** 		Check_Sel();
 2182              		.loc 1 35 0
 2183 0014 FEFFFFEB 		bl	Check_Sel
  36:../tp.c       **** 			
  37:../tp.c       **** }
 2184              		.loc 1 37 0
 2185 0018 0CD04BE2 		sub	sp, fp, #12
 2186 001c 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2187 0020 1EFF2FE1 		bx	lr
 2188              		.cfi_endproc
 2189              	.LFE0:
 2191              		.global	__aeabi_uidiv
 2192              		.align	2
 2193              		.global	TSInt
 2195              	TSInt:
 2196              	.LFB1:
  38:../tp.c       **** /*--- function code ---*/
  39:../tp.c       **** /*********************************************************************************************
  40:../tp.c       **** * name:		TSInt
  41:../tp.c       **** * func:		TouchScreen interrupt handler function
  42:../tp.c       **** * para:		none
  43:../tp.c       **** * ret:		none
  44:../tp.c       **** * modify:
  45:../tp.c       **** * comment:		
  46:../tp.c       **** ********************************************************************************************/
  47:../tp.c       **** void TSInt(void)
  48:../tp.c       **** {
 2197              		.loc 1 48 0
 2198              		.cfi_startproc
 2199              		@ Interrupt Service Routine.
 2200              		@ args = 0, pretend = 0, frame = 64
 2201              		@ frame_needed = 1, uses_anonymous_args = 0
 2202 0024 04C02DE5 		str	ip, [sp, #-4]!
 2203 0028 0DC0A0E1 		mov	ip, sp
 2204              	.LCFI2:
 2205              		.cfi_def_cfa_register 12
 2206 002c 0FD82DE9 		stmfd	sp!, {r0, r1, r2, r3, fp, ip, lr, pc}
 2207 0030 04B04CE2 		sub	fp, ip, #4
 2208              		.cfi_offset 14, -8
 2209              		.cfi_offset 13, -12
 2210              		.cfi_offset 11, -16
 2211              		.cfi_offset 3, -20
 2212              		.cfi_offset 2, -24
 2213              		.cfi_offset 1, -28
 2214              		.cfi_offset 0, -32
 2215              	.LCFI3:
 2216              		.cfi_def_cfa 11, 4
 2217 0034 40D04DE2 		sub	sp, sp, #64
  49:../tp.c       ****     int   i, j;
  50:../tp.c       ****     ULONG tmp;
  51:../tp.c       ****     ULONG Pt[11];  /* Aumentado a 11 para almacenar 10 muestras + promedio */
  52:../tp.c       ****     ULONG swap;    /* Variable para ordenamiento */
  53:../tp.c       **** 
  54:../tp.c       **** 	// <X-Position Read>
  55:../tp.c       **** 	// TSPX(GPE4_Q4(+)) TSPY(GPE5_Q3(-)) TSMY(GPE6_Q2(+)) TSMX(GPE7_Q1(-))
  56:../tp.c       ****     //       0               1                 1                0
  57:../tp.c       **** 	rPDATE=0x68;
 2218              		.loc 1 57 0
 2219 0038 7C359FE5 		ldr	r3, .L23
 2220 003c 6820A0E3 		mov	r2, #104
 2221 0040 002083E5 		str	r2, [r3, #0]
  58:../tp.c       **** 	rADCCON=0x1<<2;			// AIN1
 2222              		.loc 1 58 0
 2223 0044 7537A0E3 		mov	r3, #30670848
 2224 0048 0420A0E3 		mov	r2, #4
 2225 004c 002083E5 		str	r2, [r3, #0]
  59:../tp.c       **** 	
  60:../tp.c       **** 	DelayTime(2000);                // delay más largo para mejor estabilización
 2226              		.loc 1 60 0
 2227 0050 7D0EA0E3 		mov	r0, #2000
 2228 0054 FEFFFFEB 		bl	DelayTime
  61:../tp.c       **** 	for( i=0; i<10; i++ )
 2229              		.loc 1 61 0
 2230 0058 0030A0E3 		mov	r3, #0
 2231 005c 20300BE5 		str	r3, [fp, #-32]
 2232 0060 210000EA 		b	.L3
 2233              	.L6:
  62:../tp.c       **** 	{
  63:../tp.c       **** 		rADCCON |= 0x1;				// Start X-position A/D conversion
 2234              		.loc 1 63 0
 2235 0064 7537A0E3 		mov	r3, #30670848
 2236 0068 7527A0E3 		mov	r2, #30670848
 2237 006c 002092E5 		ldr	r2, [r2, #0]
 2238 0070 012082E3 		orr	r2, r2, #1
 2239 0074 002083E5 		str	r2, [r3, #0]
  64:../tp.c       **** 	    while( rADCCON & 0x1 );		// Check if Enable_start is low
 2240              		.loc 1 64 0
 2241 0078 0000A0E1 		mov	r0, r0	@ nop
 2242              	.L4:
 2243              		.loc 1 64 0 is_stmt 0 discriminator 1
 2244 007c 7537A0E3 		mov	r3, #30670848
 2245 0080 003093E5 		ldr	r3, [r3, #0]
 2246 0084 013003E2 		and	r3, r3, #1
 2247 0088 FF3003E2 		and	r3, r3, #255
 2248 008c 000053E3 		cmp	r3, #0
 2249 0090 F9FFFF1A 		bne	.L4
  65:../tp.c       ****     	while( !(rADCCON & 0x40) );	// Check ECFLG
 2250              		.loc 1 65 0 is_stmt 1
 2251 0094 0000A0E1 		mov	r0, r0	@ nop
 2252              	.L5:
 2253              		.loc 1 65 0 is_stmt 0 discriminator 1
 2254 0098 7537A0E3 		mov	r3, #30670848
 2255 009c 003093E5 		ldr	r3, [r3, #0]
 2256 00a0 403003E2 		and	r3, r3, #64
 2257 00a4 000053E3 		cmp	r3, #0
 2258 00a8 FAFFFF0A 		beq	.L5
  66:../tp.c       **** 	    Pt[i] = (0x3ff&rADCDAT);
 2259              		.loc 1 66 0 is_stmt 1
 2260 00ac 0C359FE5 		ldr	r3, .L23+4
 2261 00b0 003093E5 		ldr	r3, [r3, #0]
 2262 00b4 033BA0E1 		mov	r3, r3, asl #22
 2263 00b8 233BA0E1 		mov	r3, r3, lsr #22
 2264 00bc 20101BE5 		ldr	r1, [fp, #-32]
 2265 00c0 3B20E0E3 		mvn	r2, #59
 2266 00c4 0111A0E1 		mov	r1, r1, asl #2
 2267 00c8 1C004BE2 		sub	r0, fp, #28
 2268 00cc 011080E0 		add	r1, r0, r1
 2269 00d0 022081E0 		add	r2, r1, r2
 2270 00d4 003082E5 		str	r3, [r2, #0]
  67:../tp.c       **** 	    DelayTime(100);             // Pequeño delay entre lecturas
 2271              		.loc 1 67 0
 2272 00d8 6400A0E3 		mov	r0, #100
 2273 00dc FEFFFFEB 		bl	DelayTime
  61:../tp.c       **** 	for( i=0; i<10; i++ )
 2274              		.loc 1 61 0
 2275 00e0 20301BE5 		ldr	r3, [fp, #-32]
 2276 00e4 013083E2 		add	r3, r3, #1
 2277 00e8 20300BE5 		str	r3, [fp, #-32]
 2278              	.L3:
  61:../tp.c       **** 	for( i=0; i<10; i++ )
 2279              		.loc 1 61 0 is_stmt 0 discriminator 1
 2280 00ec 20301BE5 		ldr	r3, [fp, #-32]
 2281 00f0 090053E3 		cmp	r3, #9
 2282 00f4 DAFFFFDA 		ble	.L6
  68:../tp.c       **** 	}
  69:../tp.c       **** 	
  70:../tp.c       **** 	// Ordenar muestras para eliminar extremos (bubble sort simple)
  71:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2283              		.loc 1 71 0 is_stmt 1
 2284 00f8 0030A0E3 		mov	r3, #0
 2285 00fc 20300BE5 		str	r3, [fp, #-32]
 2286 0100 3E0000EA 		b	.L7
 2287              	.L11:
  72:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2288              		.loc 1 72 0
 2289 0104 0030A0E3 		mov	r3, #0
 2290 0108 24300BE5 		str	r3, [fp, #-36]
 2291 010c 330000EA 		b	.L8
 2292              	.L10:
  73:../tp.c       **** 	        if (Pt[j] > Pt[j + 1]) {
 2293              		.loc 1 73 0
 2294 0110 24201BE5 		ldr	r2, [fp, #-36]
 2295 0114 3B30E0E3 		mvn	r3, #59
 2296 0118 0221A0E1 		mov	r2, r2, asl #2
 2297 011c 1C104BE2 		sub	r1, fp, #28
 2298 0120 022081E0 		add	r2, r1, r2
 2299 0124 033082E0 		add	r3, r2, r3
 2300 0128 002093E5 		ldr	r2, [r3, #0]
 2301 012c 24301BE5 		ldr	r3, [fp, #-36]
 2302 0130 011083E2 		add	r1, r3, #1
 2303 0134 3B30E0E3 		mvn	r3, #59
 2304 0138 0111A0E1 		mov	r1, r1, asl #2
 2305 013c 1C004BE2 		sub	r0, fp, #28
 2306 0140 011080E0 		add	r1, r0, r1
 2307 0144 033081E0 		add	r3, r1, r3
 2308 0148 003093E5 		ldr	r3, [r3, #0]
 2309 014c 030052E1 		cmp	r2, r3
 2310 0150 1F00009A 		bls	.L9
  74:../tp.c       **** 	            swap = Pt[j];
 2311              		.loc 1 74 0
 2312 0154 24201BE5 		ldr	r2, [fp, #-36]
 2313 0158 3B30E0E3 		mvn	r3, #59
 2314 015c 0221A0E1 		mov	r2, r2, asl #2
 2315 0160 1C104BE2 		sub	r1, fp, #28
 2316 0164 022081E0 		add	r2, r1, r2
 2317 0168 033082E0 		add	r3, r2, r3
 2318 016c 003093E5 		ldr	r3, [r3, #0]
 2319 0170 2C300BE5 		str	r3, [fp, #-44]
  75:../tp.c       **** 	            Pt[j] = Pt[j + 1];
 2320              		.loc 1 75 0
 2321 0174 24301BE5 		ldr	r3, [fp, #-36]
 2322 0178 012083E2 		add	r2, r3, #1
 2323 017c 3B30E0E3 		mvn	r3, #59
 2324 0180 0221A0E1 		mov	r2, r2, asl #2
 2325 0184 1C004BE2 		sub	r0, fp, #28
 2326 0188 022080E0 		add	r2, r0, r2
 2327 018c 033082E0 		add	r3, r2, r3
 2328 0190 002093E5 		ldr	r2, [r3, #0]
 2329 0194 24101BE5 		ldr	r1, [fp, #-36]
 2330 0198 3B30E0E3 		mvn	r3, #59
 2331 019c 0111A0E1 		mov	r1, r1, asl #2
 2332 01a0 1C004BE2 		sub	r0, fp, #28
 2333 01a4 011080E0 		add	r1, r0, r1
 2334 01a8 033081E0 		add	r3, r1, r3
 2335 01ac 002083E5 		str	r2, [r3, #0]
  76:../tp.c       **** 	            Pt[j + 1] = swap;
 2336              		.loc 1 76 0
 2337 01b0 24301BE5 		ldr	r3, [fp, #-36]
 2338 01b4 012083E2 		add	r2, r3, #1
 2339 01b8 3B30E0E3 		mvn	r3, #59
 2340 01bc 0221A0E1 		mov	r2, r2, asl #2
 2341 01c0 1C104BE2 		sub	r1, fp, #28
 2342 01c4 022081E0 		add	r2, r1, r2
 2343 01c8 033082E0 		add	r3, r2, r3
 2344 01cc 2C201BE5 		ldr	r2, [fp, #-44]
 2345 01d0 002083E5 		str	r2, [r3, #0]
 2346              	.L9:
  72:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2347              		.loc 1 72 0
 2348 01d4 24301BE5 		ldr	r3, [fp, #-36]
 2349 01d8 013083E2 		add	r3, r3, #1
 2350 01dc 24300BE5 		str	r3, [fp, #-36]
 2351              	.L8:
  72:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2352              		.loc 1 72 0 is_stmt 0 discriminator 1
 2353 01e0 20301BE5 		ldr	r3, [fp, #-32]
 2354 01e4 092063E2 		rsb	r2, r3, #9
 2355 01e8 24301BE5 		ldr	r3, [fp, #-36]
 2356 01ec 030052E1 		cmp	r2, r3
 2357 01f0 C6FFFFCA 		bgt	.L10
  71:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2358              		.loc 1 71 0 is_stmt 1
 2359 01f4 20301BE5 		ldr	r3, [fp, #-32]
 2360 01f8 013083E2 		add	r3, r3, #1
 2361 01fc 20300BE5 		str	r3, [fp, #-32]
 2362              	.L7:
  71:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2363              		.loc 1 71 0 is_stmt 0 discriminator 1
 2364 0200 20301BE5 		ldr	r3, [fp, #-32]
 2365 0204 080053E3 		cmp	r3, #8
 2366 0208 BDFFFFDA 		ble	.L11
  77:../tp.c       **** 	        }
  78:../tp.c       **** 	    }
  79:../tp.c       **** 	}
  80:../tp.c       **** 	// Promedio de las 6 muestras centrales (descartando 2 máximas y 2 mínimas)
  81:../tp.c       **** 	Pt[10] = (Pt[2] + Pt[3] + Pt[4] + Pt[5] + Pt[6] + Pt[7]) / 6;
 2367              		.loc 1 81 0 is_stmt 1
 2368 020c 50201BE5 		ldr	r2, [fp, #-80]
 2369 0210 4C301BE5 		ldr	r3, [fp, #-76]
 2370 0214 032082E0 		add	r2, r2, r3
 2371 0218 48301BE5 		ldr	r3, [fp, #-72]
 2372 021c 032082E0 		add	r2, r2, r3
 2373 0220 44301BE5 		ldr	r3, [fp, #-68]
 2374 0224 032082E0 		add	r2, r2, r3
 2375 0228 40301BE5 		ldr	r3, [fp, #-64]
 2376 022c 032082E0 		add	r2, r2, r3
 2377 0230 3C301BE5 		ldr	r3, [fp, #-60]
 2378 0234 032082E0 		add	r2, r2, r3
 2379 0238 84339FE5 		ldr	r3, .L23+8
 2380 023c 920383E0 		umull	r0, r3, r2, r3
 2381 0240 2331A0E1 		mov	r3, r3, lsr #2
 2382 0244 30300BE5 		str	r3, [fp, #-48]
  82:../tp.c       **** 	
  83:../tp.c       **** 	tmp = Pt[10];	
 2383              		.loc 1 83 0
 2384 0248 30301BE5 		ldr	r3, [fp, #-48]
 2385 024c 28300BE5 		str	r3, [fp, #-40]
  84:../tp.c       **** 	
  85:../tp.c       ****     // <Y-Position Read>
  86:../tp.c       **** 	// TSPX(GPE4_Q4(-)) TSPY(GPE5_Q3(+)) TSMY(GPE6_Q2(-)) TSMX(GPE7_Q1(+))
  87:../tp.c       ****     //       1               0                 0                1
  88:../tp.c       **** 	rPDATE=0x98;
 2386              		.loc 1 88 0
 2387 0250 64339FE5 		ldr	r3, .L23
 2388 0254 9820A0E3 		mov	r2, #152
 2389 0258 002083E5 		str	r2, [r3, #0]
  89:../tp.c       **** 	rADCCON=0x0<<2;		        	// AIN0
 2390              		.loc 1 89 0
 2391 025c 7537A0E3 		mov	r3, #30670848
 2392 0260 0020A0E3 		mov	r2, #0
 2393 0264 002083E5 		str	r2, [r3, #0]
  90:../tp.c       **** 	
  91:../tp.c       **** 	DelayTime(2000);                // delay más largo para mejor estabilización
 2394              		.loc 1 91 0
 2395 0268 7D0EA0E3 		mov	r0, #2000
 2396 026c FEFFFFEB 		bl	DelayTime
  92:../tp.c       **** 	for( i=0; i<10; i++ )
 2397              		.loc 1 92 0
 2398 0270 0030A0E3 		mov	r3, #0
 2399 0274 20300BE5 		str	r3, [fp, #-32]
 2400 0278 210000EA 		b	.L12
 2401              	.L15:
  93:../tp.c       **** 	{
  94:../tp.c       ****     	rADCCON |= 0x1;             // Start Y-position conversion
 2402              		.loc 1 94 0
 2403 027c 7537A0E3 		mov	r3, #30670848
 2404 0280 7527A0E3 		mov	r2, #30670848
 2405 0284 002092E5 		ldr	r2, [r2, #0]
 2406 0288 012082E3 		orr	r2, r2, #1
 2407 028c 002083E5 		str	r2, [r3, #0]
  95:../tp.c       **** 	    while( rADCCON & 0x1 );     // Check if Enable_start is low
 2408              		.loc 1 95 0
 2409 0290 0000A0E1 		mov	r0, r0	@ nop
 2410              	.L13:
 2411              		.loc 1 95 0 is_stmt 0 discriminator 1
 2412 0294 7537A0E3 		mov	r3, #30670848
 2413 0298 003093E5 		ldr	r3, [r3, #0]
 2414 029c 013003E2 		and	r3, r3, #1
 2415 02a0 FF3003E2 		and	r3, r3, #255
 2416 02a4 000053E3 		cmp	r3, #0
 2417 02a8 F9FFFF1A 		bne	.L13
  96:../tp.c       ****     	while( !(rADCCON & 0x40) ); // Check ECFLG
 2418              		.loc 1 96 0 is_stmt 1
 2419 02ac 0000A0E1 		mov	r0, r0	@ nop
 2420              	.L14:
 2421              		.loc 1 96 0 is_stmt 0 discriminator 1
 2422 02b0 7537A0E3 		mov	r3, #30670848
 2423 02b4 003093E5 		ldr	r3, [r3, #0]
 2424 02b8 403003E2 		and	r3, r3, #64
 2425 02bc 000053E3 		cmp	r3, #0
 2426 02c0 FAFFFF0A 		beq	.L14
  97:../tp.c       **** 	    Pt[i] = (0x3ff&rADCDAT);
 2427              		.loc 1 97 0 is_stmt 1
 2428 02c4 F4329FE5 		ldr	r3, .L23+4
 2429 02c8 003093E5 		ldr	r3, [r3, #0]
 2430 02cc 033BA0E1 		mov	r3, r3, asl #22
 2431 02d0 233BA0E1 		mov	r3, r3, lsr #22
 2432 02d4 20101BE5 		ldr	r1, [fp, #-32]
 2433 02d8 3B20E0E3 		mvn	r2, #59
 2434 02dc 0111A0E1 		mov	r1, r1, asl #2
 2435 02e0 1C004BE2 		sub	r0, fp, #28
 2436 02e4 011080E0 		add	r1, r0, r1
 2437 02e8 022081E0 		add	r2, r1, r2
 2438 02ec 003082E5 		str	r3, [r2, #0]
  98:../tp.c       **** 	    DelayTime(100);             // Pequeño delay entre lecturas
 2439              		.loc 1 98 0
 2440 02f0 6400A0E3 		mov	r0, #100
 2441 02f4 FEFFFFEB 		bl	DelayTime
  92:../tp.c       **** 	for( i=0; i<10; i++ )
 2442              		.loc 1 92 0
 2443 02f8 20301BE5 		ldr	r3, [fp, #-32]
 2444 02fc 013083E2 		add	r3, r3, #1
 2445 0300 20300BE5 		str	r3, [fp, #-32]
 2446              	.L12:
  92:../tp.c       **** 	for( i=0; i<10; i++ )
 2447              		.loc 1 92 0 is_stmt 0 discriminator 1
 2448 0304 20301BE5 		ldr	r3, [fp, #-32]
 2449 0308 090053E3 		cmp	r3, #9
 2450 030c DAFFFFDA 		ble	.L15
  99:../tp.c       **** 	}
 100:../tp.c       **** 	
 101:../tp.c       **** 	// Ordenar muestras para eliminar extremos
 102:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2451              		.loc 1 102 0 is_stmt 1
 2452 0310 0030A0E3 		mov	r3, #0
 2453 0314 20300BE5 		str	r3, [fp, #-32]
 2454 0318 3E0000EA 		b	.L16
 2455              	.L20:
 103:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2456              		.loc 1 103 0
 2457 031c 0030A0E3 		mov	r3, #0
 2458 0320 24300BE5 		str	r3, [fp, #-36]
 2459 0324 330000EA 		b	.L17
 2460              	.L19:
 104:../tp.c       **** 	        if (Pt[j] > Pt[j + 1]) {
 2461              		.loc 1 104 0
 2462 0328 24201BE5 		ldr	r2, [fp, #-36]
 2463 032c 3B30E0E3 		mvn	r3, #59
 2464 0330 0221A0E1 		mov	r2, r2, asl #2
 2465 0334 1C104BE2 		sub	r1, fp, #28
 2466 0338 022081E0 		add	r2, r1, r2
 2467 033c 033082E0 		add	r3, r2, r3
 2468 0340 002093E5 		ldr	r2, [r3, #0]
 2469 0344 24301BE5 		ldr	r3, [fp, #-36]
 2470 0348 011083E2 		add	r1, r3, #1
 2471 034c 3B30E0E3 		mvn	r3, #59
 2472 0350 0111A0E1 		mov	r1, r1, asl #2
 2473 0354 1C004BE2 		sub	r0, fp, #28
 2474 0358 011080E0 		add	r1, r0, r1
 2475 035c 033081E0 		add	r3, r1, r3
 2476 0360 003093E5 		ldr	r3, [r3, #0]
 2477 0364 030052E1 		cmp	r2, r3
 2478 0368 1F00009A 		bls	.L18
 105:../tp.c       **** 	            swap = Pt[j];
 2479              		.loc 1 105 0
 2480 036c 24201BE5 		ldr	r2, [fp, #-36]
 2481 0370 3B30E0E3 		mvn	r3, #59
 2482 0374 0221A0E1 		mov	r2, r2, asl #2
 2483 0378 1C104BE2 		sub	r1, fp, #28
 2484 037c 022081E0 		add	r2, r1, r2
 2485 0380 033082E0 		add	r3, r2, r3
 2486 0384 003093E5 		ldr	r3, [r3, #0]
 2487 0388 2C300BE5 		str	r3, [fp, #-44]
 106:../tp.c       **** 	            Pt[j] = Pt[j + 1];
 2488              		.loc 1 106 0
 2489 038c 24301BE5 		ldr	r3, [fp, #-36]
 2490 0390 012083E2 		add	r2, r3, #1
 2491 0394 3B30E0E3 		mvn	r3, #59
 2492 0398 0221A0E1 		mov	r2, r2, asl #2
 2493 039c 1C004BE2 		sub	r0, fp, #28
 2494 03a0 022080E0 		add	r2, r0, r2
 2495 03a4 033082E0 		add	r3, r2, r3
 2496 03a8 002093E5 		ldr	r2, [r3, #0]
 2497 03ac 24101BE5 		ldr	r1, [fp, #-36]
 2498 03b0 3B30E0E3 		mvn	r3, #59
 2499 03b4 0111A0E1 		mov	r1, r1, asl #2
 2500 03b8 1C004BE2 		sub	r0, fp, #28
 2501 03bc 011080E0 		add	r1, r0, r1
 2502 03c0 033081E0 		add	r3, r1, r3
 2503 03c4 002083E5 		str	r2, [r3, #0]
 107:../tp.c       **** 	            Pt[j + 1] = swap;
 2504              		.loc 1 107 0
 2505 03c8 24301BE5 		ldr	r3, [fp, #-36]
 2506 03cc 012083E2 		add	r2, r3, #1
 2507 03d0 3B30E0E3 		mvn	r3, #59
 2508 03d4 0221A0E1 		mov	r2, r2, asl #2
 2509 03d8 1C104BE2 		sub	r1, fp, #28
 2510 03dc 022081E0 		add	r2, r1, r2
 2511 03e0 033082E0 		add	r3, r2, r3
 2512 03e4 2C201BE5 		ldr	r2, [fp, #-44]
 2513 03e8 002083E5 		str	r2, [r3, #0]
 2514              	.L18:
 103:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2515              		.loc 1 103 0
 2516 03ec 24301BE5 		ldr	r3, [fp, #-36]
 2517 03f0 013083E2 		add	r3, r3, #1
 2518 03f4 24300BE5 		str	r3, [fp, #-36]
 2519              	.L17:
 103:../tp.c       **** 	    for (j = 0; j < 9 - i; j++) {
 2520              		.loc 1 103 0 is_stmt 0 discriminator 1
 2521 03f8 20301BE5 		ldr	r3, [fp, #-32]
 2522 03fc 092063E2 		rsb	r2, r3, #9
 2523 0400 24301BE5 		ldr	r3, [fp, #-36]
 2524 0404 030052E1 		cmp	r2, r3
 2525 0408 C6FFFFCA 		bgt	.L19
 102:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2526              		.loc 1 102 0 is_stmt 1
 2527 040c 20301BE5 		ldr	r3, [fp, #-32]
 2528 0410 013083E2 		add	r3, r3, #1
 2529 0414 20300BE5 		str	r3, [fp, #-32]
 2530              	.L16:
 102:../tp.c       **** 	for (i = 0; i < 9; i++) {
 2531              		.loc 1 102 0 is_stmt 0 discriminator 1
 2532 0418 20301BE5 		ldr	r3, [fp, #-32]
 2533 041c 080053E3 		cmp	r3, #8
 2534 0420 BDFFFFDA 		ble	.L20
 108:../tp.c       **** 	        }
 109:../tp.c       **** 	    }
 110:../tp.c       **** 	}
 111:../tp.c       **** 	// Promedio de las 6 muestras centrales (descartando 2 máximas y 2 mínimas)
 112:../tp.c       **** 	Pt[10] = (Pt[2] + Pt[3] + Pt[4] + Pt[5] + Pt[6] + Pt[7]) / 6;
 2535              		.loc 1 112 0 is_stmt 1
 2536 0424 50201BE5 		ldr	r2, [fp, #-80]
 2537 0428 4C301BE5 		ldr	r3, [fp, #-76]
 2538 042c 032082E0 		add	r2, r2, r3
 2539 0430 48301BE5 		ldr	r3, [fp, #-72]
 2540 0434 032082E0 		add	r2, r2, r3
 2541 0438 44301BE5 		ldr	r3, [fp, #-68]
 2542 043c 032082E0 		add	r2, r2, r3
 2543 0440 40301BE5 		ldr	r3, [fp, #-64]
 2544 0444 032082E0 		add	r2, r2, r3
 2545 0448 3C301BE5 		ldr	r3, [fp, #-60]
 2546 044c 032082E0 		add	r2, r2, r3
 2547 0450 6C319FE5 		ldr	r3, .L23+8
 2548 0454 920383E0 		umull	r0, r3, r2, r3
 2549 0458 2331A0E1 		mov	r3, r3, lsr #2
 2550 045c 30300BE5 		str	r3, [fp, #-48]
 113:../tp.c       **** 	
 114:../tp.c       **** 	// Reportar coordenadas crudas para calibración
 115:../tp.c       **** 	report_touch_data(tmp, Pt[10]);
 2551              		.loc 1 115 0
 2552 0460 28201BE5 		ldr	r2, [fp, #-40]
 2553 0464 30301BE5 		ldr	r3, [fp, #-48]
 2554 0468 0200A0E1 		mov	r0, r2
 2555 046c 0310A0E1 		mov	r1, r3
 2556 0470 FEFFFFEB 		bl	report_touch_data
 116:../tp.c       ****      
 117:../tp.c       **** 	if(!(CheckTSP || (tmp < Xmin) || (tmp > Xmax) || (Pt[10] < Ymin) || (Pt[10] > Ymax)))   // Is vali
 2557              		.loc 1 117 0
 2558 0474 4C319FE5 		ldr	r3, .L23+12
 2559 0478 003093E5 		ldr	r3, [r3, #0]
 2560 047c 000053E3 		cmp	r3, #0
 2561 0480 3900001A 		bne	.L21
 2562              		.loc 1 117 0 is_stmt 0 discriminator 1
 2563 0484 40319FE5 		ldr	r3, .L23+16
 2564 0488 003093E5 		ldr	r3, [r3, #0]
 2565 048c 28201BE5 		ldr	r2, [fp, #-40]
 2566 0490 030052E1 		cmp	r2, r3
 2567 0494 3400003A 		bcc	.L21
 2568 0498 30319FE5 		ldr	r3, .L23+20
 2569 049c 003093E5 		ldr	r3, [r3, #0]
 2570 04a0 28201BE5 		ldr	r2, [fp, #-40]
 2571 04a4 030052E1 		cmp	r2, r3
 2572 04a8 2F00008A 		bhi	.L21
 2573 04ac 30201BE5 		ldr	r2, [fp, #-48]
 2574 04b0 1C319FE5 		ldr	r3, .L23+24
 2575 04b4 003093E5 		ldr	r3, [r3, #0]
 2576 04b8 030052E1 		cmp	r2, r3
 2577 04bc 2A00003A 		bcc	.L21
 2578 04c0 30201BE5 		ldr	r2, [fp, #-48]
 2579 04c4 0C319FE5 		ldr	r3, .L23+28
 2580 04c8 003093E5 		ldr	r3, [r3, #0]
 2581 04cc 030052E1 		cmp	r2, r3
 2582 04d0 2500008A 		bhi	.L21
 118:../tp.c       **** 	  {
 119:../tp.c       **** 		tmp = 320*(tmp - Xmin)/(Xmax - Xmin);   // X - position
 2583              		.loc 1 119 0 is_stmt 1
 2584 04d4 F0309FE5 		ldr	r3, .L23+16
 2585 04d8 003093E5 		ldr	r3, [r3, #0]
 2586 04dc 28201BE5 		ldr	r2, [fp, #-40]
 2587 04e0 022063E0 		rsb	r2, r3, r2
 2588 04e4 0230A0E1 		mov	r3, r2
 2589 04e8 0331A0E1 		mov	r3, r3, asl #2
 2590 04ec 023083E0 		add	r3, r3, r2
 2591 04f0 0333A0E1 		mov	r3, r3, asl #6
 2592 04f4 0320A0E1 		mov	r2, r3
 2593 04f8 D0309FE5 		ldr	r3, .L23+20
 2594 04fc 001093E5 		ldr	r1, [r3, #0]
 2595 0500 C4309FE5 		ldr	r3, .L23+16
 2596 0504 003093E5 		ldr	r3, [r3, #0]
 2597 0508 013063E0 		rsb	r3, r3, r1
 2598 050c 0200A0E1 		mov	r0, r2
 2599 0510 0310A0E1 		mov	r1, r3
 2600 0514 FEFFFFEB 		bl	__aeabi_uidiv
 2601 0518 0030A0E1 		mov	r3, r0
 2602 051c 28300BE5 		str	r3, [fp, #-40]
 120:../tp.c       **** 		Pt[10] = 240*(Pt[10] - Xmin)/(Ymax - Ymin);
 2603              		.loc 1 120 0
 2604 0520 30201BE5 		ldr	r2, [fp, #-48]
 2605 0524 A0309FE5 		ldr	r3, .L23+16
 2606 0528 003093E5 		ldr	r3, [r3, #0]
 2607 052c 022063E0 		rsb	r2, r3, r2
 2608 0530 0230A0E1 		mov	r3, r2
 2609 0534 0332A0E1 		mov	r3, r3, asl #4
 2610 0538 033062E0 		rsb	r3, r2, r3
 2611 053c 0332A0E1 		mov	r3, r3, asl #4
 2612 0540 0320A0E1 		mov	r2, r3
 2613 0544 8C309FE5 		ldr	r3, .L23+28
 2614 0548 001093E5 		ldr	r1, [r3, #0]
 2615 054c 80309FE5 		ldr	r3, .L23+24
 2616 0550 003093E5 		ldr	r3, [r3, #0]
 2617 0554 013063E0 		rsb	r3, r3, r1
 2618 0558 0200A0E1 		mov	r0, r2
 2619 055c 0310A0E1 		mov	r1, r3
 2620 0560 FEFFFFEB 		bl	__aeabi_uidiv
 2621 0564 0030A0E1 		mov	r3, r0
 2622 0568 30300BE5 		str	r3, [fp, #-48]
 2623              	.L21:
 121:../tp.c       ****       }
 122:../tp.c       **** 
 123:../tp.c       ****     if(CheckTSP)
 2624              		.loc 1 123 0
 2625 056c 54309FE5 		ldr	r3, .L23+12
 2626 0570 003093E5 		ldr	r3, [r3, #0]
 2627 0574 000053E3 		cmp	r3, #0
 2628 0578 0300000A 		beq	.L22
 124:../tp.c       ****  	/*----------- check to ensure Xmax Ymax Xmin Ymin ------------*/
 125:../tp.c       ****  	    DesignREC(tmp,Pt[5]);
 2629              		.loc 1 125 0
 2630 057c 44301BE5 		ldr	r3, [fp, #-68]
 2631 0580 28001BE5 		ldr	r0, [fp, #-40]
 2632 0584 0310A0E1 		mov	r1, r3
 2633 0588 FEFFFFEB 		bl	DesignREC
 2634              	.L22:
 126:../tp.c       **** 
 127:../tp.c       **** 	rPDATE = 0xb8;                  // should be enabled	
 2635              		.loc 1 127 0
 2636 058c 28309FE5 		ldr	r3, .L23
 2637 0590 B820A0E3 		mov	r2, #184
 2638 0594 002083E5 		str	r2, [r3, #0]
 128:../tp.c       **** 	DelayTime(3000);                // delay to set up the next channel	
 2639              		.loc 1 128 0
 2640 0598 3C009FE5 		ldr	r0, .L23+32
 2641 059c FEFFFFEB 		bl	DelayTime
 129:../tp.c       **** 
 130:../tp.c       ****     rI_ISPC = BIT_EINT2;            // clear pending_bit
 2642              		.loc 1 130 0
 2643 05a0 38309FE5 		ldr	r3, .L23+36
 2644 05a4 0225A0E3 		mov	r2, #8388608
 2645 05a8 002083E5 		str	r2, [r3, #0]
 131:../tp.c       **** }
 2646              		.loc 1 131 0
 2647 05ac 1CD04BE2 		sub	sp, fp, #28
 2648 05b0 0F689DE8 		ldmfd	sp, {r0, r1, r2, r3, fp, sp, lr}
 2649 05b4 04C09DE4 		ldmfd	sp!, {ip}
 2650 05b8 04F05EE2 		subs	pc, lr, #4
 2651              	.L24:
 2652              		.align	2
 2653              	.L23:
 2654 05bc 2C00D201 		.word	30539820
 2655 05c0 0800D401 		.word	30670856
 2656 05c4 ABAAAAAA 		.word	-1431655765
 2657 05c8 00000000 		.word	CheckTSP
 2658 05cc 00000000 		.word	Xmin
 2659 05d0 00000000 		.word	Xmax
 2660 05d4 00000000 		.word	Ymin
 2661 05d8 00000000 		.word	Ymax
 2662 05dc B80B0000 		.word	3000
 2663 05e0 2400E001 		.word	31457316
 2664              		.cfi_endproc
 2665              	.LFE1:
 2667              		.align	2
 2668              		.global	TS_init
 2670              	TS_init:
 2671              	.LFB2:
 132:../tp.c       **** 			
 133:../tp.c       **** /*********************************************************************************************
 134:../tp.c       **** * name:		TS_init
 135:../tp.c       **** * func:		initialize TouchScreen
 136:../tp.c       **** * para:		none
 137:../tp.c       **** * ret:		none
 138:../tp.c       **** * modify:
 139:../tp.c       **** * comment:		
 140:../tp.c       **** *********************************************************************************************/
 141:../tp.c       **** void TS_init(void)
 142:../tp.c       **** {
 2672              		.loc 1 142 0
 2673              		.cfi_startproc
 2674              		@ Function supports interworking.
 2675              		@ args = 0, pretend = 0, frame = 0
 2676              		@ frame_needed = 1, uses_anonymous_args = 0
 2677 05e4 0DC0A0E1 		mov	ip, sp
 2678              	.LCFI4:
 2679              		.cfi_def_cfa_register 12
 2680 05e8 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2681 05ec 04B04CE2 		sub	fp, ip, #4
 2682              		.cfi_offset 14, -8
 2683              		.cfi_offset 13, -12
 2684              		.cfi_offset 11, -16
 2685              	.LCFI5:
 2686              		.cfi_def_cfa 11, 4
 143:../tp.c       ****     /* enable interrupt */
 144:../tp.c       **** 	rINTMOD=0x0;
 2687              		.loc 1 144 0
 2688 05f0 A8309FE5 		ldr	r3, .L26
 2689 05f4 0020A0E3 		mov	r2, #0
 2690 05f8 002083E5 		str	r2, [r3, #0]
 145:../tp.c       **** 	rINTCON=0x1;
 2691              		.loc 1 145 0
 2692 05fc 1E36A0E3 		mov	r3, #31457280
 2693 0600 0120A0E3 		mov	r2, #1
 2694 0604 002083E5 		str	r2, [r3, #0]
 146:../tp.c       ****     rI_ISPC |= BIT_EINT2;            // clear pending_bit
 2695              		.loc 1 146 0
 2696 0608 94309FE5 		ldr	r3, .L26+4
 2697 060c 90209FE5 		ldr	r2, .L26+4
 2698 0610 002092E5 		ldr	r2, [r2, #0]
 2699 0614 022582E3 		orr	r2, r2, #8388608
 2700 0618 002083E5 		str	r2, [r3, #0]
 147:../tp.c       **** 	
 148:../tp.c       **** 	// TSPX(GPE4_Q4(-)) TSPY(GPE5_Q3(-)) TSMY(GPE6_Q2(-)) TSMX(GPE7_Q1(+)) 
 149:../tp.c       **** 	//          1               1                0                 1
 150:../tp.c       ****     rPUPE  = 0x0;	                 // Pull up
 2701              		.loc 1 150 0
 2702 061c 84309FE5 		ldr	r3, .L26+8
 2703 0620 0020A0E3 		mov	r2, #0
 2704 0624 002083E5 		str	r2, [r3, #0]
 151:../tp.c       ****     rPDATE = 0xb8;                   // should be enabled	
 2705              		.loc 1 151 0
 2706 0628 7C309FE5 		ldr	r3, .L26+12
 2707 062c B820A0E3 		mov	r2, #184
 2708 0630 002083E5 		str	r2, [r3, #0]
 152:../tp.c       ****     DelayTime(100); 
 2709              		.loc 1 152 0
 2710 0634 6400A0E3 		mov	r0, #100
 2711 0638 FEFFFFEB 		bl	DelayTime
 153:../tp.c       ****     
 154:../tp.c       ****     rEXTINT |= 0x200;                // falling edge trigger
 2712              		.loc 1 154 0
 2713 063c 6C309FE5 		ldr	r3, .L26+16
 2714 0640 68209FE5 		ldr	r2, .L26+16
 2715 0644 002092E5 		ldr	r2, [r2, #0]
 2716 0648 022C82E3 		orr	r2, r2, #512
 2717 064c 002083E5 		str	r2, [r3, #0]
 155:../tp.c       ****     pISR_EINT2=(unsigned)TSInt;       // set interrupt handler
 2718              		.loc 1 155 0
 2719 0650 5C309FE5 		ldr	r3, .L26+20
 2720 0654 5C209FE5 		ldr	r2, .L26+24
 2721 0658 002083E5 		str	r2, [r3, #0]
 156:../tp.c       ****     
 157:../tp.c       ****     rCLKCON = 0x7ff8;                // enable clock
 2722              		.loc 1 157 0
 2723 065c 58309FE5 		ldr	r3, .L26+28
 2724 0660 58209FE5 		ldr	r2, .L26+32
 2725 0664 002083E5 		str	r2, [r3, #0]
 158:../tp.c       ****     rADCPSR = 0x1;//0x4;             // A/D prescaler
 2726              		.loc 1 158 0
 2727 0668 54309FE5 		ldr	r3, .L26+36
 2728 066c 0120A0E3 		mov	r2, #1
 2729 0670 002083E5 		str	r2, [r3, #0]
 159:../tp.c       ****     rINTMSK &= ~(BIT_EINT2);
 2730              		.loc 1 159 0
 2731 0674 4C309FE5 		ldr	r3, .L26+40
 2732 0678 48209FE5 		ldr	r2, .L26+40
 2733 067c 002092E5 		ldr	r2, [r2, #0]
 2734 0680 0225C2E3 		bic	r2, r2, #8388608
 2735 0684 002083E5 		str	r2, [r3, #0]
 160:../tp.c       **** 
 161:../tp.c       ****     oneTouch = 0;
 2736              		.loc 1 161 0
 2737 0688 3C309FE5 		ldr	r3, .L26+44
 2738 068c 0020A0E3 		mov	r2, #0
 2739 0690 002083E5 		str	r2, [r3, #0]
 162:../tp.c       **** }
 2740              		.loc 1 162 0
 2741 0694 0CD04BE2 		sub	sp, fp, #12
 2742 0698 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2743 069c 1EFF2FE1 		bx	lr
 2744              	.L27:
 2745              		.align	2
 2746              	.L26:
 2747 06a0 0800E001 		.word	31457288
 2748 06a4 2400E001 		.word	31457316
 2749 06a8 3000D201 		.word	30539824
 2750 06ac 2C00D201 		.word	30539820
 2751 06b0 5000D201 		.word	30539856
 2752 06b4 7CFF7F0C 		.word	209715068
 2753 06b8 00000000 		.word	TSInt
 2754 06bc 0400D801 		.word	30932996
 2755 06c0 F87F0000 		.word	32760
 2756 06c4 0400D401 		.word	30670852
 2757 06c8 0C00E001 		.word	31457292
 2758 06cc 00000000 		.word	oneTouch
 2759              		.cfi_endproc
 2760              	.LFE2:
 2762              		.align	2
 2763              		.global	TS_close
 2765              	TS_close:
 2766              	.LFB3:
 163:../tp.c       **** 
 164:../tp.c       **** /*********************************************************************************************
 165:../tp.c       **** * name:		TS_close
 166:../tp.c       **** * func:		close TouchScreen
 167:../tp.c       **** * para:		none
 168:../tp.c       **** * ret:		none
 169:../tp.c       **** * modify:
 170:../tp.c       **** * comment:		
 171:../tp.c       **** *********************************************************************************************/
 172:../tp.c       **** void TS_close(void)
 173:../tp.c       **** {
 2767              		.loc 1 173 0
 2768              		.cfi_startproc
 2769              		@ Function supports interworking.
 2770              		@ args = 0, pretend = 0, frame = 0
 2771              		@ frame_needed = 1, uses_anonymous_args = 0
 2772 06d0 0DC0A0E1 		mov	ip, sp
 2773              	.LCFI6:
 2774              		.cfi_def_cfa_register 12
 2775 06d4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2776 06d8 04B04CE2 		sub	fp, ip, #4
 2777              		.cfi_offset 14, -8
 2778              		.cfi_offset 13, -12
 2779              		.cfi_offset 11, -16
 2780              	.LCFI7:
 2781              		.cfi_def_cfa 11, 4
 174:../tp.c       **** 	/* Mask interrupt */
 175:../tp.c       **** 	rINTMSK |=BIT_GLOBAL|BIT_EINT2;
 2782              		.loc 1 175 0
 2783 06dc 24309FE5 		ldr	r3, .L29
 2784 06e0 20209FE5 		ldr	r2, .L29
 2785 06e4 002092E5 		ldr	r2, [r2, #0]
 2786 06e8 122582E3 		orr	r2, r2, #75497472
 2787 06ec 002083E5 		str	r2, [r3, #0]
 176:../tp.c       **** 	pISR_EINT2 = (int)NULL;
 2788              		.loc 1 176 0
 2789 06f0 14309FE5 		ldr	r3, .L29+4
 2790 06f4 0020A0E3 		mov	r2, #0
 2791 06f8 002083E5 		str	r2, [r3, #0]
 177:../tp.c       **** }
 2792              		.loc 1 177 0
 2793 06fc 0CD04BE2 		sub	sp, fp, #12
 2794 0700 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2795 0704 1EFF2FE1 		bx	lr
 2796              	.L30:
 2797              		.align	2
 2798              	.L29:
 2799 0708 0C00E001 		.word	31457292
 2800 070c 7CFF7F0C 		.word	209715068
 2801              		.cfi_endproc
 2802              	.LFE3:
 2804              		.section	.rodata
 2805              		.align	2
 2806              	.LC0:
 2807 0000 3000     		.ascii	"0\000"
 2808 0002 0000     		.align	2
 2809              	.LC1:
 2810 0004 3100     		.ascii	"1\000"
 2811 0006 0000     		.align	2
 2812              	.LC2:
 2813 0008 3200     		.ascii	"2\000"
 2814 000a 0000     		.align	2
 2815              	.LC3:
 2816 000c 3300     		.ascii	"3\000"
 2817 000e 0000     		.align	2
 2818              	.LC4:
 2819 0010 3400     		.ascii	"4\000"
 2820 0012 0000     		.align	2
 2821              	.LC5:
 2822 0014 3500     		.ascii	"5\000"
 2823 0016 0000     		.align	2
 2824              	.LC6:
 2825 0018 3600     		.ascii	"6\000"
 2826 001a 0000     		.align	2
 2827              	.LC7:
 2828 001c 3700     		.ascii	"7\000"
 2829 001e 0000     		.align	2
 2830              	.LC8:
 2831 0020 3800     		.ascii	"8\000"
 2832 0022 0000     		.align	2
 2833              	.LC9:
 2834 0024 3900     		.ascii	"9\000"
 2835 0026 0000     		.align	2
 2836              	.LC10:
 2837 0028 4100     		.ascii	"A\000"
 2838 002a 0000     		.align	2
 2839              	.LC11:
 2840 002c 4200     		.ascii	"B\000"
 2841 002e 0000     		.align	2
 2842              	.LC12:
 2843 0030 4300     		.ascii	"C\000"
 2844 0032 0000     		.align	2
 2845              	.LC13:
 2846 0034 4400     		.ascii	"D\000"
 2847 0036 0000     		.align	2
 2848              	.LC14:
 2849 0038 4500     		.ascii	"E\000"
 2850 003a 0000     		.align	2
 2851              	.LC15:
 2852 003c 4600     		.ascii	"F\000"
 2853              		.text
 2854              		.align	2
 2855              		.global	Lcd_TC
 2857              	Lcd_TC:
 2858              	.LFB4:
 178:../tp.c       **** 
 179:../tp.c       **** void Lcd_TC(void)
 180:../tp.c       **** {
 2859              		.loc 1 180 0
 2860              		.cfi_startproc
 2861              		@ Function supports interworking.
 2862              		@ args = 0, pretend = 0, frame = 0
 2863              		@ frame_needed = 1, uses_anonymous_args = 0
 2864 0710 0DC0A0E1 		mov	ip, sp
 2865              	.LCFI8:
 2866              		.cfi_def_cfa_register 12
 2867 0714 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2868 0718 04B04CE2 		sub	fp, ip, #4
 2869              		.cfi_offset 14, -8
 2870              		.cfi_offset 13, -12
 2871              		.cfi_offset 11, -16
 2872              	.LCFI9:
 2873              		.cfi_def_cfa 11, 4
 2874 071c 08D04DE2 		sub	sp, sp, #8
 181:../tp.c       **** 	/* initial LCD controller */
 182:../tp.c       **** 	Lcd_Init();
 2875              		.loc 1 182 0
 2876 0720 FEFFFFEB 		bl	Lcd_Init
 183:../tp.c       **** 	/* clear screen */
 184:../tp.c       **** 	Lcd_Clr();
 2877              		.loc 1 184 0
 2878 0724 FEFFFFEB 		bl	Lcd_Clr
 185:../tp.c       **** 	Lcd_Active_Clr();
 2879              		.loc 1 185 0
 2880 0728 FEFFFFEB 		bl	Lcd_Active_Clr
 186:../tp.c       **** 	/* draw rectangle pattern */ 
 187:../tp.c       **** 	Lcd_Draw_Box(0,0,80,60,15);
 2881              		.loc 1 187 0
 2882 072c 0F30A0E3 		mov	r3, #15
 2883 0730 00308DE5 		str	r3, [sp, #0]
 2884 0734 0000A0E3 		mov	r0, #0
 2885 0738 0010A0E3 		mov	r1, #0
 2886 073c 5020A0E3 		mov	r2, #80
 2887 0740 3C30A0E3 		mov	r3, #60
 2888 0744 FEFFFFEB 		bl	Lcd_Draw_Box
 188:../tp.c       **** 	Lcd_Draw_Box(80,0,160,60,15);
 2889              		.loc 1 188 0
 2890 0748 0F30A0E3 		mov	r3, #15
 2891 074c 00308DE5 		str	r3, [sp, #0]
 2892 0750 5000A0E3 		mov	r0, #80
 2893 0754 0010A0E3 		mov	r1, #0
 2894 0758 A020A0E3 		mov	r2, #160
 2895 075c 3C30A0E3 		mov	r3, #60
 2896 0760 FEFFFFEB 		bl	Lcd_Draw_Box
 189:../tp.c       **** 	Lcd_Draw_Box(160,0,240,60,15);
 2897              		.loc 1 189 0
 2898 0764 0F30A0E3 		mov	r3, #15
 2899 0768 00308DE5 		str	r3, [sp, #0]
 2900 076c A000A0E3 		mov	r0, #160
 2901 0770 0010A0E3 		mov	r1, #0
 2902 0774 F020A0E3 		mov	r2, #240
 2903 0778 3C30A0E3 		mov	r3, #60
 2904 077c FEFFFFEB 		bl	Lcd_Draw_Box
 190:../tp.c       **** 	Lcd_Draw_Box(240,0,320,60,15);
 2905              		.loc 1 190 0
 2906 0780 0F30A0E3 		mov	r3, #15
 2907 0784 00308DE5 		str	r3, [sp, #0]
 2908 0788 F000A0E3 		mov	r0, #240
 2909 078c 0010A0E3 		mov	r1, #0
 2910 0790 052DA0E3 		mov	r2, #320
 2911 0794 3C30A0E3 		mov	r3, #60
 2912 0798 FEFFFFEB 		bl	Lcd_Draw_Box
 191:../tp.c       **** 	Lcd_Draw_Box(0,60,80,120,15);
 2913              		.loc 1 191 0
 2914 079c 0F30A0E3 		mov	r3, #15
 2915 07a0 00308DE5 		str	r3, [sp, #0]
 2916 07a4 0000A0E3 		mov	r0, #0
 2917 07a8 3C10A0E3 		mov	r1, #60
 2918 07ac 5020A0E3 		mov	r2, #80
 2919 07b0 7830A0E3 		mov	r3, #120
 2920 07b4 FEFFFFEB 		bl	Lcd_Draw_Box
 192:../tp.c       **** 	Lcd_Draw_Box(80,60,160,120,15);
 2921              		.loc 1 192 0
 2922 07b8 0F30A0E3 		mov	r3, #15
 2923 07bc 00308DE5 		str	r3, [sp, #0]
 2924 07c0 5000A0E3 		mov	r0, #80
 2925 07c4 3C10A0E3 		mov	r1, #60
 2926 07c8 A020A0E3 		mov	r2, #160
 2927 07cc 7830A0E3 		mov	r3, #120
 2928 07d0 FEFFFFEB 		bl	Lcd_Draw_Box
 193:../tp.c       **** 	Lcd_Draw_Box(160,60,240,120,15);
 2929              		.loc 1 193 0
 2930 07d4 0F30A0E3 		mov	r3, #15
 2931 07d8 00308DE5 		str	r3, [sp, #0]
 2932 07dc A000A0E3 		mov	r0, #160
 2933 07e0 3C10A0E3 		mov	r1, #60
 2934 07e4 F020A0E3 		mov	r2, #240
 2935 07e8 7830A0E3 		mov	r3, #120
 2936 07ec FEFFFFEB 		bl	Lcd_Draw_Box
 194:../tp.c       **** 	Lcd_Draw_Box(240,60,320,120,15);
 2937              		.loc 1 194 0
 2938 07f0 0F30A0E3 		mov	r3, #15
 2939 07f4 00308DE5 		str	r3, [sp, #0]
 2940 07f8 F000A0E3 		mov	r0, #240
 2941 07fc 3C10A0E3 		mov	r1, #60
 2942 0800 052DA0E3 		mov	r2, #320
 2943 0804 7830A0E3 		mov	r3, #120
 2944 0808 FEFFFFEB 		bl	Lcd_Draw_Box
 195:../tp.c       **** 	Lcd_Draw_Box(0,120,80,180,15);
 2945              		.loc 1 195 0
 2946 080c 0F30A0E3 		mov	r3, #15
 2947 0810 00308DE5 		str	r3, [sp, #0]
 2948 0814 0000A0E3 		mov	r0, #0
 2949 0818 7810A0E3 		mov	r1, #120
 2950 081c 5020A0E3 		mov	r2, #80
 2951 0820 B430A0E3 		mov	r3, #180
 2952 0824 FEFFFFEB 		bl	Lcd_Draw_Box
 196:../tp.c       **** 	Lcd_Draw_Box(80,120,160,180,15);
 2953              		.loc 1 196 0
 2954 0828 0F30A0E3 		mov	r3, #15
 2955 082c 00308DE5 		str	r3, [sp, #0]
 2956 0830 5000A0E3 		mov	r0, #80
 2957 0834 7810A0E3 		mov	r1, #120
 2958 0838 A020A0E3 		mov	r2, #160
 2959 083c B430A0E3 		mov	r3, #180
 2960 0840 FEFFFFEB 		bl	Lcd_Draw_Box
 197:../tp.c       **** 	Lcd_Draw_Box(160,120,240,180,15);
 2961              		.loc 1 197 0
 2962 0844 0F30A0E3 		mov	r3, #15
 2963 0848 00308DE5 		str	r3, [sp, #0]
 2964 084c A000A0E3 		mov	r0, #160
 2965 0850 7810A0E3 		mov	r1, #120
 2966 0854 F020A0E3 		mov	r2, #240
 2967 0858 B430A0E3 		mov	r3, #180
 2968 085c FEFFFFEB 		bl	Lcd_Draw_Box
 198:../tp.c       **** 	Lcd_Draw_Box(240,120,320,180,15);
 2969              		.loc 1 198 0
 2970 0860 0F30A0E3 		mov	r3, #15
 2971 0864 00308DE5 		str	r3, [sp, #0]
 2972 0868 F000A0E3 		mov	r0, #240
 2973 086c 7810A0E3 		mov	r1, #120
 2974 0870 052DA0E3 		mov	r2, #320
 2975 0874 B430A0E3 		mov	r3, #180
 2976 0878 FEFFFFEB 		bl	Lcd_Draw_Box
 199:../tp.c       **** 	Lcd_Draw_Box(0,180,80,240,15);
 2977              		.loc 1 199 0
 2978 087c 0F30A0E3 		mov	r3, #15
 2979 0880 00308DE5 		str	r3, [sp, #0]
 2980 0884 0000A0E3 		mov	r0, #0
 2981 0888 B410A0E3 		mov	r1, #180
 2982 088c 5020A0E3 		mov	r2, #80
 2983 0890 F030A0E3 		mov	r3, #240
 2984 0894 FEFFFFEB 		bl	Lcd_Draw_Box
 200:../tp.c       **** 	Lcd_Draw_Box(80,180,160,240,15);
 2985              		.loc 1 200 0
 2986 0898 0F30A0E3 		mov	r3, #15
 2987 089c 00308DE5 		str	r3, [sp, #0]
 2988 08a0 5000A0E3 		mov	r0, #80
 2989 08a4 B410A0E3 		mov	r1, #180
 2990 08a8 A020A0E3 		mov	r2, #160
 2991 08ac F030A0E3 		mov	r3, #240
 2992 08b0 FEFFFFEB 		bl	Lcd_Draw_Box
 201:../tp.c       **** 	Lcd_Draw_Box(160,180,240,240,15);
 2993              		.loc 1 201 0
 2994 08b4 0F30A0E3 		mov	r3, #15
 2995 08b8 00308DE5 		str	r3, [sp, #0]
 2996 08bc A000A0E3 		mov	r0, #160
 2997 08c0 B410A0E3 		mov	r1, #180
 2998 08c4 F020A0E3 		mov	r2, #240
 2999 08c8 F030A0E3 		mov	r3, #240
 3000 08cc FEFFFFEB 		bl	Lcd_Draw_Box
 202:../tp.c       **** 	Lcd_Draw_Box(240,180,320,240,15);
 3001              		.loc 1 202 0
 3002 08d0 0F30A0E3 		mov	r3, #15
 3003 08d4 00308DE5 		str	r3, [sp, #0]
 3004 08d8 F000A0E3 		mov	r0, #240
 3005 08dc B410A0E3 		mov	r1, #180
 3006 08e0 052DA0E3 		mov	r2, #320
 3007 08e4 F030A0E3 		mov	r3, #240
 3008 08e8 FEFFFFEB 		bl	Lcd_Draw_Box
 203:../tp.c       **** 	/* output ASCII symbol */
 204:../tp.c       **** 	Lcd_DspAscII6x8(37,26,BLACK,(INT8U*)"0");
 3009              		.loc 1 204 0
 3010 08ec 2500A0E3 		mov	r0, #37
 3011 08f0 1A10A0E3 		mov	r1, #26
 3012 08f4 0F20A0E3 		mov	r2, #15
 3013 08f8 44319FE5 		ldr	r3, .L32
 3014 08fc FEFFFFEB 		bl	Lcd_DspAscII6x8
 205:../tp.c       **** 	Lcd_DspAscII6x8(117,26,BLACK,(INT8U*)"1");
 3015              		.loc 1 205 0
 3016 0900 7500A0E3 		mov	r0, #117
 3017 0904 1A10A0E3 		mov	r1, #26
 3018 0908 0F20A0E3 		mov	r2, #15
 3019 090c 34319FE5 		ldr	r3, .L32+4
 3020 0910 FEFFFFEB 		bl	Lcd_DspAscII6x8
 206:../tp.c       **** 	Lcd_DspAscII6x8(197,26,BLACK,(INT8U*)"2");
 3021              		.loc 1 206 0
 3022 0914 C500A0E3 		mov	r0, #197
 3023 0918 1A10A0E3 		mov	r1, #26
 3024 091c 0F20A0E3 		mov	r2, #15
 3025 0920 24319FE5 		ldr	r3, .L32+8
 3026 0924 FEFFFFEB 		bl	Lcd_DspAscII6x8
 207:../tp.c       **** 	Lcd_DspAscII6x8(277,26,BLACK,(INT8U*)"3");
 3027              		.loc 1 207 0
 3028 0928 20019FE5 		ldr	r0, .L32+12
 3029 092c 1A10A0E3 		mov	r1, #26
 3030 0930 0F20A0E3 		mov	r2, #15
 3031 0934 18319FE5 		ldr	r3, .L32+16
 3032 0938 FEFFFFEB 		bl	Lcd_DspAscII6x8
 208:../tp.c       **** 	Lcd_DspAscII6x8(37,86,BLACK,(INT8U*)"4");
 3033              		.loc 1 208 0
 3034 093c 2500A0E3 		mov	r0, #37
 3035 0940 5610A0E3 		mov	r1, #86
 3036 0944 0F20A0E3 		mov	r2, #15
 3037 0948 08319FE5 		ldr	r3, .L32+20
 3038 094c FEFFFFEB 		bl	Lcd_DspAscII6x8
 209:../tp.c       **** 	Lcd_DspAscII6x8(117,86,BLACK,(INT8U*)"5");
 3039              		.loc 1 209 0
 3040 0950 7500A0E3 		mov	r0, #117
 3041 0954 5610A0E3 		mov	r1, #86
 3042 0958 0F20A0E3 		mov	r2, #15
 3043 095c F8309FE5 		ldr	r3, .L32+24
 3044 0960 FEFFFFEB 		bl	Lcd_DspAscII6x8
 210:../tp.c       **** 	Lcd_DspAscII6x8(197,86,BLACK,(INT8U*)"6");
 3045              		.loc 1 210 0
 3046 0964 C500A0E3 		mov	r0, #197
 3047 0968 5610A0E3 		mov	r1, #86
 3048 096c 0F20A0E3 		mov	r2, #15
 3049 0970 E8309FE5 		ldr	r3, .L32+28
 3050 0974 FEFFFFEB 		bl	Lcd_DspAscII6x8
 211:../tp.c       **** 	Lcd_DspAscII6x8(277,86,BLACK,(INT8U*)"7");
 3051              		.loc 1 211 0
 3052 0978 D0009FE5 		ldr	r0, .L32+12
 3053 097c 5610A0E3 		mov	r1, #86
 3054 0980 0F20A0E3 		mov	r2, #15
 3055 0984 D8309FE5 		ldr	r3, .L32+32
 3056 0988 FEFFFFEB 		bl	Lcd_DspAscII6x8
 212:../tp.c       **** 	Lcd_DspAscII6x8(37,146,BLACK,(INT8U*)"8");
 3057              		.loc 1 212 0
 3058 098c 2500A0E3 		mov	r0, #37
 3059 0990 9210A0E3 		mov	r1, #146
 3060 0994 0F20A0E3 		mov	r2, #15
 3061 0998 C8309FE5 		ldr	r3, .L32+36
 3062 099c FEFFFFEB 		bl	Lcd_DspAscII6x8
 213:../tp.c       **** 	Lcd_DspAscII6x8(117,146,BLACK,(INT8U*)"9");
 3063              		.loc 1 213 0
 3064 09a0 7500A0E3 		mov	r0, #117
 3065 09a4 9210A0E3 		mov	r1, #146
 3066 09a8 0F20A0E3 		mov	r2, #15
 3067 09ac B8309FE5 		ldr	r3, .L32+40
 3068 09b0 FEFFFFEB 		bl	Lcd_DspAscII6x8
 214:../tp.c       **** 	Lcd_DspAscII6x8(197,146,BLACK,(INT8U*)"A");
 3069              		.loc 1 214 0
 3070 09b4 C500A0E3 		mov	r0, #197
 3071 09b8 9210A0E3 		mov	r1, #146
 3072 09bc 0F20A0E3 		mov	r2, #15
 3073 09c0 A8309FE5 		ldr	r3, .L32+44
 3074 09c4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 215:../tp.c       **** 	Lcd_DspAscII6x8(277,146,BLACK,(INT8U*)"B");
 3075              		.loc 1 215 0
 3076 09c8 80009FE5 		ldr	r0, .L32+12
 3077 09cc 9210A0E3 		mov	r1, #146
 3078 09d0 0F20A0E3 		mov	r2, #15
 3079 09d4 98309FE5 		ldr	r3, .L32+48
 3080 09d8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 216:../tp.c       **** 	Lcd_DspAscII6x8(37,206,BLACK,(INT8U*)"C");
 3081              		.loc 1 216 0
 3082 09dc 2500A0E3 		mov	r0, #37
 3083 09e0 CE10A0E3 		mov	r1, #206
 3084 09e4 0F20A0E3 		mov	r2, #15
 3085 09e8 88309FE5 		ldr	r3, .L32+52
 3086 09ec FEFFFFEB 		bl	Lcd_DspAscII6x8
 217:../tp.c       **** 	Lcd_DspAscII6x8(117,206,BLACK,(INT8U*)"D");
 3087              		.loc 1 217 0
 3088 09f0 7500A0E3 		mov	r0, #117
 3089 09f4 CE10A0E3 		mov	r1, #206
 3090 09f8 0F20A0E3 		mov	r2, #15
 3091 09fc 78309FE5 		ldr	r3, .L32+56
 3092 0a00 FEFFFFEB 		bl	Lcd_DspAscII6x8
 218:../tp.c       **** 	Lcd_DspAscII6x8(197,206,BLACK,(INT8U*)"E");
 3093              		.loc 1 218 0
 3094 0a04 C500A0E3 		mov	r0, #197
 3095 0a08 CE10A0E3 		mov	r1, #206
 3096 0a0c 0F20A0E3 		mov	r2, #15
 3097 0a10 68309FE5 		ldr	r3, .L32+60
 3098 0a14 FEFFFFEB 		bl	Lcd_DspAscII6x8
 219:../tp.c       **** 	Lcd_DspAscII6x8(277,206,BLACK,(INT8U*)"F");
 3099              		.loc 1 219 0
 3100 0a18 30009FE5 		ldr	r0, .L32+12
 3101 0a1c CE10A0E3 		mov	r1, #206
 3102 0a20 0F20A0E3 		mov	r2, #15
 3103 0a24 58309FE5 		ldr	r3, .L32+64
 3104 0a28 FEFFFFEB 		bl	Lcd_DspAscII6x8
 220:../tp.c       **** 	Lcd_Dma_Trans();
 3105              		.loc 1 220 0
 3106 0a2c FEFFFFEB 		bl	Lcd_Dma_Trans
 221:../tp.c       **** 	Delay(100);
 3107              		.loc 1 221 0
 3108 0a30 6400A0E3 		mov	r0, #100
 3109 0a34 FEFFFFEB 		bl	Delay
 222:../tp.c       **** }
 3110              		.loc 1 222 0
 3111 0a38 0CD04BE2 		sub	sp, fp, #12
 3112 0a3c 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3113 0a40 1EFF2FE1 		bx	lr
 3114              	.L33:
 3115              		.align	2
 3116              	.L32:
 3117 0a44 00000000 		.word	.LC0
 3118 0a48 04000000 		.word	.LC1
 3119 0a4c 08000000 		.word	.LC2
 3120 0a50 15010000 		.word	277
 3121 0a54 0C000000 		.word	.LC3
 3122 0a58 10000000 		.word	.LC4
 3123 0a5c 14000000 		.word	.LC5
 3124 0a60 18000000 		.word	.LC6
 3125 0a64 1C000000 		.word	.LC7
 3126 0a68 20000000 		.word	.LC8
 3127 0a6c 24000000 		.word	.LC9
 3128 0a70 28000000 		.word	.LC10
 3129 0a74 2C000000 		.word	.LC11
 3130 0a78 30000000 		.word	.LC12
 3131 0a7c 34000000 		.word	.LC13
 3132 0a80 38000000 		.word	.LC14
 3133 0a84 3C000000 		.word	.LC15
 3134              		.cfi_endproc
 3135              	.LFE4:
 3137              		.align	2
 3138              		.global	DesignREC
 3140              	DesignREC:
 3141              	.LFB5:
 223:../tp.c       **** 
 224:../tp.c       **** /*********************************************************************************************
 225:../tp.c       **** * name:		DesignREC
 226:../tp.c       **** * func:		confirm the coordinate rang
 227:../tp.c       **** * para:		none
 228:../tp.c       **** * ret:		none
 229:../tp.c       **** * modify:
 230:../tp.c       **** * comment:		
 231:../tp.c       **** *********************************************************************************************/
 232:../tp.c       **** void DesignREC(ULONG tx, ULONG ty)
 233:../tp.c       **** {
 3142              		.loc 1 233 0
 3143              		.cfi_startproc
 3144              		@ Function supports interworking.
 3145              		@ args = 0, pretend = 0, frame = 16
 3146              		@ frame_needed = 1, uses_anonymous_args = 0
 3147 0a88 0DC0A0E1 		mov	ip, sp
 3148              	.LCFI10:
 3149              		.cfi_def_cfa_register 12
 3150 0a8c 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3151 0a90 04B04CE2 		sub	fp, ip, #4
 3152              		.cfi_offset 14, -8
 3153              		.cfi_offset 13, -12
 3154              		.cfi_offset 11, -16
 3155              	.LCFI11:
 3156              		.cfi_def_cfa 11, 4
 3157 0a94 10D04DE2 		sub	sp, sp, #16
 3158 0a98 18000BE5 		str	r0, [fp, #-24]
 3159 0a9c 1C100BE5 		str	r1, [fp, #-28]
 234:../tp.c       ****     int tm;
 235:../tp.c       ****     
 236:../tp.c       **** //  Uart_Printf("\n\r User touch coordinate(X,Y) is :");
 237:../tp.c       **** //	Uart_Printf("(%04d",tx);	
 238:../tp.c       **** //	Uart_Printf(",%04d)\n",ty);    
 239:../tp.c       ****     if(oneTouch == 0)
 3160              		.loc 1 239 0
 3161 0aa0 F4309FE5 		ldr	r3, .L39
 3162 0aa4 003093E5 		ldr	r3, [r3, #0]
 3163 0aa8 000053E3 		cmp	r3, #0
 3164 0aac 0900001A 		bne	.L35
 240:../tp.c       ****      {
 241:../tp.c       ****        Vx = tx;                   // Vx as Xmax
 3165              		.loc 1 241 0
 3166 0ab0 E8309FE5 		ldr	r3, .L39+4
 3167 0ab4 18201BE5 		ldr	r2, [fp, #-24]
 3168 0ab8 002083E5 		str	r2, [r3, #0]
 242:../tp.c       ****        Vy = ty;                   // Vy as Ymax
 3169              		.loc 1 242 0
 3170 0abc E0309FE5 		ldr	r3, .L39+8
 3171 0ac0 1C201BE5 		ldr	r2, [fp, #-28]
 3172 0ac4 002083E5 		str	r2, [r3, #0]
 243:../tp.c       ****        oneTouch = 1;       		           
 3173              		.loc 1 243 0
 3174 0ac8 CC309FE5 		ldr	r3, .L39
 3175 0acc 0120A0E3 		mov	r2, #1
 3176 0ad0 002083E5 		str	r2, [r3, #0]
 3177 0ad4 2D0000EA 		b	.L34
 3178              	.L35:
 244:../tp.c       ****     }else{
 245:../tp.c       ****     
 246:../tp.c       ****     if(Vx < tx )
 3179              		.loc 1 246 0
 3180 0ad8 C0309FE5 		ldr	r3, .L39+4
 3181 0adc 002093E5 		ldr	r2, [r3, #0]
 3182 0ae0 18301BE5 		ldr	r3, [fp, #-24]
 3183 0ae4 030052E1 		cmp	r2, r3
 3184 0ae8 0700002A 		bcs	.L37
 247:../tp.c       ****      {
 248:../tp.c       ****        tm = tx; tx = Vx; Vx = tm; // tx as Xmin
 3185              		.loc 1 248 0
 3186 0aec 18301BE5 		ldr	r3, [fp, #-24]
 3187 0af0 10300BE5 		str	r3, [fp, #-16]
 3188 0af4 A4309FE5 		ldr	r3, .L39+4
 3189 0af8 003093E5 		ldr	r3, [r3, #0]
 3190 0afc 18300BE5 		str	r3, [fp, #-24]
 3191 0b00 10201BE5 		ldr	r2, [fp, #-16]
 3192 0b04 94309FE5 		ldr	r3, .L39+4
 3193 0b08 002083E5 		str	r2, [r3, #0]
 3194              	.L37:
 249:../tp.c       ****      }
 250:../tp.c       ****     if(Vy < ty )
 3195              		.loc 1 250 0
 3196 0b0c 90309FE5 		ldr	r3, .L39+8
 3197 0b10 002093E5 		ldr	r2, [r3, #0]
 3198 0b14 1C301BE5 		ldr	r3, [fp, #-28]
 3199 0b18 030052E1 		cmp	r2, r3
 3200 0b1c 0700002A 		bcs	.L38
 251:../tp.c       ****      { 
 252:../tp.c       ****        tm = ty; ty = Vy; Vy = tm; // ty as Ymin
 3201              		.loc 1 252 0
 3202 0b20 1C301BE5 		ldr	r3, [fp, #-28]
 3203 0b24 10300BE5 		str	r3, [fp, #-16]
 3204 0b28 74309FE5 		ldr	r3, .L39+8
 3205 0b2c 003093E5 		ldr	r3, [r3, #0]
 3206 0b30 1C300BE5 		str	r3, [fp, #-28]
 3207 0b34 10201BE5 		ldr	r2, [fp, #-16]
 3208 0b38 64309FE5 		ldr	r3, .L39+8
 3209 0b3c 002083E5 		str	r2, [r3, #0]
 3210              	.L38:
 253:../tp.c       ****      }
 254:../tp.c       ****      
 255:../tp.c       ****     Xmax = Vx;    Xmin = tx;
 3211              		.loc 1 255 0
 3212 0b40 58309FE5 		ldr	r3, .L39+4
 3213 0b44 002093E5 		ldr	r2, [r3, #0]
 3214 0b48 58309FE5 		ldr	r3, .L39+12
 3215 0b4c 002083E5 		str	r2, [r3, #0]
 3216 0b50 54309FE5 		ldr	r3, .L39+16
 3217 0b54 18201BE5 		ldr	r2, [fp, #-24]
 3218 0b58 002083E5 		str	r2, [r3, #0]
 256:../tp.c       ****     Ymax = Vy;    Ymin = ty;
 3219              		.loc 1 256 0
 3220 0b5c 40309FE5 		ldr	r3, .L39+8
 3221 0b60 002093E5 		ldr	r2, [r3, #0]
 3222 0b64 44309FE5 		ldr	r3, .L39+20
 3223 0b68 002083E5 		str	r2, [r3, #0]
 3224 0b6c 40309FE5 		ldr	r3, .L39+24
 3225 0b70 1C201BE5 		ldr	r2, [fp, #-28]
 3226 0b74 002083E5 		str	r2, [r3, #0]
 257:../tp.c       ****     
 258:../tp.c       ****     oneTouch = 0;
 3227              		.loc 1 258 0
 3228 0b78 1C309FE5 		ldr	r3, .L39
 3229 0b7c 0020A0E3 		mov	r2, #0
 3230 0b80 002083E5 		str	r2, [r3, #0]
 259:../tp.c       **** 	CheckTSP = 0;// has checked
 3231              		.loc 1 259 0
 3232 0b84 2C309FE5 		ldr	r3, .L39+28
 3233 0b88 0020A0E3 		mov	r2, #0
 3234 0b8c 002083E5 		str	r2, [r3, #0]
 3235              	.L34:
 260:../tp.c       **** 	
 261:../tp.c       **** 	}// end if(oneTouch == 0)
 262:../tp.c       **** 
 263:../tp.c       **** }
 3236              		.loc 1 263 0
 3237 0b90 0CD04BE2 		sub	sp, fp, #12
 3238 0b94 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3239 0b98 1EFF2FE1 		bx	lr
 3240              	.L40:
 3241              		.align	2
 3242              	.L39:
 3243 0b9c 00000000 		.word	oneTouch
 3244 0ba0 00000000 		.word	Vx
 3245 0ba4 00000000 		.word	Vy
 3246 0ba8 00000000 		.word	Xmax
 3247 0bac 00000000 		.word	Xmin
 3248 0bb0 00000000 		.word	Ymax
 3249 0bb4 00000000 		.word	Ymin
 3250 0bb8 00000000 		.word	CheckTSP
 3251              		.cfi_endproc
 3252              	.LFE5:
 3254              		.align	2
 3255              		.global	Check_Sel
 3257              	Check_Sel:
 3258              	.LFB6:
 264:../tp.c       **** 
 265:../tp.c       **** void Check_Sel(void)
 266:../tp.c       **** {
 3259              		.loc 1 266 0
 3260              		.cfi_startproc
 3261              		@ Function supports interworking.
 3262              		@ args = 0, pretend = 0, frame = 8
 3263              		@ frame_needed = 1, uses_anonymous_args = 0
 3264 0bbc 0DC0A0E1 		mov	ip, sp
 3265              	.LCFI12:
 3266              		.cfi_def_cfa_register 12
 3267 0bc0 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3268 0bc4 04B04CE2 		sub	fp, ip, #4
 3269              		.cfi_offset 14, -8
 3270              		.cfi_offset 13, -12
 3271              		.cfi_offset 11, -16
 3272              	.LCFI13:
 3273              		.cfi_def_cfa 11, 4
 3274 0bc8 08D04DE2 		sub	sp, sp, #8
 3275              	.L45:
 267:../tp.c       **** 	char yn;
 268:../tp.c       ****     
 269:../tp.c       **** 	do{
 270:../tp.c       **** 	  
 271:../tp.c       **** 	  rINTMSK |=BIT_GLOBAL|BIT_EINT2;
 3276              		.loc 1 271 0
 3277 0bcc CC309FE5 		ldr	r3, .L47
 3278 0bd0 C8209FE5 		ldr	r2, .L47
 3279 0bd4 002092E5 		ldr	r2, [r2, #0]
 3280 0bd8 122582E3 		orr	r2, r2, #75497472
 3281 0bdc 002083E5 		str	r2, [r3, #0]
 272:../tp.c       **** //    Uart_Printf("\n\r Touch Screen coordinate Rang in:\n");
 273:../tp.c       **** //    Uart_Printf("   (Xmin,Ymin) is :(%04d,%04d)\n",Xmin,Ymin);	
 274:../tp.c       **** //	  Uart_Printf("   (Xmax,Ymax) is :(%04d,%04d)\n",Xmax,Ymax);	
 275:../tp.c       **** //	  Uart_Printf("\n  To use current settings. Press N/n key. ");
 276:../tp.c       **** //	  Uart_Printf("\n\n\r  Want to Set Again(Y/N)? ");	        	      
 277:../tp.c       **** //	  yn = Uart_Getch();
 278:../tp.c       ****       rI_ISPC = BIT_EINT2;              // clear pending_bit
 3282              		.loc 1 278 0
 3283 0be0 BC309FE5 		ldr	r3, .L47+4
 3284 0be4 0225A0E3 		mov	r2, #8388608
 3285 0be8 002083E5 		str	r2, [r3, #0]
 279:../tp.c       ****       rINTMSK =~(BIT_GLOBAL|BIT_EINT2);
 3286              		.loc 1 279 0
 3287 0bec AC309FE5 		ldr	r3, .L47
 3288 0bf0 1225E0E3 		mvn	r2, #75497472
 3289 0bf4 002083E5 		str	r2, [r3, #0]
 280:../tp.c       **** //	  if((yn == 0x59)|(yn == 0x79)|(yn == 0x4E)|(yn == 0x6E)) Uart_SendByte(yn);	  
 281:../tp.c       **** 	  if((yn == 0x59)|(yn == 0x79))
 3290              		.loc 1 281 0
 3291 0bf8 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 3292 0bfc 590053E3 		cmp	r3, #89
 3293 0c00 0030A013 		movne	r3, #0
 3294 0c04 0130A003 		moveq	r3, #1
 3295 0c08 FF2003E2 		and	r2, r3, #255
 3296 0c0c 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 3297 0c10 790053E3 		cmp	r3, #121
 3298 0c14 0030A013 		movne	r3, #0
 3299 0c18 0130A003 		moveq	r3, #1
 3300 0c1c FF3003E2 		and	r3, r3, #255
 3301 0c20 033082E1 		orr	r3, r2, r3
 3302 0c24 FF3003E2 		and	r3, r3, #255
 3303 0c28 000053E3 		cmp	r3, #0
 3304 0c2c 1700000A 		beq	.L46
 282:../tp.c       **** 	    {
 283:../tp.c       **** //	      Uart_Printf("\n\n Touch TSP's Cornor to ensure Xmax,Ymax,Xmax,Xmin");	      
 284:../tp.c       **** 
 285:../tp.c       ****          //Init X Y rectangle
 286:../tp.c       ****           Xmax = 750;    Xmin = 200;
 3305              		.loc 1 286 0
 3306 0c30 70309FE5 		ldr	r3, .L47+8
 3307 0c34 70209FE5 		ldr	r2, .L47+12
 3308 0c38 002083E5 		str	r2, [r3, #0]
 3309 0c3c 6C309FE5 		ldr	r3, .L47+16
 3310 0c40 C820A0E3 		mov	r2, #200
 3311 0c44 002083E5 		str	r2, [r3, #0]
 287:../tp.c       ****           Ymax = 620;    Ymin = 120;
 3312              		.loc 1 287 0
 3313 0c48 64309FE5 		ldr	r3, .L47+20
 3314 0c4c 9B2FA0E3 		mov	r2, #620
 3315 0c50 002083E5 		str	r2, [r3, #0]
 3316 0c54 5C309FE5 		ldr	r3, .L47+24
 3317 0c58 7820A0E3 		mov	r2, #120
 3318 0c5c 002083E5 		str	r2, [r3, #0]
 288:../tp.c       **** 
 289:../tp.c       **** 	      oneTouch = 0;
 3319              		.loc 1 289 0
 3320 0c60 54309FE5 		ldr	r3, .L47+28
 3321 0c64 0020A0E3 		mov	r2, #0
 3322 0c68 002083E5 		str	r2, [r3, #0]
 290:../tp.c       **** 	      CheckTSP = 1; // mask to check
 3323              		.loc 1 290 0
 3324 0c6c 4C309FE5 		ldr	r3, .L47+32
 3325 0c70 0120A0E3 		mov	r2, #1
 3326 0c74 002083E5 		str	r2, [r3, #0]
 291:../tp.c       **** 	      while(CheckTSP);
 3327              		.loc 1 291 0
 3328 0c78 0000A0E1 		mov	r0, r0	@ nop
 3329              	.L43:
 3330              		.loc 1 291 0 is_stmt 0 discriminator 1
 3331 0c7c 3C309FE5 		ldr	r3, .L47+32
 3332 0c80 003093E5 		ldr	r3, [r3, #0]
 3333 0c84 000053E3 		cmp	r3, #0
 3334 0c88 FBFFFF1A 		bne	.L43
 292:../tp.c       **** 	      
 293:../tp.c       **** 	    }else break;	    
 294:../tp.c       **** 	  
 295:../tp.c       **** 	}while(1);
 3335              		.loc 1 295 0 is_stmt 1
 3336 0c8c CEFFFFEA 		b	.L45
 3337              	.L46:
 296:../tp.c       **** 	
 297:../tp.c       **** }
 3338              		.loc 1 297 0
 3339 0c90 0000A0E1 		mov	r0, r0	@ nop
 3340              	.L41:
 3341 0c94 0CD04BE2 		sub	sp, fp, #12
 3342 0c98 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3343 0c9c 1EFF2FE1 		bx	lr
 3344              	.L48:
 3345              		.align	2
 3346              	.L47:
 3347 0ca0 0C00E001 		.word	31457292
 3348 0ca4 2400E001 		.word	31457316
 3349 0ca8 00000000 		.word	Xmax
 3350 0cac EE020000 		.word	750
 3351 0cb0 00000000 		.word	Xmin
 3352 0cb4 00000000 		.word	Ymax
 3353 0cb8 00000000 		.word	Ymin
 3354 0cbc 00000000 		.word	oneTouch
 3355 0cc0 00000000 		.word	CheckTSP
 3356              		.cfi_endproc
 3357              	.LFE6:
 3359              		.align	2
 3361              	clamp:
 3362              	.LFB7:
 298:../tp.c       **** 
 299:../tp.c       **** /*===================================================================================
 300:../tp.c       ****  * FUNCIONES DE CALIBRACIÓN DE 5 PUNTOS
 301:../tp.c       ****  *===================================================================================*/
 302:../tp.c       **** 
 303:../tp.c       **** /*********************************************************************************************
 304:../tp.c       **** * name:     clamp
 305:../tp.c       **** * func:     Limita un valor entre mínimo y máximo
 306:../tp.c       **** *********************************************************************************************/
 307:../tp.c       **** static int clamp(int val, int min, int max)
 308:../tp.c       **** {
 3363              		.loc 1 308 0
 3364              		.cfi_startproc
 3365              		@ Function supports interworking.
 3366              		@ args = 0, pretend = 0, frame = 16
 3367              		@ frame_needed = 1, uses_anonymous_args = 0
 3368 0cc4 0DC0A0E1 		mov	ip, sp
 3369              	.LCFI14:
 3370              		.cfi_def_cfa_register 12
 3371 0cc8 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3372 0ccc 04B04CE2 		sub	fp, ip, #4
 3373              		.cfi_offset 14, -8
 3374              		.cfi_offset 13, -12
 3375              		.cfi_offset 11, -16
 3376              	.LCFI15:
 3377              		.cfi_def_cfa 11, 4
 3378 0cd0 10D04DE2 		sub	sp, sp, #16
 3379 0cd4 10000BE5 		str	r0, [fp, #-16]
 3380 0cd8 14100BE5 		str	r1, [fp, #-20]
 3381 0cdc 18200BE5 		str	r2, [fp, #-24]
 309:../tp.c       ****     if (val < min) return min;
 3382              		.loc 1 309 0
 3383 0ce0 10201BE5 		ldr	r2, [fp, #-16]
 3384 0ce4 14301BE5 		ldr	r3, [fp, #-20]
 3385 0ce8 030052E1 		cmp	r2, r3
 3386 0cec 010000AA 		bge	.L50
 3387              		.loc 1 309 0 is_stmt 0 discriminator 1
 3388 0cf0 14301BE5 		ldr	r3, [fp, #-20]
 3389 0cf4 060000EA 		b	.L51
 3390              	.L50:
 310:../tp.c       ****     if (val > max) return max;
 3391              		.loc 1 310 0 is_stmt 1
 3392 0cf8 10201BE5 		ldr	r2, [fp, #-16]
 3393 0cfc 18301BE5 		ldr	r3, [fp, #-24]
 3394 0d00 030052E1 		cmp	r2, r3
 3395 0d04 010000DA 		ble	.L52
 3396              		.loc 1 310 0 is_stmt 0 discriminator 1
 3397 0d08 18301BE5 		ldr	r3, [fp, #-24]
 3398 0d0c 000000EA 		b	.L51
 3399              	.L52:
 311:../tp.c       ****     return val;
 3400              		.loc 1 311 0 is_stmt 1
 3401 0d10 10301BE5 		ldr	r3, [fp, #-16]
 3402              	.L51:
 312:../tp.c       **** }
 3403              		.loc 1 312 0
 3404 0d14 0300A0E1 		mov	r0, r3
 3405 0d18 0CD04BE2 		sub	sp, fp, #12
 3406 0d1c 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3407 0d20 1EFF2FE1 		bx	lr
 3408              		.cfi_endproc
 3409              	.LFE7:
 3411              		.align	2
 3413              	draw_cross:
 3414              	.LFB8:
 313:../tp.c       **** 
 314:../tp.c       **** /*********************************************************************************************
 315:../tp.c       **** * name:     draw_cross
 316:../tp.c       **** * func:     Dibuja una cruz en las coordenadas especificadas
 317:../tp.c       **** *********************************************************************************************/
 318:../tp.c       **** static void draw_cross(int x, int y)
 319:../tp.c       **** {
 3415              		.loc 1 319 0
 3416              		.cfi_startproc
 3417              		@ Function supports interworking.
 3418              		@ args = 0, pretend = 0, frame = 16
 3419              		@ frame_needed = 1, uses_anonymous_args = 0
 3420 0d24 0DC0A0E1 		mov	ip, sp
 3421              	.LCFI16:
 3422              		.cfi_def_cfa_register 12
 3423 0d28 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3424 0d2c 04B04CE2 		sub	fp, ip, #4
 3425              		.cfi_offset 14, -8
 3426              		.cfi_offset 13, -12
 3427              		.cfi_offset 11, -16
 3428              	.LCFI17:
 3429              		.cfi_def_cfa 11, 4
 3430 0d30 10D04DE2 		sub	sp, sp, #16
 3431 0d34 18000BE5 		str	r0, [fp, #-24]
 3432 0d38 1C100BE5 		str	r1, [fp, #-28]
 320:../tp.c       ****     int i;
 321:../tp.c       ****     // Línea horizontal
 322:../tp.c       ****     for (i = -10; i <= 10; i++)
 3433              		.loc 1 322 0
 3434 0d3c 0930E0E3 		mvn	r3, #9
 3435 0d40 10300BE5 		str	r3, [fp, #-16]
 3436 0d44 500000EA 		b	.L54
 3437              	.L56:
 323:../tp.c       ****     {
 324:../tp.c       ****         if (x + i >= 0 && x + i < SCR_XSIZE)
 3438              		.loc 1 324 0
 3439 0d48 18201BE5 		ldr	r2, [fp, #-24]
 3440 0d4c 10301BE5 		ldr	r3, [fp, #-16]
 3441 0d50 033082E0 		add	r3, r2, r3
 3442 0d54 000053E3 		cmp	r3, #0
 3443 0d58 480000BA 		blt	.L55
 3444              		.loc 1 324 0 is_stmt 0 discriminator 1
 3445 0d5c 18201BE5 		ldr	r2, [fp, #-24]
 3446 0d60 10301BE5 		ldr	r3, [fp, #-16]
 3447 0d64 032082E0 		add	r2, r2, r3
 3448 0d68 7C329FE5 		ldr	r3, .L60
 3449 0d6c 030052E1 		cmp	r2, r3
 3450 0d70 420000CA 		bgt	.L55
 325:../tp.c       ****             (LCD_PutPixel(x + i, y, 0xf));
 3451              		.loc 1 325 0 is_stmt 1
 3452 0d74 1C201BE5 		ldr	r2, [fp, #-28]
 3453 0d78 0230A0E1 		mov	r3, r2
 3454 0d7c 0331A0E1 		mov	r3, r3, asl #2
 3455 0d80 023083E0 		add	r3, r3, r2
 3456 0d84 0333A0E1 		mov	r3, r3, asl #6
 3457 0d88 A32FA0E1 		mov	r2, r3, lsr #31
 3458 0d8c 033082E0 		add	r3, r2, r3
 3459 0d90 C330A0E1 		mov	r3, r3, asr #1
 3460 0d94 C32683E2 		add	r2, r3, #204472320
 3461 0d98 962C82E2 		add	r2, r2, #38400
 3462 0d9c 18101BE5 		ldr	r1, [fp, #-24]
 3463 0da0 10301BE5 		ldr	r3, [fp, #-16]
 3464 0da4 033081E0 		add	r3, r1, r3
 3465 0da8 071083E2 		add	r1, r3, #7
 3466 0dac 000053E3 		cmp	r3, #0
 3467 0db0 0130A0B1 		movlt	r3, r1
 3468 0db4 C331A0E1 		mov	r3, r3, asr #3
 3469 0db8 0331A0E1 		mov	r3, r3, asl #2
 3470 0dbc 033082E0 		add	r3, r2, r3
 3471 0dc0 0310A0E1 		mov	r1, r3
 3472 0dc4 1C201BE5 		ldr	r2, [fp, #-28]
 3473 0dc8 0230A0E1 		mov	r3, r2
 3474 0dcc 0331A0E1 		mov	r3, r3, asl #2
 3475 0dd0 023083E0 		add	r3, r3, r2
 3476 0dd4 0333A0E1 		mov	r3, r3, asl #6
 3477 0dd8 A32FA0E1 		mov	r2, r3, lsr #31
 3478 0ddc 033082E0 		add	r3, r2, r3
 3479 0de0 C330A0E1 		mov	r3, r3, asr #1
 3480 0de4 C32683E2 		add	r2, r3, #204472320
 3481 0de8 962C82E2 		add	r2, r2, #38400
 3482 0dec 18001BE5 		ldr	r0, [fp, #-24]
 3483 0df0 10301BE5 		ldr	r3, [fp, #-16]
 3484 0df4 033080E0 		add	r3, r0, r3
 3485 0df8 070083E2 		add	r0, r3, #7
 3486 0dfc 000053E3 		cmp	r3, #0
 3487 0e00 0030A0B1 		movlt	r3, r0
 3488 0e04 C331A0E1 		mov	r3, r3, asr #3
 3489 0e08 0331A0E1 		mov	r3, r3, asl #2
 3490 0e0c 033082E0 		add	r3, r2, r3
 3491 0e10 000093E5 		ldr	r0, [r3, #0]
 3492 0e14 18201BE5 		ldr	r2, [fp, #-24]
 3493 0e18 10301BE5 		ldr	r3, [fp, #-16]
 3494 0e1c 032082E0 		add	r2, r2, r3
 3495 0e20 C23FA0E1 		mov	r3, r2, asr #31
 3496 0e24 A33EA0E1 		mov	r3, r3, lsr #29
 3497 0e28 032082E0 		add	r2, r2, r3
 3498 0e2c 072002E2 		and	r2, r2, #7
 3499 0e30 023063E0 		rsb	r3, r3, r2
 3500 0e34 0331A0E1 		mov	r3, r3, asl #2
 3501 0e38 0F22A0E3 		mov	r2, #-268435456
 3502 0e3c 3233A0E1 		mov	r3, r2, lsr r3
 3503 0e40 0330E0E1 		mvn	r3, r3
 3504 0e44 030000E0 		and	r0, r0, r3
 3505 0e48 18201BE5 		ldr	r2, [fp, #-24]
 3506 0e4c 10301BE5 		ldr	r3, [fp, #-16]
 3507 0e50 032082E0 		add	r2, r2, r3
 3508 0e54 C23FA0E1 		mov	r3, r2, asr #31
 3509 0e58 A33EA0E1 		mov	r3, r3, lsr #29
 3510 0e5c 032082E0 		add	r2, r2, r3
 3511 0e60 072002E2 		and	r2, r2, #7
 3512 0e64 023063E0 		rsb	r3, r3, r2
 3513 0e68 073063E2 		rsb	r3, r3, #7
 3514 0e6c 0331A0E1 		mov	r3, r3, asl #2
 3515 0e70 0F20A0E3 		mov	r2, #15
 3516 0e74 1233A0E1 		mov	r3, r2, asl r3
 3517 0e78 033080E1 		orr	r3, r0, r3
 3518 0e7c 003081E5 		str	r3, [r1, #0]
 3519              	.L55:
 322:../tp.c       ****     for (i = -10; i <= 10; i++)
 3520              		.loc 1 322 0
 3521 0e80 10301BE5 		ldr	r3, [fp, #-16]
 3522 0e84 013083E2 		add	r3, r3, #1
 3523 0e88 10300BE5 		str	r3, [fp, #-16]
 3524              	.L54:
 322:../tp.c       ****     for (i = -10; i <= 10; i++)
 3525              		.loc 1 322 0 is_stmt 0 discriminator 1
 3526 0e8c 10301BE5 		ldr	r3, [fp, #-16]
 3527 0e90 0A0053E3 		cmp	r3, #10
 3528 0e94 ABFFFFDA 		ble	.L56
 326:../tp.c       ****     }
 327:../tp.c       ****     // Línea vertical
 328:../tp.c       ****     for (i = -10; i <= 10; i++)
 3529              		.loc 1 328 0 is_stmt 1
 3530 0e98 0930E0E3 		mvn	r3, #9
 3531 0e9c 10300BE5 		str	r3, [fp, #-16]
 3532 0ea0 4B0000EA 		b	.L57
 3533              	.L59:
 329:../tp.c       ****     {
 330:../tp.c       ****         if (y + i >= 0 && y + i < SCR_YSIZE)
 3534              		.loc 1 330 0
 3535 0ea4 1C201BE5 		ldr	r2, [fp, #-28]
 3536 0ea8 10301BE5 		ldr	r3, [fp, #-16]
 3537 0eac 033082E0 		add	r3, r2, r3
 3538 0eb0 000053E3 		cmp	r3, #0
 3539 0eb4 430000BA 		blt	.L58
 3540              		.loc 1 330 0 is_stmt 0 discriminator 1
 3541 0eb8 1C201BE5 		ldr	r2, [fp, #-28]
 3542 0ebc 10301BE5 		ldr	r3, [fp, #-16]
 3543 0ec0 033082E0 		add	r3, r2, r3
 3544 0ec4 EF0053E3 		cmp	r3, #239
 3545 0ec8 3E0000CA 		bgt	.L58
 331:../tp.c       ****             (LCD_PutPixel(x, y + i, 0xf));
 3546              		.loc 1 331 0 is_stmt 1
 3547 0ecc 1C201BE5 		ldr	r2, [fp, #-28]
 3548 0ed0 10301BE5 		ldr	r3, [fp, #-16]
 3549 0ed4 032082E0 		add	r2, r2, r3
 3550 0ed8 0230A0E1 		mov	r3, r2
 3551 0edc 0331A0E1 		mov	r3, r3, asl #2
 3552 0ee0 023083E0 		add	r3, r3, r2
 3553 0ee4 0333A0E1 		mov	r3, r3, asl #6
 3554 0ee8 A32FA0E1 		mov	r2, r3, lsr #31
 3555 0eec 033082E0 		add	r3, r2, r3
 3556 0ef0 C330A0E1 		mov	r3, r3, asr #1
 3557 0ef4 C32683E2 		add	r2, r3, #204472320
 3558 0ef8 962C82E2 		add	r2, r2, #38400
 3559 0efc 18301BE5 		ldr	r3, [fp, #-24]
 3560 0f00 071083E2 		add	r1, r3, #7
 3561 0f04 000053E3 		cmp	r3, #0
 3562 0f08 0130A0B1 		movlt	r3, r1
 3563 0f0c C331A0E1 		mov	r3, r3, asr #3
 3564 0f10 0331A0E1 		mov	r3, r3, asl #2
 3565 0f14 033082E0 		add	r3, r2, r3
 3566 0f18 0310A0E1 		mov	r1, r3
 3567 0f1c 1C201BE5 		ldr	r2, [fp, #-28]
 3568 0f20 10301BE5 		ldr	r3, [fp, #-16]
 3569 0f24 032082E0 		add	r2, r2, r3
 3570 0f28 0230A0E1 		mov	r3, r2
 3571 0f2c 0331A0E1 		mov	r3, r3, asl #2
 3572 0f30 023083E0 		add	r3, r3, r2
 3573 0f34 0333A0E1 		mov	r3, r3, asl #6
 3574 0f38 A32FA0E1 		mov	r2, r3, lsr #31
 3575 0f3c 033082E0 		add	r3, r2, r3
 3576 0f40 C330A0E1 		mov	r3, r3, asr #1
 3577 0f44 C32683E2 		add	r2, r3, #204472320
 3578 0f48 962C82E2 		add	r2, r2, #38400
 3579 0f4c 18301BE5 		ldr	r3, [fp, #-24]
 3580 0f50 070083E2 		add	r0, r3, #7
 3581 0f54 000053E3 		cmp	r3, #0
 3582 0f58 0030A0B1 		movlt	r3, r0
 3583 0f5c C331A0E1 		mov	r3, r3, asr #3
 3584 0f60 0331A0E1 		mov	r3, r3, asl #2
 3585 0f64 033082E0 		add	r3, r2, r3
 3586 0f68 000093E5 		ldr	r0, [r3, #0]
 3587 0f6c 18201BE5 		ldr	r2, [fp, #-24]
 3588 0f70 C23FA0E1 		mov	r3, r2, asr #31
 3589 0f74 A33EA0E1 		mov	r3, r3, lsr #29
 3590 0f78 032082E0 		add	r2, r2, r3
 3591 0f7c 072002E2 		and	r2, r2, #7
 3592 0f80 023063E0 		rsb	r3, r3, r2
 3593 0f84 0331A0E1 		mov	r3, r3, asl #2
 3594 0f88 0F22A0E3 		mov	r2, #-268435456
 3595 0f8c 3233A0E1 		mov	r3, r2, lsr r3
 3596 0f90 0330E0E1 		mvn	r3, r3
 3597 0f94 030000E0 		and	r0, r0, r3
 3598 0f98 18201BE5 		ldr	r2, [fp, #-24]
 3599 0f9c C23FA0E1 		mov	r3, r2, asr #31
 3600 0fa0 A33EA0E1 		mov	r3, r3, lsr #29
 3601 0fa4 032082E0 		add	r2, r2, r3
 3602 0fa8 072002E2 		and	r2, r2, #7
 3603 0fac 023063E0 		rsb	r3, r3, r2
 3604 0fb0 073063E2 		rsb	r3, r3, #7
 3605 0fb4 0331A0E1 		mov	r3, r3, asl #2
 3606 0fb8 0F20A0E3 		mov	r2, #15
 3607 0fbc 1233A0E1 		mov	r3, r2, asl r3
 3608 0fc0 033080E1 		orr	r3, r0, r3
 3609 0fc4 003081E5 		str	r3, [r1, #0]
 3610              	.L58:
 328:../tp.c       ****     for (i = -10; i <= 10; i++)
 3611              		.loc 1 328 0
 3612 0fc8 10301BE5 		ldr	r3, [fp, #-16]
 3613 0fcc 013083E2 		add	r3, r3, #1
 3614 0fd0 10300BE5 		str	r3, [fp, #-16]
 3615              	.L57:
 328:../tp.c       ****     for (i = -10; i <= 10; i++)
 3616              		.loc 1 328 0 is_stmt 0 discriminator 1
 3617 0fd4 10301BE5 		ldr	r3, [fp, #-16]
 3618 0fd8 0A0053E3 		cmp	r3, #10
 3619 0fdc B0FFFFDA 		ble	.L59
 332:../tp.c       ****     }
 333:../tp.c       **** }
 3620              		.loc 1 333 0 is_stmt 1
 3621 0fe0 0CD04BE2 		sub	sp, fp, #12
 3622 0fe4 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3623 0fe8 1EFF2FE1 		bx	lr
 3624              	.L61:
 3625              		.align	2
 3626              	.L60:
 3627 0fec 3F010000 		.word	319
 3628              		.cfi_endproc
 3629              	.LFE8:
 3631              		.align	2
 3632              		.global	report_touch_data
 3634              	report_touch_data:
 3635              	.LFB9:
 334:../tp.c       **** 
 335:../tp.c       **** /*********************************************************************************************
 336:../tp.c       **** * name:     report_touch_data
 337:../tp.c       **** * func:     Llamada desde TSInt() para reportar coordenadas crudas
 338:../tp.c       **** *           Implementa antirrebote: ignora toques muy rápidos (< 300ms desde último toque)
 339:../tp.c       **** *********************************************************************************************/
 340:../tp.c       **** void report_touch_data(int x, int y)
 341:../tp.c       **** {
 3636              		.loc 1 341 0
 3637              		.cfi_startproc
 3638              		@ Function supports interworking.
 3639              		@ args = 0, pretend = 0, frame = 16
 3640              		@ frame_needed = 1, uses_anonymous_args = 0
 3641 0ff0 0DC0A0E1 		mov	ip, sp
 3642              	.LCFI18:
 3643              		.cfi_def_cfa_register 12
 3644 0ff4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3645 0ff8 04B04CE2 		sub	fp, ip, #4
 3646              		.cfi_offset 14, -8
 3647              		.cfi_offset 13, -12
 3648              		.cfi_offset 11, -16
 3649              	.LCFI19:
 3650              		.cfi_def_cfa 11, 4
 3651 0ffc 10D04DE2 		sub	sp, sp, #16
 3652 1000 18000BE5 		str	r0, [fp, #-24]
 3653 1004 1C100BE5 		str	r1, [fp, #-28]
 342:../tp.c       ****     unsigned int current_time = timer2_count();
 3654              		.loc 1 342 0
 3655 1008 FEFFFFEB 		bl	timer2_count
 3656 100c 14000BE5 		str	r0, [fp, #-20]
 343:../tp.c       ****     unsigned int time_diff;
 344:../tp.c       ****     
 345:../tp.c       ****     /* Calcular diferencia de tiempo (manejando overflow del contador) */
 346:../tp.c       ****     if (current_time >= g_last_touch_time)
 3657              		.loc 1 346 0
 3658 1010 9C309FE5 		ldr	r3, .L66
 3659 1014 003093E5 		ldr	r3, [r3, #0]
 3660 1018 14201BE5 		ldr	r2, [fp, #-20]
 3661 101c 030052E1 		cmp	r2, r3
 3662 1020 0500003A 		bcc	.L63
 347:../tp.c       ****         time_diff = current_time - g_last_touch_time;
 3663              		.loc 1 347 0
 3664 1024 88309FE5 		ldr	r3, .L66
 3665 1028 003093E5 		ldr	r3, [r3, #0]
 3666 102c 14201BE5 		ldr	r2, [fp, #-20]
 3667 1030 023063E0 		rsb	r3, r3, r2
 3668 1034 10300BE5 		str	r3, [fp, #-16]
 3669 1038 060000EA 		b	.L64
 3670              	.L63:
 348:../tp.c       ****     else
 349:../tp.c       ****         time_diff = (0xFFFFFFFF - g_last_touch_time) + current_time + 1;
 3671              		.loc 1 349 0
 3672 103c 70309FE5 		ldr	r3, .L66
 3673 1040 003093E5 		ldr	r3, [r3, #0]
 3674 1044 0320E0E1 		mvn	r2, r3
 3675 1048 14301BE5 		ldr	r3, [fp, #-20]
 3676 104c 033082E0 		add	r3, r2, r3
 3677 1050 013083E2 		add	r3, r3, #1
 3678 1054 10300BE5 		str	r3, [fp, #-16]
 3679              	.L64:
 350:../tp.c       ****     
 351:../tp.c       ****     /* Solo aceptar el toque si ha pasado suficiente tiempo desde el último */
 352:../tp.c       ****     if (g_ts_ready == 0 && time_diff >= TOUCH_DEBOUNCE_TIME)
 3680              		.loc 1 352 0
 3681 1058 58309FE5 		ldr	r3, .L66+4
 3682 105c 003093E5 		ldr	r3, [r3, #0]
 3683 1060 000053E3 		cmp	r3, #0
 3684 1064 0F00001A 		bne	.L62
 3685              		.loc 1 352 0 is_stmt 0 discriminator 1
 3686 1068 10201BE5 		ldr	r2, [fp, #-16]
 3687 106c 48309FE5 		ldr	r3, .L66+8
 3688 1070 030052E1 		cmp	r2, r3
 3689 1074 0B00009A 		bls	.L62
 353:../tp.c       ****     {
 354:../tp.c       ****         g_ts_raw_x = x;
 3690              		.loc 1 354 0 is_stmt 1
 3691 1078 40309FE5 		ldr	r3, .L66+12
 3692 107c 18201BE5 		ldr	r2, [fp, #-24]
 3693 1080 002083E5 		str	r2, [r3, #0]
 355:../tp.c       ****         g_ts_raw_y = y;
 3694              		.loc 1 355 0
 3695 1084 38309FE5 		ldr	r3, .L66+16
 3696 1088 1C201BE5 		ldr	r2, [fp, #-28]
 3697 108c 002083E5 		str	r2, [r3, #0]
 356:../tp.c       ****         g_ts_ready = 1;
 3698              		.loc 1 356 0
 3699 1090 20309FE5 		ldr	r3, .L66+4
 3700 1094 0120A0E3 		mov	r2, #1
 3701 1098 002083E5 		str	r2, [r3, #0]
 357:../tp.c       ****         g_last_touch_time = current_time;  /* Actualizar tiempo del último toque */
 3702              		.loc 1 357 0
 3703 109c 10309FE5 		ldr	r3, .L66
 3704 10a0 14201BE5 		ldr	r2, [fp, #-20]
 3705 10a4 002083E5 		str	r2, [r3, #0]
 3706              	.L62:
 358:../tp.c       ****     }
 359:../tp.c       **** }
 3707              		.loc 1 359 0
 3708 10a8 0CD04BE2 		sub	sp, fp, #12
 3709 10ac 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3710 10b0 1EFF2FE1 		bx	lr
 3711              	.L67:
 3712              		.align	2
 3713              	.L66:
 3714 10b4 28000000 		.word	g_last_touch_time
 3715 10b8 1C000000 		.word	g_ts_ready
 3716 10bc DF930400 		.word	299999
 3717 10c0 20000000 		.word	g_ts_raw_x
 3718 10c4 24000000 		.word	g_ts_raw_y
 3719              		.cfi_endproc
 3720              	.LFE9:
 3722              		.align	2
 3724              	ts_wait_for_touch:
 3725              	.LFB10:
 360:../tp.c       **** 
 361:../tp.c       **** /*********************************************************************************************
 362:../tp.c       **** * name:     ts_wait_for_touch
 363:../tp.c       **** * func:     Espera hasta detectar un toque
 364:../tp.c       **** *********************************************************************************************/
 365:../tp.c       **** static void ts_wait_for_touch(void)
 366:../tp.c       **** {
 3726              		.loc 1 366 0
 3727              		.cfi_startproc
 3728              		@ Function supports interworking.
 3729              		@ args = 0, pretend = 0, frame = 0
 3730              		@ frame_needed = 1, uses_anonymous_args = 0
 3731 10c8 0DC0A0E1 		mov	ip, sp
 3732              	.LCFI20:
 3733              		.cfi_def_cfa_register 12
 3734 10cc 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3735 10d0 04B04CE2 		sub	fp, ip, #4
 3736              		.cfi_offset 14, -8
 3737              		.cfi_offset 13, -12
 3738              		.cfi_offset 11, -16
 3739              	.LCFI21:
 3740              		.cfi_def_cfa 11, 4
 367:../tp.c       ****     g_ts_ready = 0;
 3741              		.loc 1 367 0
 3742 10d4 24309FE5 		ldr	r3, .L70
 3743 10d8 0020A0E3 		mov	r2, #0
 3744 10dc 002083E5 		str	r2, [r3, #0]
 368:../tp.c       ****     while (g_ts_ready == 0)
 3745              		.loc 1 368 0
 3746 10e0 0000A0E1 		mov	r0, r0	@ nop
 3747              	.L69:
 3748              		.loc 1 368 0 is_stmt 0 discriminator 1
 3749 10e4 14309FE5 		ldr	r3, .L70
 3750 10e8 003093E5 		ldr	r3, [r3, #0]
 3751 10ec 000053E3 		cmp	r3, #0
 3752 10f0 FBFFFF0A 		beq	.L69
 369:../tp.c       ****     {
 370:../tp.c       ****         // Esperar interrupción
 371:../tp.c       ****     }
 372:../tp.c       **** }
 3753              		.loc 1 372 0 is_stmt 1
 3754 10f4 0CD04BE2 		sub	sp, fp, #12
 3755 10f8 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3756 10fc 1EFF2FE1 		bx	lr
 3757              	.L71:
 3758              		.align	2
 3759              	.L70:
 3760 1100 1C000000 		.word	g_ts_ready
 3761              		.cfi_endproc
 3762              	.LFE10:
 3764              		.align	2
 3766              	ts_read_raw:
 3767              	.LFB11:
 373:../tp.c       **** 
 374:../tp.c       **** /*********************************************************************************************
 375:../tp.c       **** * name:     ts_read_raw
 376:../tp.c       **** * func:     Lee coordenadas crudas del ADC (bloqueante)
 377:../tp.c       **** *********************************************************************************************/
 378:../tp.c       **** static void ts_read_raw(int *xr, int *yr)
 379:../tp.c       **** {
 3768              		.loc 1 379 0
 3769              		.cfi_startproc
 3770              		@ Function supports interworking.
 3771              		@ args = 0, pretend = 0, frame = 8
 3772              		@ frame_needed = 1, uses_anonymous_args = 0
 3773 1104 0DC0A0E1 		mov	ip, sp
 3774              	.LCFI22:
 3775              		.cfi_def_cfa_register 12
 3776 1108 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3777 110c 04B04CE2 		sub	fp, ip, #4
 3778              		.cfi_offset 14, -8
 3779              		.cfi_offset 13, -12
 3780              		.cfi_offset 11, -16
 3781              	.LCFI23:
 3782              		.cfi_def_cfa 11, 4
 3783 1110 08D04DE2 		sub	sp, sp, #8
 3784 1114 10000BE5 		str	r0, [fp, #-16]
 3785 1118 14100BE5 		str	r1, [fp, #-20]
 380:../tp.c       ****     ts_wait_for_touch();
 3786              		.loc 1 380 0
 3787 111c E9FFFFEB 		bl	ts_wait_for_touch
 381:../tp.c       ****     *xr = g_ts_raw_x;
 3788              		.loc 1 381 0
 3789 1120 24309FE5 		ldr	r3, .L73
 3790 1124 002093E5 		ldr	r2, [r3, #0]
 3791 1128 10301BE5 		ldr	r3, [fp, #-16]
 3792 112c 002083E5 		str	r2, [r3, #0]
 382:../tp.c       ****     *yr = g_ts_raw_y;
 3793              		.loc 1 382 0
 3794 1130 18309FE5 		ldr	r3, .L73+4
 3795 1134 002093E5 		ldr	r2, [r3, #0]
 3796 1138 14301BE5 		ldr	r3, [fp, #-20]
 3797 113c 002083E5 		str	r2, [r3, #0]
 383:../tp.c       **** }
 3798              		.loc 1 383 0
 3799 1140 0CD04BE2 		sub	sp, fp, #12
 3800 1144 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3801 1148 1EFF2FE1 		bx	lr
 3802              	.L74:
 3803              		.align	2
 3804              	.L73:
 3805 114c 20000000 		.word	g_ts_raw_x
 3806 1150 24000000 		.word	g_ts_raw_y
 3807              		.cfi_endproc
 3808              	.LFE11:
 3810              		.align	2
 3812              	get_cal_point:
 3813              	.LFB12:
 384:../tp.c       **** 
 385:../tp.c       **** /*********************************************************************************************
 386:../tp.c       **** * name:     get_cal_point
 387:../tp.c       **** * func:     5 toques × 20 muestras = 100 muestras totales con filtrado robusto
 388:../tp.c       **** *********************************************************************************************/
 389:../tp.c       **** static void get_cal_point(int lcd_x, int lcd_y, int *ts_x, int *ts_y)
 390:../tp.c       **** {
 3814              		.loc 1 390 0
 3815              		.cfi_startproc
 3816              		@ Function supports interworking.
 3817              		@ args = 0, pretend = 0, frame = 848
 3818              		@ frame_needed = 1, uses_anonymous_args = 0
 3819 1154 0DC0A0E1 		mov	ip, sp
 3820              	.LCFI24:
 3821              		.cfi_def_cfa_register 12
 3822 1158 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3823 115c 04B04CE2 		sub	fp, ip, #4
 3824              		.cfi_offset 14, -8
 3825              		.cfi_offset 13, -12
 3826              		.cfi_offset 11, -16
 3827              	.LCFI25:
 3828              		.cfi_def_cfa 11, 4
 3829 1160 35DE4DE2 		sub	sp, sp, #848
 3830 1164 50030BE5 		str	r0, [fp, #-848]
 3831 1168 54130BE5 		str	r1, [fp, #-852]
 3832 116c 58230BE5 		str	r2, [fp, #-856]
 3833 1170 5C330BE5 		str	r3, [fp, #-860]
 391:../tp.c       ****     int i, j, k;
 392:../tp.c       ****     int samples_x[100], samples_y[100];  // 5 toques × 20 muestras = 100
 393:../tp.c       ****     int sum_x = 0, sum_y = 0;
 3834              		.loc 1 393 0
 3835 1174 0030A0E3 		mov	r3, #0
 3836 1178 1C300BE5 		str	r3, [fp, #-28]
 3837 117c 0030A0E3 		mov	r3, #0
 3838 1180 20300BE5 		str	r3, [fp, #-32]
 394:../tp.c       ****     int temp;
 395:../tp.c       ****     int sample_idx = 0;
 3839              		.loc 1 395 0
 3840 1184 0030A0E3 		mov	r3, #0
 3841 1188 24300BE5 		str	r3, [fp, #-36]
 396:../tp.c       ****     
 397:../tp.c       ****     draw_cross(lcd_x, lcd_y);
 3842              		.loc 1 397 0
 3843 118c 50031BE5 		ldr	r0, [fp, #-848]
 3844 1190 54131BE5 		ldr	r1, [fp, #-852]
 3845 1194 E2FEFFEB 		bl	draw_cross
 398:../tp.c       ****     Lcd_Dma_Trans();
 3846              		.loc 1 398 0
 3847 1198 FEFFFFEB 		bl	Lcd_Dma_Trans
 399:../tp.c       ****     Delay(80);
 3848              		.loc 1 399 0
 3849 119c 5000A0E3 		mov	r0, #80
 3850 11a0 FEFFFFEB 		bl	Delay
 400:../tp.c       ****     
 401:../tp.c       ****     // Tomar 5 toques, cada uno con 20 muestras capturadas rápidamente
 402:../tp.c       ****     for (k = 0; k < 5; k++)
 3851              		.loc 1 402 0
 3852 11a4 0030A0E3 		mov	r3, #0
 3853 11a8 18300BE5 		str	r3, [fp, #-24]
 3854 11ac 2D0000EA 		b	.L76
 3855              	.L80:
 403:../tp.c       ****     {
 404:../tp.c       ****         // Esperar el toque inicial (solo UNA vez por toque)
 405:../tp.c       ****         ts_wait_for_touch();
 3856              		.loc 1 405 0
 3857 11b0 C4FFFFEB 		bl	ts_wait_for_touch
 406:../tp.c       ****         Delay(50);  // Estabilizar tras primer contacto
 3858              		.loc 1 406 0
 3859 11b4 3200A0E3 		mov	r0, #50
 3860 11b8 FEFFFFEB 		bl	Delay
 407:../tp.c       ****         
 408:../tp.c       ****         // Ahora simplemente capturar 20 muestras rápidas del valor actual
 409:../tp.c       ****         // Sin esperar g_ts_ready entre ellas - el touchscreen sigue actualizando
 410:../tp.c       ****         for (i = 0; i < 20; i++)
 3861              		.loc 1 410 0
 3862 11bc 0030A0E3 		mov	r3, #0
 3863 11c0 10300BE5 		str	r3, [fp, #-16]
 3864 11c4 190000EA 		b	.L77
 3865              	.L78:
 411:../tp.c       ****         {
 412:../tp.c       ****             // Capturar el valor actual directamente
 413:../tp.c       ****             samples_x[sample_idx] = g_ts_raw_x;
 3866              		.loc 1 413 0 discriminator 2
 3867 11c8 AC339FE5 		ldr	r3, .L93
 3868 11cc 002093E5 		ldr	r2, [r3, #0]
 3869 11d0 24101BE5 		ldr	r1, [fp, #-36]
 3870 11d4 A4339FE5 		ldr	r3, .L93+4
 3871 11d8 0111A0E1 		mov	r1, r1, asl #2
 3872 11dc 0C004BE2 		sub	r0, fp, #12
 3873 11e0 011080E0 		add	r1, r0, r1
 3874 11e4 033081E0 		add	r3, r1, r3
 3875 11e8 002083E5 		str	r2, [r3, #0]
 414:../tp.c       ****             samples_y[sample_idx] = g_ts_raw_y;
 3876              		.loc 1 414 0 discriminator 2
 3877 11ec 90339FE5 		ldr	r3, .L93+8
 3878 11f0 002093E5 		ldr	r2, [r3, #0]
 3879 11f4 24101BE5 		ldr	r1, [fp, #-36]
 3880 11f8 88339FE5 		ldr	r3, .L93+12
 3881 11fc 0111A0E1 		mov	r1, r1, asl #2
 3882 1200 0C004BE2 		sub	r0, fp, #12
 3883 1204 011080E0 		add	r1, r0, r1
 3884 1208 033081E0 		add	r3, r1, r3
 3885 120c 002083E5 		str	r2, [r3, #0]
 415:../tp.c       ****             sample_idx++;
 3886              		.loc 1 415 0 discriminator 2
 3887 1210 24301BE5 		ldr	r3, [fp, #-36]
 3888 1214 013083E2 		add	r3, r3, #1
 3889 1218 24300BE5 		str	r3, [fp, #-36]
 416:../tp.c       ****             
 417:../tp.c       ****             // Pequeño delay entre lecturas para tener algo de variación
 418:../tp.c       ****             Delay(10);
 3890              		.loc 1 418 0 discriminator 2
 3891 121c 0A00A0E3 		mov	r0, #10
 3892 1220 FEFFFFEB 		bl	Delay
 410:../tp.c       ****         for (i = 0; i < 20; i++)
 3893              		.loc 1 410 0 discriminator 2
 3894 1224 10301BE5 		ldr	r3, [fp, #-16]
 3895 1228 013083E2 		add	r3, r3, #1
 3896 122c 10300BE5 		str	r3, [fp, #-16]
 3897              	.L77:
 410:../tp.c       ****         for (i = 0; i < 20; i++)
 3898              		.loc 1 410 0 is_stmt 0 discriminator 1
 3899 1230 10301BE5 		ldr	r3, [fp, #-16]
 3900 1234 130053E3 		cmp	r3, #19
 3901 1238 E2FFFFDA 		ble	.L78
 419:../tp.c       ****         }
 420:../tp.c       ****         
 421:../tp.c       ****         // Esperar a que levante el dedo antes del siguiente toque
 422:../tp.c       ****         if (k < 4) {  // No esperar tras el último toque
 3902              		.loc 1 422 0 is_stmt 1
 3903 123c 18301BE5 		ldr	r3, [fp, #-24]
 3904 1240 030053E3 		cmp	r3, #3
 3905 1244 040000CA 		bgt	.L79
 423:../tp.c       ****             Delay(200);
 3906              		.loc 1 423 0
 3907 1248 C800A0E3 		mov	r0, #200
 3908 124c FEFFFFEB 		bl	Delay
 424:../tp.c       ****             g_ts_ready = 0;  // Resetear para el próximo toque
 3909              		.loc 1 424 0
 3910 1250 34339FE5 		ldr	r3, .L93+16
 3911 1254 0020A0E3 		mov	r2, #0
 3912 1258 002083E5 		str	r2, [r3, #0]
 3913              	.L79:
 402:../tp.c       ****     for (k = 0; k < 5; k++)
 3914              		.loc 1 402 0
 3915 125c 18301BE5 		ldr	r3, [fp, #-24]
 3916 1260 013083E2 		add	r3, r3, #1
 3917 1264 18300BE5 		str	r3, [fp, #-24]
 3918              	.L76:
 402:../tp.c       ****     for (k = 0; k < 5; k++)
 3919              		.loc 1 402 0 is_stmt 0 discriminator 1
 3920 1268 18301BE5 		ldr	r3, [fp, #-24]
 3921 126c 040053E3 		cmp	r3, #4
 3922 1270 CEFFFFDA 		ble	.L80
 425:../tp.c       ****         }
 426:../tp.c       ****     }
 427:../tp.c       ****     
 428:../tp.c       ****     // Ordenar muestras X (bubble sort)
 429:../tp.c       ****     for (i = 0; i < 99; i++) {
 3923              		.loc 1 429 0 is_stmt 1
 3924 1274 0030A0E3 		mov	r3, #0
 3925 1278 10300BE5 		str	r3, [fp, #-16]
 3926 127c 3E0000EA 		b	.L81
 3927              	.L85:
 430:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 3928              		.loc 1 430 0
 3929 1280 0030A0E3 		mov	r3, #0
 3930 1284 14300BE5 		str	r3, [fp, #-20]
 3931 1288 330000EA 		b	.L82
 3932              	.L84:
 431:../tp.c       ****             if (samples_x[j] > samples_x[j + 1]) {
 3933              		.loc 1 431 0
 3934 128c 14201BE5 		ldr	r2, [fp, #-20]
 3935 1290 E8329FE5 		ldr	r3, .L93+4
 3936 1294 0221A0E1 		mov	r2, r2, asl #2
 3937 1298 0C104BE2 		sub	r1, fp, #12
 3938 129c 022081E0 		add	r2, r1, r2
 3939 12a0 033082E0 		add	r3, r2, r3
 3940 12a4 002093E5 		ldr	r2, [r3, #0]
 3941 12a8 14301BE5 		ldr	r3, [fp, #-20]
 3942 12ac 011083E2 		add	r1, r3, #1
 3943 12b0 C8329FE5 		ldr	r3, .L93+4
 3944 12b4 0111A0E1 		mov	r1, r1, asl #2
 3945 12b8 0C004BE2 		sub	r0, fp, #12
 3946 12bc 011080E0 		add	r1, r0, r1
 3947 12c0 033081E0 		add	r3, r1, r3
 3948 12c4 003093E5 		ldr	r3, [r3, #0]
 3949 12c8 030052E1 		cmp	r2, r3
 3950 12cc 1F0000DA 		ble	.L83
 432:../tp.c       ****                 temp = samples_x[j];
 3951              		.loc 1 432 0
 3952 12d0 14201BE5 		ldr	r2, [fp, #-20]
 3953 12d4 A4329FE5 		ldr	r3, .L93+4
 3954 12d8 0221A0E1 		mov	r2, r2, asl #2
 3955 12dc 0C104BE2 		sub	r1, fp, #12
 3956 12e0 022081E0 		add	r2, r1, r2
 3957 12e4 033082E0 		add	r3, r2, r3
 3958 12e8 003093E5 		ldr	r3, [r3, #0]
 3959 12ec 28300BE5 		str	r3, [fp, #-40]
 433:../tp.c       ****                 samples_x[j] = samples_x[j + 1];
 3960              		.loc 1 433 0
 3961 12f0 14301BE5 		ldr	r3, [fp, #-20]
 3962 12f4 012083E2 		add	r2, r3, #1
 3963 12f8 80329FE5 		ldr	r3, .L93+4
 3964 12fc 0221A0E1 		mov	r2, r2, asl #2
 3965 1300 0C004BE2 		sub	r0, fp, #12
 3966 1304 022080E0 		add	r2, r0, r2
 3967 1308 033082E0 		add	r3, r2, r3
 3968 130c 002093E5 		ldr	r2, [r3, #0]
 3969 1310 14101BE5 		ldr	r1, [fp, #-20]
 3970 1314 64329FE5 		ldr	r3, .L93+4
 3971 1318 0111A0E1 		mov	r1, r1, asl #2
 3972 131c 0C004BE2 		sub	r0, fp, #12
 3973 1320 011080E0 		add	r1, r0, r1
 3974 1324 033081E0 		add	r3, r1, r3
 3975 1328 002083E5 		str	r2, [r3, #0]
 434:../tp.c       ****                 samples_x[j + 1] = temp;
 3976              		.loc 1 434 0
 3977 132c 14301BE5 		ldr	r3, [fp, #-20]
 3978 1330 012083E2 		add	r2, r3, #1
 3979 1334 44329FE5 		ldr	r3, .L93+4
 3980 1338 0221A0E1 		mov	r2, r2, asl #2
 3981 133c 0C104BE2 		sub	r1, fp, #12
 3982 1340 022081E0 		add	r2, r1, r2
 3983 1344 033082E0 		add	r3, r2, r3
 3984 1348 28201BE5 		ldr	r2, [fp, #-40]
 3985 134c 002083E5 		str	r2, [r3, #0]
 3986              	.L83:
 430:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 3987              		.loc 1 430 0
 3988 1350 14301BE5 		ldr	r3, [fp, #-20]
 3989 1354 013083E2 		add	r3, r3, #1
 3990 1358 14300BE5 		str	r3, [fp, #-20]
 3991              	.L82:
 430:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 3992              		.loc 1 430 0 is_stmt 0 discriminator 1
 3993 135c 10301BE5 		ldr	r3, [fp, #-16]
 3994 1360 632063E2 		rsb	r2, r3, #99
 3995 1364 14301BE5 		ldr	r3, [fp, #-20]
 3996 1368 030052E1 		cmp	r2, r3
 3997 136c C6FFFFCA 		bgt	.L84
 429:../tp.c       ****     for (i = 0; i < 99; i++) {
 3998              		.loc 1 429 0 is_stmt 1
 3999 1370 10301BE5 		ldr	r3, [fp, #-16]
 4000 1374 013083E2 		add	r3, r3, #1
 4001 1378 10300BE5 		str	r3, [fp, #-16]
 4002              	.L81:
 429:../tp.c       ****     for (i = 0; i < 99; i++) {
 4003              		.loc 1 429 0 is_stmt 0 discriminator 1
 4004 137c 10301BE5 		ldr	r3, [fp, #-16]
 4005 1380 620053E3 		cmp	r3, #98
 4006 1384 BDFFFFDA 		ble	.L85
 435:../tp.c       ****             }
 436:../tp.c       ****         }
 437:../tp.c       ****     }
 438:../tp.c       ****     
 439:../tp.c       ****     // Ordenar muestras Y
 440:../tp.c       ****     for (i = 0; i < 99; i++) {
 4007              		.loc 1 440 0 is_stmt 1
 4008 1388 0030A0E3 		mov	r3, #0
 4009 138c 10300BE5 		str	r3, [fp, #-16]
 4010 1390 3E0000EA 		b	.L86
 4011              	.L90:
 441:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 4012              		.loc 1 441 0
 4013 1394 0030A0E3 		mov	r3, #0
 4014 1398 14300BE5 		str	r3, [fp, #-20]
 4015 139c 330000EA 		b	.L87
 4016              	.L89:
 442:../tp.c       ****             if (samples_y[j] > samples_y[j + 1]) {
 4017              		.loc 1 442 0
 4018 13a0 14201BE5 		ldr	r2, [fp, #-20]
 4019 13a4 DC319FE5 		ldr	r3, .L93+12
 4020 13a8 0221A0E1 		mov	r2, r2, asl #2
 4021 13ac 0C004BE2 		sub	r0, fp, #12
 4022 13b0 022080E0 		add	r2, r0, r2
 4023 13b4 033082E0 		add	r3, r2, r3
 4024 13b8 002093E5 		ldr	r2, [r3, #0]
 4025 13bc 14301BE5 		ldr	r3, [fp, #-20]
 4026 13c0 011083E2 		add	r1, r3, #1
 4027 13c4 BC319FE5 		ldr	r3, .L93+12
 4028 13c8 0111A0E1 		mov	r1, r1, asl #2
 4029 13cc 0C004BE2 		sub	r0, fp, #12
 4030 13d0 011080E0 		add	r1, r0, r1
 4031 13d4 033081E0 		add	r3, r1, r3
 4032 13d8 003093E5 		ldr	r3, [r3, #0]
 4033 13dc 030052E1 		cmp	r2, r3
 4034 13e0 1F0000DA 		ble	.L88
 443:../tp.c       ****                 temp = samples_y[j];
 4035              		.loc 1 443 0
 4036 13e4 14201BE5 		ldr	r2, [fp, #-20]
 4037 13e8 98319FE5 		ldr	r3, .L93+12
 4038 13ec 0221A0E1 		mov	r2, r2, asl #2
 4039 13f0 0C104BE2 		sub	r1, fp, #12
 4040 13f4 022081E0 		add	r2, r1, r2
 4041 13f8 033082E0 		add	r3, r2, r3
 4042 13fc 003093E5 		ldr	r3, [r3, #0]
 4043 1400 28300BE5 		str	r3, [fp, #-40]
 444:../tp.c       ****                 samples_y[j] = samples_y[j + 1];
 4044              		.loc 1 444 0
 4045 1404 14301BE5 		ldr	r3, [fp, #-20]
 4046 1408 012083E2 		add	r2, r3, #1
 4047 140c 74319FE5 		ldr	r3, .L93+12
 4048 1410 0221A0E1 		mov	r2, r2, asl #2
 4049 1414 0C004BE2 		sub	r0, fp, #12
 4050 1418 022080E0 		add	r2, r0, r2
 4051 141c 033082E0 		add	r3, r2, r3
 4052 1420 002093E5 		ldr	r2, [r3, #0]
 4053 1424 14101BE5 		ldr	r1, [fp, #-20]
 4054 1428 58319FE5 		ldr	r3, .L93+12
 4055 142c 0111A0E1 		mov	r1, r1, asl #2
 4056 1430 0C004BE2 		sub	r0, fp, #12
 4057 1434 011080E0 		add	r1, r0, r1
 4058 1438 033081E0 		add	r3, r1, r3
 4059 143c 002083E5 		str	r2, [r3, #0]
 445:../tp.c       ****                 samples_y[j + 1] = temp;
 4060              		.loc 1 445 0
 4061 1440 14301BE5 		ldr	r3, [fp, #-20]
 4062 1444 012083E2 		add	r2, r3, #1
 4063 1448 38319FE5 		ldr	r3, .L93+12
 4064 144c 0221A0E1 		mov	r2, r2, asl #2
 4065 1450 0C104BE2 		sub	r1, fp, #12
 4066 1454 022081E0 		add	r2, r1, r2
 4067 1458 033082E0 		add	r3, r2, r3
 4068 145c 28201BE5 		ldr	r2, [fp, #-40]
 4069 1460 002083E5 		str	r2, [r3, #0]
 4070              	.L88:
 441:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 4071              		.loc 1 441 0
 4072 1464 14301BE5 		ldr	r3, [fp, #-20]
 4073 1468 013083E2 		add	r3, r3, #1
 4074 146c 14300BE5 		str	r3, [fp, #-20]
 4075              	.L87:
 441:../tp.c       ****         for (j = 0; j < 99 - i; j++) {
 4076              		.loc 1 441 0 is_stmt 0 discriminator 1
 4077 1470 10301BE5 		ldr	r3, [fp, #-16]
 4078 1474 632063E2 		rsb	r2, r3, #99
 4079 1478 14301BE5 		ldr	r3, [fp, #-20]
 4080 147c 030052E1 		cmp	r2, r3
 4081 1480 C6FFFFCA 		bgt	.L89
 440:../tp.c       ****     for (i = 0; i < 99; i++) {
 4082              		.loc 1 440 0 is_stmt 1
 4083 1484 10301BE5 		ldr	r3, [fp, #-16]
 4084 1488 013083E2 		add	r3, r3, #1
 4085 148c 10300BE5 		str	r3, [fp, #-16]
 4086              	.L86:
 440:../tp.c       ****     for (i = 0; i < 99; i++) {
 4087              		.loc 1 440 0 is_stmt 0 discriminator 1
 4088 1490 10301BE5 		ldr	r3, [fp, #-16]
 4089 1494 620053E3 		cmp	r3, #98
 4090 1498 BDFFFFDA 		ble	.L90
 446:../tp.c       ****             }
 447:../tp.c       ****         }
 448:../tp.c       ****     }
 449:../tp.c       ****     
 450:../tp.c       ****     // Promediar las 60 muestras centrales (descartando 20 mínimas y 20 máximas)
 451:../tp.c       ****     for (i = 20; i < 80; i++) {
 4091              		.loc 1 451 0 is_stmt 1
 4092 149c 1430A0E3 		mov	r3, #20
 4093 14a0 10300BE5 		str	r3, [fp, #-16]
 4094 14a4 160000EA 		b	.L91
 4095              	.L92:
 452:../tp.c       ****         sum_x += samples_x[i];
 4096              		.loc 1 452 0 discriminator 2
 4097 14a8 10201BE5 		ldr	r2, [fp, #-16]
 4098 14ac CC309FE5 		ldr	r3, .L93+4
 4099 14b0 0221A0E1 		mov	r2, r2, asl #2
 4100 14b4 0C004BE2 		sub	r0, fp, #12
 4101 14b8 022080E0 		add	r2, r0, r2
 4102 14bc 033082E0 		add	r3, r2, r3
 4103 14c0 003093E5 		ldr	r3, [r3, #0]
 4104 14c4 1C201BE5 		ldr	r2, [fp, #-28]
 4105 14c8 033082E0 		add	r3, r2, r3
 4106 14cc 1C300BE5 		str	r3, [fp, #-28]
 453:../tp.c       ****         sum_y += samples_y[i];
 4107              		.loc 1 453 0 discriminator 2
 4108 14d0 10201BE5 		ldr	r2, [fp, #-16]
 4109 14d4 AC309FE5 		ldr	r3, .L93+12
 4110 14d8 0221A0E1 		mov	r2, r2, asl #2
 4111 14dc 0C104BE2 		sub	r1, fp, #12
 4112 14e0 022081E0 		add	r2, r1, r2
 4113 14e4 033082E0 		add	r3, r2, r3
 4114 14e8 003093E5 		ldr	r3, [r3, #0]
 4115 14ec 20201BE5 		ldr	r2, [fp, #-32]
 4116 14f0 033082E0 		add	r3, r2, r3
 4117 14f4 20300BE5 		str	r3, [fp, #-32]
 451:../tp.c       ****     for (i = 20; i < 80; i++) {
 4118              		.loc 1 451 0 discriminator 2
 4119 14f8 10301BE5 		ldr	r3, [fp, #-16]
 4120 14fc 013083E2 		add	r3, r3, #1
 4121 1500 10300BE5 		str	r3, [fp, #-16]
 4122              	.L91:
 451:../tp.c       ****     for (i = 20; i < 80; i++) {
 4123              		.loc 1 451 0 is_stmt 0 discriminator 1
 4124 1504 10301BE5 		ldr	r3, [fp, #-16]
 4125 1508 4F0053E3 		cmp	r3, #79
 4126 150c E5FFFFDA 		ble	.L92
 454:../tp.c       ****     }
 455:../tp.c       ****     
 456:../tp.c       ****     *ts_x = sum_x / 60;
 4127              		.loc 1 456 0 is_stmt 1
 4128 1510 1C301BE5 		ldr	r3, [fp, #-28]
 4129 1514 74209FE5 		ldr	r2, .L93+20
 4130 1518 9302C2E0 		smull	r0, r2, r3, r2
 4131 151c 032082E0 		add	r2, r2, r3
 4132 1520 C222A0E1 		mov	r2, r2, asr #5
 4133 1524 C33FA0E1 		mov	r3, r3, asr #31
 4134 1528 022063E0 		rsb	r2, r3, r2
 4135 152c 58331BE5 		ldr	r3, [fp, #-856]
 4136 1530 002083E5 		str	r2, [r3, #0]
 457:../tp.c       ****     *ts_y = sum_y / 60;
 4137              		.loc 1 457 0
 4138 1534 20301BE5 		ldr	r3, [fp, #-32]
 4139 1538 50209FE5 		ldr	r2, .L93+20
 4140 153c 9312C2E0 		smull	r1, r2, r3, r2
 4141 1540 032082E0 		add	r2, r2, r3
 4142 1544 C222A0E1 		mov	r2, r2, asr #5
 4143 1548 C33FA0E1 		mov	r3, r3, asr #31
 4144 154c 022063E0 		rsb	r2, r3, r2
 4145 1550 5C331BE5 		ldr	r3, [fp, #-860]
 4146 1554 002083E5 		str	r2, [r3, #0]
 458:../tp.c       ****     
 459:../tp.c       ****     Delay(50);
 4147              		.loc 1 459 0
 4148 1558 3200A0E3 		mov	r0, #50
 4149 155c FEFFFFEB 		bl	Delay
 460:../tp.c       ****     draw_cross(lcd_x, lcd_y);
 4150              		.loc 1 460 0
 4151 1560 50031BE5 		ldr	r0, [fp, #-848]
 4152 1564 54131BE5 		ldr	r1, [fp, #-852]
 4153 1568 EDFDFFEB 		bl	draw_cross
 461:../tp.c       ****     Lcd_Dma_Trans();
 4154              		.loc 1 461 0
 4155 156c FEFFFFEB 		bl	Lcd_Dma_Trans
 462:../tp.c       **** }
 4156              		.loc 1 462 0
 4157 1570 0CD04BE2 		sub	sp, fp, #12
 4158 1574 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4159 1578 1EFF2FE1 		bx	lr
 4160              	.L94:
 4161              		.align	2
 4162              	.L93:
 4163 157c 20000000 		.word	g_ts_raw_x
 4164 1580 54FEFFFF 		.word	-428
 4165 1584 24000000 		.word	g_ts_raw_y
 4166 1588 C4FCFFFF 		.word	-828
 4167 158c 1C000000 		.word	g_ts_ready
 4168 1590 89888888 		.word	-2004318071
 4169              		.cfi_endproc
 4170              	.LFE12:
 4172              		.section	.rodata
 4173 003e 0000     		.align	2
 4174              	.LC16:
 4175 0040 43616C69 		.ascii	"Calibracion 5pts\000"
 4175      62726163 
 4175      696F6E20 
 4175      35707473 
 4175      00
 4176 0051 000000   		.align	2
 4177              	.LC17:
 4178 0054 546F6361 		.ascii	"Toca punto A\000"
 4178      2070756E 
 4178      746F2041 
 4178      00
 4179 0061 000000   		.align	2
 4180              	.LC18:
 4181 0064 546F6361 		.ascii	"Toca punto B\000"
 4181      2070756E 
 4181      746F2042 
 4181      00
 4182 0071 000000   		.align	2
 4183              	.LC19:
 4184 0074 546F6361 		.ascii	"Toca punto C\000"
 4184      2070756E 
 4184      746F2043 
 4184      00
 4185 0081 000000   		.align	2
 4186              	.LC20:
 4187 0084 546F6361 		.ascii	"Toca punto D\000"
 4187      2070756E 
 4187      746F2044 
 4187      00
 4188 0091 000000   		.align	2
 4189              	.LC21:
 4190 0094 546F6361 		.ascii	"Toca centro E\000"
 4190      2063656E 
 4190      74726F20 
 4190      4500
 4191              		.global	__aeabi_ldivmod
 4192              		.text
 4193              		.align	2
 4194              		.global	ts_calibrate_5pt
 4196              	ts_calibrate_5pt:
 4197              	.LFB13:
 463:../tp.c       **** 
 464:../tp.c       **** /*********************************************************************************************
 465:../tp.c       **** * name:     ts_calibrate_5pt
 466:../tp.c       **** * func:     Calibración de 5 puntos del touchscreen
 467:../tp.c       **** * para:     XRES - resolución horizontal, YRES - vertical, M - margen
 468:../tp.c       **** * comment:  Implementa método con detección swap XY y escalas con signo (fixed-point 16.16)
 469:../tp.c       **** *********************************************************************************************/
 470:../tp.c       **** void ts_calibrate_5pt(int XRES, int YRES, int M)
 471:../tp.c       **** {
 4198              		.loc 1 471 0
 4199              		.cfi_startproc
 4200              		@ Function supports interworking.
 4201              		@ args = 0, pretend = 0, frame = 144
 4202              		@ frame_needed = 1, uses_anonymous_args = 0
 4203 1594 0DC0A0E1 		mov	ip, sp
 4204              	.LCFI26:
 4205              		.cfi_def_cfa_register 12
 4206 1598 10D82DE9 		stmfd	sp!, {r4, fp, ip, lr, pc}
 4207 159c 04B04CE2 		sub	fp, ip, #4
 4208              		.cfi_offset 14, -8
 4209              		.cfi_offset 13, -12
 4210              		.cfi_offset 11, -16
 4211              		.cfi_offset 4, -20
 4212              	.LCFI27:
 4213              		.cfi_def_cfa 11, 4
 4214 15a0 94D04DE2 		sub	sp, sp, #148
 4215 15a4 98000BE5 		str	r0, [fp, #-152]
 4216 15a8 9C100BE5 		str	r1, [fp, #-156]
 4217 15ac A0200BE5 		str	r2, [fp, #-160]
 472:../tp.c       ****     int A_lcd_x, A_lcd_y, A_ts_x, A_ts_y;
 473:../tp.c       ****     int B_lcd_x, B_lcd_y, B_ts_x, B_ts_y;
 474:../tp.c       ****     int C_lcd_x, C_lcd_y, C_ts_x, C_ts_y;
 475:../tp.c       ****     int D_lcd_x, D_lcd_y, D_ts_x, D_ts_y;
 476:../tp.c       ****     int E_lcd_x, E_lcd_y, E_ts_x, E_ts_y;
 477:../tp.c       ****     
 478:../tp.c       ****     int dx, dy;
 479:../tp.c       ****     int lcd_s, lcd_d;
 480:../tp.c       ****     int ts_s1, ts_s2, ts_d1, ts_d2;
 481:../tp.c       ****     long long temp;
 482:../tp.c       ****     
 483:../tp.c       ****     Lcd_Clr();
 4218              		.loc 1 483 0
 4219 15b0 FEFFFFEB 		bl	Lcd_Clr
 484:../tp.c       ****     Lcd_Active_Clr();
 4220              		.loc 1 484 0
 4221 15b4 FEFFFFEB 		bl	Lcd_Active_Clr
 485:../tp.c       ****     Lcd_DspAscII8x16(60, 110, BLACK, (unsigned char *)"Calibracion 5pts");
 4222              		.loc 1 485 0
 4223 15b8 3C00A0E3 		mov	r0, #60
 4224 15bc 6E10A0E3 		mov	r1, #110
 4225 15c0 0F20A0E3 		mov	r2, #15
 4226 15c4 70349FE5 		ldr	r3, .L100
 4227 15c8 FEFFFFEB 		bl	Lcd_DspAscII8x16
 486:../tp.c       ****     Lcd_Dma_Trans();
 4228              		.loc 1 486 0
 4229 15cc FEFFFFEB 		bl	Lcd_Dma_Trans
 487:../tp.c       ****     Delay(100);
 4230              		.loc 1 487 0
 4231 15d0 6400A0E3 		mov	r0, #100
 4232 15d4 FEFFFFEB 		bl	Delay
 488:../tp.c       ****     
 489:../tp.c       ****     Lcd_Clr();
 4233              		.loc 1 489 0
 4234 15d8 FEFFFFEB 		bl	Lcd_Clr
 490:../tp.c       ****     Lcd_Dma_Trans();
 4235              		.loc 1 490 0
 4236 15dc FEFFFFEB 		bl	Lcd_Dma_Trans
 491:../tp.c       ****     
 492:../tp.c       ****     // Definir posiciones LCD de los 5 puntos
 493:../tp.c       ****     A_lcd_x = M;            A_lcd_y = M;
 4237              		.loc 1 493 0
 4238 15e0 A0301BE5 		ldr	r3, [fp, #-160]
 4239 15e4 20300BE5 		str	r3, [fp, #-32]
 4240 15e8 A0301BE5 		ldr	r3, [fp, #-160]
 4241 15ec 24300BE5 		str	r3, [fp, #-36]
 494:../tp.c       ****     B_lcd_x = XRES - M;     B_lcd_y = M;
 4242              		.loc 1 494 0
 4243 15f0 98201BE5 		ldr	r2, [fp, #-152]
 4244 15f4 A0301BE5 		ldr	r3, [fp, #-160]
 4245 15f8 023063E0 		rsb	r3, r3, r2
 4246 15fc 28300BE5 		str	r3, [fp, #-40]
 4247 1600 A0301BE5 		ldr	r3, [fp, #-160]
 4248 1604 2C300BE5 		str	r3, [fp, #-44]
 495:../tp.c       ****     C_lcd_x = XRES - M;     C_lcd_y = YRES - M;
 4249              		.loc 1 495 0
 4250 1608 98201BE5 		ldr	r2, [fp, #-152]
 4251 160c A0301BE5 		ldr	r3, [fp, #-160]
 4252 1610 023063E0 		rsb	r3, r3, r2
 4253 1614 30300BE5 		str	r3, [fp, #-48]
 4254 1618 9C201BE5 		ldr	r2, [fp, #-156]
 4255 161c A0301BE5 		ldr	r3, [fp, #-160]
 4256 1620 023063E0 		rsb	r3, r3, r2
 4257 1624 34300BE5 		str	r3, [fp, #-52]
 496:../tp.c       ****     D_lcd_x = M;            D_lcd_y = YRES - M;
 4258              		.loc 1 496 0
 4259 1628 A0301BE5 		ldr	r3, [fp, #-160]
 4260 162c 38300BE5 		str	r3, [fp, #-56]
 4261 1630 9C201BE5 		ldr	r2, [fp, #-156]
 4262 1634 A0301BE5 		ldr	r3, [fp, #-160]
 4263 1638 023063E0 		rsb	r3, r3, r2
 4264 163c 3C300BE5 		str	r3, [fp, #-60]
 497:../tp.c       ****     E_lcd_x = XRES / 2;     E_lcd_y = YRES / 2;
 4265              		.loc 1 497 0
 4266 1640 98301BE5 		ldr	r3, [fp, #-152]
 4267 1644 A32FA0E1 		mov	r2, r3, lsr #31
 4268 1648 033082E0 		add	r3, r2, r3
 4269 164c C330A0E1 		mov	r3, r3, asr #1
 4270 1650 40300BE5 		str	r3, [fp, #-64]
 4271 1654 9C301BE5 		ldr	r3, [fp, #-156]
 4272 1658 A32FA0E1 		mov	r2, r3, lsr #31
 4273 165c 033082E0 		add	r3, r2, r3
 4274 1660 C330A0E1 		mov	r3, r3, asr #1
 4275 1664 44300BE5 		str	r3, [fp, #-68]
 498:../tp.c       ****     
 499:../tp.c       ****     // Capturar punto A
 500:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto A");
 4276              		.loc 1 500 0
 4277 1668 0A00A0E3 		mov	r0, #10
 4278 166c 0A10A0E3 		mov	r1, #10
 4279 1670 0F20A0E3 		mov	r2, #15
 4280 1674 C4339FE5 		ldr	r3, .L100+4
 4281 1678 FEFFFFEB 		bl	Lcd_DspAscII6x8
 501:../tp.c       ****     Lcd_Dma_Trans();
 4282              		.loc 1 501 0
 4283 167c FEFFFFEB 		bl	Lcd_Dma_Trans
 502:../tp.c       ****     get_cal_point(A_lcd_x, A_lcd_y, &A_ts_x, &A_ts_y);
 4284              		.loc 1 502 0
 4285 1680 70204BE2 		sub	r2, fp, #112
 4286 1684 74304BE2 		sub	r3, fp, #116
 4287 1688 20001BE5 		ldr	r0, [fp, #-32]
 4288 168c 24101BE5 		ldr	r1, [fp, #-36]
 4289 1690 AFFEFFEB 		bl	get_cal_point
 503:../tp.c       ****     
 504:../tp.c       ****     // Capturar punto B
 505:../tp.c       ****     Lcd_Clr();
 4290              		.loc 1 505 0
 4291 1694 FEFFFFEB 		bl	Lcd_Clr
 506:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto B");
 4292              		.loc 1 506 0
 4293 1698 0A00A0E3 		mov	r0, #10
 4294 169c 0A10A0E3 		mov	r1, #10
 4295 16a0 0F20A0E3 		mov	r2, #15
 4296 16a4 98339FE5 		ldr	r3, .L100+8
 4297 16a8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 507:../tp.c       ****     Lcd_Dma_Trans();
 4298              		.loc 1 507 0
 4299 16ac FEFFFFEB 		bl	Lcd_Dma_Trans
 508:../tp.c       ****     get_cal_point(B_lcd_x, B_lcd_y, &B_ts_x, &B_ts_y);
 4300              		.loc 1 508 0
 4301 16b0 78204BE2 		sub	r2, fp, #120
 4302 16b4 7C304BE2 		sub	r3, fp, #124
 4303 16b8 28001BE5 		ldr	r0, [fp, #-40]
 4304 16bc 2C101BE5 		ldr	r1, [fp, #-44]
 4305 16c0 A3FEFFEB 		bl	get_cal_point
 509:../tp.c       ****     
 510:../tp.c       ****     // Capturar punto C
 511:../tp.c       ****     Lcd_Clr();
 4306              		.loc 1 511 0
 4307 16c4 FEFFFFEB 		bl	Lcd_Clr
 512:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto C");
 4308              		.loc 1 512 0
 4309 16c8 0A00A0E3 		mov	r0, #10
 4310 16cc 0A10A0E3 		mov	r1, #10
 4311 16d0 0F20A0E3 		mov	r2, #15
 4312 16d4 6C339FE5 		ldr	r3, .L100+12
 4313 16d8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 513:../tp.c       ****     Lcd_Dma_Trans();
 4314              		.loc 1 513 0
 4315 16dc FEFFFFEB 		bl	Lcd_Dma_Trans
 514:../tp.c       ****     get_cal_point(C_lcd_x, C_lcd_y, &C_ts_x, &C_ts_y);
 4316              		.loc 1 514 0
 4317 16e0 80204BE2 		sub	r2, fp, #128
 4318 16e4 84304BE2 		sub	r3, fp, #132
 4319 16e8 30001BE5 		ldr	r0, [fp, #-48]
 4320 16ec 34101BE5 		ldr	r1, [fp, #-52]
 4321 16f0 97FEFFEB 		bl	get_cal_point
 515:../tp.c       ****     
 516:../tp.c       ****     // Capturar punto D
 517:../tp.c       ****     Lcd_Clr();
 4322              		.loc 1 517 0
 4323 16f4 FEFFFFEB 		bl	Lcd_Clr
 518:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto D");
 4324              		.loc 1 518 0
 4325 16f8 0A00A0E3 		mov	r0, #10
 4326 16fc 0A10A0E3 		mov	r1, #10
 4327 1700 0F20A0E3 		mov	r2, #15
 4328 1704 40339FE5 		ldr	r3, .L100+16
 4329 1708 FEFFFFEB 		bl	Lcd_DspAscII6x8
 519:../tp.c       ****     Lcd_Dma_Trans();
 4330              		.loc 1 519 0
 4331 170c FEFFFFEB 		bl	Lcd_Dma_Trans
 520:../tp.c       ****     get_cal_point(D_lcd_x, D_lcd_y, &D_ts_x, &D_ts_y);
 4332              		.loc 1 520 0
 4333 1710 88204BE2 		sub	r2, fp, #136
 4334 1714 8C304BE2 		sub	r3, fp, #140
 4335 1718 38001BE5 		ldr	r0, [fp, #-56]
 4336 171c 3C101BE5 		ldr	r1, [fp, #-60]
 4337 1720 8BFEFFEB 		bl	get_cal_point
 521:../tp.c       ****     
 522:../tp.c       ****     // Capturar punto E (centro)
 523:../tp.c       ****     Lcd_Clr();
 4338              		.loc 1 523 0
 4339 1724 FEFFFFEB 		bl	Lcd_Clr
 524:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca centro E");
 4340              		.loc 1 524 0
 4341 1728 0A00A0E3 		mov	r0, #10
 4342 172c 0A10A0E3 		mov	r1, #10
 4343 1730 0F20A0E3 		mov	r2, #15
 4344 1734 14339FE5 		ldr	r3, .L100+20
 4345 1738 FEFFFFEB 		bl	Lcd_DspAscII6x8
 525:../tp.c       ****     Lcd_Dma_Trans();
 4346              		.loc 1 525 0
 4347 173c FEFFFFEB 		bl	Lcd_Dma_Trans
 526:../tp.c       ****     get_cal_point(E_lcd_x, E_lcd_y, &E_ts_x, &E_ts_y);
 4348              		.loc 1 526 0
 4349 1740 90204BE2 		sub	r2, fp, #144
 4350 1744 94304BE2 		sub	r3, fp, #148
 4351 1748 40001BE5 		ldr	r0, [fp, #-64]
 4352 174c 44101BE5 		ldr	r1, [fp, #-68]
 4353 1750 7FFEFFEB 		bl	get_cal_point
 527:../tp.c       ****     
 528:../tp.c       ****     // DETECCIÓN DE SWAP XY
 529:../tp.c       ****     dx = B_ts_x - A_ts_x;
 4354              		.loc 1 529 0
 4355 1754 78201BE5 		ldr	r2, [fp, #-120]
 4356 1758 70301BE5 		ldr	r3, [fp, #-112]
 4357 175c 023063E0 		rsb	r3, r3, r2
 4358 1760 18300BE5 		str	r3, [fp, #-24]
 530:../tp.c       ****     dy = B_ts_y - A_ts_y;
 4359              		.loc 1 530 0
 4360 1764 7C201BE5 		ldr	r2, [fp, #-124]
 4361 1768 74301BE5 		ldr	r3, [fp, #-116]
 4362 176c 023063E0 		rsb	r3, r3, r2
 4363 1770 1C300BE5 		str	r3, [fp, #-28]
 531:../tp.c       ****     if (dx < 0) dx = -dx;
 4364              		.loc 1 531 0
 4365 1774 18301BE5 		ldr	r3, [fp, #-24]
 4366 1778 000053E3 		cmp	r3, #0
 4367 177c 020000AA 		bge	.L96
 4368              		.loc 1 531 0 is_stmt 0 discriminator 1
 4369 1780 18301BE5 		ldr	r3, [fp, #-24]
 4370 1784 003063E2 		rsb	r3, r3, #0
 4371 1788 18300BE5 		str	r3, [fp, #-24]
 4372              	.L96:
 532:../tp.c       ****     if (dy < 0) dy = -dy;
 4373              		.loc 1 532 0 is_stmt 1
 4374 178c 1C301BE5 		ldr	r3, [fp, #-28]
 4375 1790 000053E3 		cmp	r3, #0
 4376 1794 020000AA 		bge	.L97
 4377              		.loc 1 532 0 is_stmt 0 discriminator 1
 4378 1798 1C301BE5 		ldr	r3, [fp, #-28]
 4379 179c 003063E2 		rsb	r3, r3, #0
 4380 17a0 1C300BE5 		str	r3, [fp, #-28]
 4381              	.L97:
 533:../tp.c       ****     
 534:../tp.c       ****     if (dx > dy)
 4382              		.loc 1 534 0 is_stmt 1
 4383 17a4 18201BE5 		ldr	r2, [fp, #-24]
 4384 17a8 1C301BE5 		ldr	r3, [fp, #-28]
 4385 17ac 030052E1 		cmp	r2, r3
 4386 17b0 030000DA 		ble	.L98
 535:../tp.c       ****     {
 536:../tp.c       ****         g_swap_xy = 0;
 4387              		.loc 1 536 0
 4388 17b4 98329FE5 		ldr	r3, .L100+24
 4389 17b8 0020A0E3 		mov	r2, #0
 4390 17bc 002083E5 		str	r2, [r3, #0]
 4391 17c0 200000EA 		b	.L99
 4392              	.L98:
 4393              	.LBB2:
 537:../tp.c       ****     }
 538:../tp.c       ****     else
 539:../tp.c       ****     {
 540:../tp.c       ****         g_swap_xy = 1;
 4394              		.loc 1 540 0
 4395 17c4 88329FE5 		ldr	r3, .L100+24
 4396 17c8 0120A0E3 		mov	r2, #1
 4397 17cc 002083E5 		str	r2, [r3, #0]
 541:../tp.c       ****         int tmp;
 542:../tp.c       ****         #define SWAP(a, b) { tmp = a; a = b; b = tmp; }
 543:../tp.c       ****         SWAP(A_ts_x, A_ts_y);
 4398              		.loc 1 543 0
 4399 17d0 70301BE5 		ldr	r3, [fp, #-112]
 4400 17d4 48300BE5 		str	r3, [fp, #-72]
 4401 17d8 74301BE5 		ldr	r3, [fp, #-116]
 4402 17dc 70300BE5 		str	r3, [fp, #-112]
 4403 17e0 48301BE5 		ldr	r3, [fp, #-72]
 4404 17e4 74300BE5 		str	r3, [fp, #-116]
 544:../tp.c       ****         SWAP(B_ts_x, B_ts_y);
 4405              		.loc 1 544 0
 4406 17e8 78301BE5 		ldr	r3, [fp, #-120]
 4407 17ec 48300BE5 		str	r3, [fp, #-72]
 4408 17f0 7C301BE5 		ldr	r3, [fp, #-124]
 4409 17f4 78300BE5 		str	r3, [fp, #-120]
 4410 17f8 48301BE5 		ldr	r3, [fp, #-72]
 4411 17fc 7C300BE5 		str	r3, [fp, #-124]
 545:../tp.c       ****         SWAP(C_ts_x, C_ts_y);
 4412              		.loc 1 545 0
 4413 1800 80301BE5 		ldr	r3, [fp, #-128]
 4414 1804 48300BE5 		str	r3, [fp, #-72]
 4415 1808 84301BE5 		ldr	r3, [fp, #-132]
 4416 180c 80300BE5 		str	r3, [fp, #-128]
 4417 1810 48301BE5 		ldr	r3, [fp, #-72]
 4418 1814 84300BE5 		str	r3, [fp, #-132]
 546:../tp.c       ****         SWAP(D_ts_x, D_ts_y);
 4419              		.loc 1 546 0
 4420 1818 88301BE5 		ldr	r3, [fp, #-136]
 4421 181c 48300BE5 		str	r3, [fp, #-72]
 4422 1820 8C301BE5 		ldr	r3, [fp, #-140]
 4423 1824 88300BE5 		str	r3, [fp, #-136]
 4424 1828 48301BE5 		ldr	r3, [fp, #-72]
 4425 182c 8C300BE5 		str	r3, [fp, #-140]
 547:../tp.c       ****         SWAP(E_ts_x, E_ts_y);
 4426              		.loc 1 547 0
 4427 1830 90301BE5 		ldr	r3, [fp, #-144]
 4428 1834 48300BE5 		str	r3, [fp, #-72]
 4429 1838 94301BE5 		ldr	r3, [fp, #-148]
 4430 183c 90300BE5 		str	r3, [fp, #-144]
 4431 1840 48301BE5 		ldr	r3, [fp, #-72]
 4432 1844 94300BE5 		str	r3, [fp, #-148]
 4433              	.L99:
 4434              	.LBE2:
 548:../tp.c       ****     }
 549:../tp.c       ****     
 550:../tp.c       ****     // CÁLCULO DEL CENTRO - usar promedio de los 4 puntos para mayor precisión
 551:../tp.c       ****     g_ts_xc = (A_ts_x + B_ts_x + C_ts_x + D_ts_x) / 4;
 4435              		.loc 1 551 0
 4436 1848 70201BE5 		ldr	r2, [fp, #-112]
 4437 184c 78301BE5 		ldr	r3, [fp, #-120]
 4438 1850 032082E0 		add	r2, r2, r3
 4439 1854 80301BE5 		ldr	r3, [fp, #-128]
 4440 1858 032082E0 		add	r2, r2, r3
 4441 185c 88301BE5 		ldr	r3, [fp, #-136]
 4442 1860 033082E0 		add	r3, r2, r3
 4443 1864 032083E2 		add	r2, r3, #3
 4444 1868 000053E3 		cmp	r3, #0
 4445 186c 0230A0B1 		movlt	r3, r2
 4446 1870 4331A0E1 		mov	r3, r3, asr #2
 4447 1874 0320A0E1 		mov	r2, r3
 4448 1878 D8319FE5 		ldr	r3, .L100+28
 4449 187c 002083E5 		str	r2, [r3, #0]
 552:../tp.c       ****     g_ts_yc = (A_ts_y + B_ts_y + C_ts_y + D_ts_y) / 4;
 4450              		.loc 1 552 0
 4451 1880 74201BE5 		ldr	r2, [fp, #-116]
 4452 1884 7C301BE5 		ldr	r3, [fp, #-124]
 4453 1888 032082E0 		add	r2, r2, r3
 4454 188c 84301BE5 		ldr	r3, [fp, #-132]
 4455 1890 032082E0 		add	r2, r2, r3
 4456 1894 8C301BE5 		ldr	r3, [fp, #-140]
 4457 1898 033082E0 		add	r3, r2, r3
 4458 189c 032083E2 		add	r2, r3, #3
 4459 18a0 000053E3 		cmp	r3, #0
 4460 18a4 0230A0B1 		movlt	r3, r2
 4461 18a8 4331A0E1 		mov	r3, r3, asr #2
 4462 18ac 0320A0E1 		mov	r2, r3
 4463 18b0 A4319FE5 		ldr	r3, .L100+32
 4464 18b4 002083E5 		str	r2, [r3, #0]
 553:../tp.c       ****     g_lcd_xc = XRES / 2;
 4465              		.loc 1 553 0
 4466 18b8 98301BE5 		ldr	r3, [fp, #-152]
 4467 18bc A32FA0E1 		mov	r2, r3, lsr #31
 4468 18c0 033082E0 		add	r3, r2, r3
 4469 18c4 C330A0E1 		mov	r3, r3, asr #1
 4470 18c8 0320A0E1 		mov	r2, r3
 4471 18cc 8C319FE5 		ldr	r3, .L100+36
 4472 18d0 002083E5 		str	r2, [r3, #0]
 554:../tp.c       ****     g_lcd_yc = YRES / 2;
 4473              		.loc 1 554 0
 4474 18d4 9C301BE5 		ldr	r3, [fp, #-156]
 4475 18d8 A32FA0E1 		mov	r2, r3, lsr #31
 4476 18dc 033082E0 		add	r3, r2, r3
 4477 18e0 C330A0E1 		mov	r3, r3, asr #1
 4478 18e4 0320A0E1 		mov	r2, r3
 4479 18e8 74319FE5 		ldr	r3, .L100+40
 4480 18ec 002083E5 		str	r2, [r3, #0]
 555:../tp.c       ****     
 556:../tp.c       ****     // CÁLCULO DE kx y ky (CON SIGNO - fixed-point 16.16)
 557:../tp.c       ****     lcd_s = XRES - 2 * M;
 4481              		.loc 1 557 0
 4482 18f0 A0201BE5 		ldr	r2, [fp, #-160]
 4483 18f4 0230A0E1 		mov	r3, r2
 4484 18f8 833FA0E1 		mov	r3, r3, asl #31
 4485 18fc 033062E0 		rsb	r3, r2, r3
 4486 1900 8330A0E1 		mov	r3, r3, asl #1
 4487 1904 0320A0E1 		mov	r2, r3
 4488 1908 98301BE5 		ldr	r3, [fp, #-152]
 4489 190c 033082E0 		add	r3, r2, r3
 4490 1910 4C300BE5 		str	r3, [fp, #-76]
 558:../tp.c       ****     lcd_d = YRES - 2 * M;
 4491              		.loc 1 558 0
 4492 1914 A0201BE5 		ldr	r2, [fp, #-160]
 4493 1918 0230A0E1 		mov	r3, r2
 4494 191c 833FA0E1 		mov	r3, r3, asl #31
 4495 1920 033062E0 		rsb	r3, r2, r3
 4496 1924 8330A0E1 		mov	r3, r3, asl #1
 4497 1928 0320A0E1 		mov	r2, r3
 4498 192c 9C301BE5 		ldr	r3, [fp, #-156]
 4499 1930 033082E0 		add	r3, r2, r3
 4500 1934 50300BE5 		str	r3, [fp, #-80]
 559:../tp.c       ****     
 560:../tp.c       ****     ts_s1 = B_ts_x - A_ts_x;
 4501              		.loc 1 560 0
 4502 1938 78201BE5 		ldr	r2, [fp, #-120]
 4503 193c 70301BE5 		ldr	r3, [fp, #-112]
 4504 1940 023063E0 		rsb	r3, r3, r2
 4505 1944 54300BE5 		str	r3, [fp, #-84]
 561:../tp.c       ****     ts_s2 = C_ts_x - D_ts_x;
 4506              		.loc 1 561 0
 4507 1948 80201BE5 		ldr	r2, [fp, #-128]
 4508 194c 88301BE5 		ldr	r3, [fp, #-136]
 4509 1950 023063E0 		rsb	r3, r3, r2
 4510 1954 58300BE5 		str	r3, [fp, #-88]
 562:../tp.c       ****     ts_d1 = D_ts_y - A_ts_y;
 4511              		.loc 1 562 0
 4512 1958 8C201BE5 		ldr	r2, [fp, #-140]
 4513 195c 74301BE5 		ldr	r3, [fp, #-116]
 4514 1960 023063E0 		rsb	r3, r3, r2
 4515 1964 5C300BE5 		str	r3, [fp, #-92]
 563:../tp.c       ****     ts_d2 = C_ts_y - B_ts_y;
 4516              		.loc 1 563 0
 4517 1968 84201BE5 		ldr	r2, [fp, #-132]
 4518 196c 7C301BE5 		ldr	r3, [fp, #-124]
 4519 1970 023063E0 		rsb	r3, r3, r2
 4520 1974 60300BE5 		str	r3, [fp, #-96]
 564:../tp.c       ****     
 565:../tp.c       ****     // Usar promedios para mayor precisión
 566:../tp.c       ****     temp = (long long)lcd_s << 17;  // Multiplicar por 2 usando shift (<<17 = <<16 * 2)
 4521              		.loc 1 566 0
 4522 1978 4C301BE5 		ldr	r3, [fp, #-76]
 4523 197c C34FA0E1 		mov	r4, r3, asr #31
 4524 1980 A327A0E1 		mov	r2, r3, lsr #15
 4525 1984 8418A0E1 		mov	r1, r4, asl #17
 4526 1988 022081E1 		orr	r2, r1, r2
 4527 198c 68200BE5 		str	r2, [fp, #-104]
 4528 1990 8338A0E1 		mov	r3, r3, asl #17
 4529 1994 6C300BE5 		str	r3, [fp, #-108]
 567:../tp.c       ****     g_kx_fp = (long)(temp / (ts_s1 + ts_s2));
 4530              		.loc 1 567 0
 4531 1998 54201BE5 		ldr	r2, [fp, #-84]
 4532 199c 58301BE5 		ldr	r3, [fp, #-88]
 4533 19a0 033082E0 		add	r3, r2, r3
 4534 19a4 C34FA0E1 		mov	r4, r3, asr #31
 4535 19a8 6C104BE2 		sub	r1, fp, #108
 4536 19ac 030091E8 		ldmia	r1, {r0-r1}
 4537 19b0 0320A0E1 		mov	r2, r3
 4538 19b4 0430A0E1 		mov	r3, r4
 4539 19b8 FEFFFFEB 		bl	__aeabi_ldivmod
 4540 19bc 0030A0E1 		mov	r3, r0
 4541 19c0 0140A0E1 		mov	r4, r1
 4542 19c4 0320A0E1 		mov	r2, r3
 4543 19c8 98309FE5 		ldr	r3, .L100+44
 4544 19cc 002083E5 		str	r2, [r3, #0]
 568:../tp.c       ****     
 569:../tp.c       ****     temp = (long long)lcd_d << 17;  // Multiplicar por 2 usando shift
 4545              		.loc 1 569 0
 4546 19d0 50301BE5 		ldr	r3, [fp, #-80]
 4547 19d4 C34FA0E1 		mov	r4, r3, asr #31
 4548 19d8 A327A0E1 		mov	r2, r3, lsr #15
 4549 19dc 8418A0E1 		mov	r1, r4, asl #17
 4550 19e0 022081E1 		orr	r2, r1, r2
 4551 19e4 68200BE5 		str	r2, [fp, #-104]
 4552 19e8 8338A0E1 		mov	r3, r3, asl #17
 4553 19ec 6C300BE5 		str	r3, [fp, #-108]
 570:../tp.c       ****     g_ky_fp = (long)(temp / (ts_d1 + ts_d2));
 4554              		.loc 1 570 0
 4555 19f0 5C201BE5 		ldr	r2, [fp, #-92]
 4556 19f4 60301BE5 		ldr	r3, [fp, #-96]
 4557 19f8 033082E0 		add	r3, r2, r3
 4558 19fc C34FA0E1 		mov	r4, r3, asr #31
 4559 1a00 6C104BE2 		sub	r1, fp, #108
 4560 1a04 030091E8 		ldmia	r1, {r0-r1}
 4561 1a08 0320A0E1 		mov	r2, r3
 4562 1a0c 0430A0E1 		mov	r3, r4
 4563 1a10 FEFFFFEB 		bl	__aeabi_ldivmod
 4564 1a14 0030A0E1 		mov	r3, r0
 4565 1a18 0140A0E1 		mov	r4, r1
 4566 1a1c 0320A0E1 		mov	r2, r3
 4567 1a20 44309FE5 		ldr	r3, .L100+48
 4568 1a24 002083E5 		str	r2, [r3, #0]
 571:../tp.c       ****     
 572:../tp.c       ****     // Limpiar pantalla tras calibración
 573:../tp.c       ****     Lcd_Clr();
 4569              		.loc 1 573 0
 4570 1a28 FEFFFFEB 		bl	Lcd_Clr
 574:../tp.c       ****     Lcd_Dma_Trans();
 4571              		.loc 1 574 0
 4572 1a2c FEFFFFEB 		bl	Lcd_Dma_Trans
 575:../tp.c       **** }
 4573              		.loc 1 575 0
 4574 1a30 10D04BE2 		sub	sp, fp, #16
 4575 1a34 10689DE8 		ldmfd	sp, {r4, fp, sp, lr}
 4576 1a38 1EFF2FE1 		bx	lr
 4577              	.L101:
 4578              		.align	2
 4579              	.L100:
 4580 1a3c 40000000 		.word	.LC16
 4581 1a40 54000000 		.word	.LC17
 4582 1a44 64000000 		.word	.LC18
 4583 1a48 74000000 		.word	.LC19
 4584 1a4c 84000000 		.word	.LC20
 4585 1a50 94000000 		.word	.LC21
 4586 1a54 00000000 		.word	g_swap_xy
 4587 1a58 0C000000 		.word	g_ts_xc
 4588 1a5c 10000000 		.word	g_ts_yc
 4589 1a60 14000000 		.word	g_lcd_xc
 4590 1a64 18000000 		.word	g_lcd_yc
 4591 1a68 04000000 		.word	g_kx_fp
 4592 1a6c 08000000 		.word	g_ky_fp
 4593              		.cfi_endproc
 4594              	.LFE13:
 4596              		.align	2
 4597              		.global	ts_read_calibrated
 4599              	ts_read_calibrated:
 4600              	.LFB14:
 576:../tp.c       **** 
 577:../tp.c       **** /*********************************************************************************************
 578:../tp.c       **** * name:     ts_read_calibrated
 579:../tp.c       **** * func:     Lee coordenadas calibradas del touchscreen
 580:../tp.c       **** * ret:      0 si éxito, -1 si no hay toque
 581:../tp.c       **** *********************************************************************************************/
 582:../tp.c       **** int ts_read_calibrated(int *x, int *y)
 583:../tp.c       **** {
 4601              		.loc 1 583 0
 4602              		.cfi_startproc
 4603              		@ Function supports interworking.
 4604              		@ args = 0, pretend = 0, frame = 40
 4605              		@ frame_needed = 1, uses_anonymous_args = 0
 4606 1a70 0DC0A0E1 		mov	ip, sp
 4607              	.LCFI28:
 4608              		.cfi_def_cfa_register 12
 4609 1a74 F0DF2DE9 		stmfd	sp!, {r4, r5, r6, r7, r8, r9, sl, fp, ip, lr, pc}
 4610 1a78 04B04CE2 		sub	fp, ip, #4
 4611              		.cfi_offset 14, -8
 4612              		.cfi_offset 13, -12
 4613              		.cfi_offset 11, -16
 4614              		.cfi_offset 10, -20
 4615              		.cfi_offset 9, -24
 4616              		.cfi_offset 8, -28
 4617              		.cfi_offset 7, -32
 4618              		.cfi_offset 6, -36
 4619              		.cfi_offset 5, -40
 4620              		.cfi_offset 4, -44
 4621              	.LCFI29:
 4622              		.cfi_def_cfa 11, 4
 4623 1a7c 2CD04DE2 		sub	sp, sp, #44
 4624 1a80 50000BE5 		str	r0, [fp, #-80]
 4625 1a84 54100BE5 		str	r1, [fp, #-84]
 584:../tp.c       ****     int xr, yr;
 585:../tp.c       ****     long long temp_x, temp_y;
 586:../tp.c       ****     
 587:../tp.c       ****     if (g_ts_ready == 0)
 4626              		.loc 1 587 0
 4627 1a88 C0219FE5 		ldr	r2, .L106
 4628 1a8c 002092E5 		ldr	r2, [r2, #0]
 4629 1a90 000052E3 		cmp	r2, #0
 4630 1a94 0100001A 		bne	.L103
 588:../tp.c       ****         return -1;
 4631              		.loc 1 588 0
 4632 1a98 0030E0E3 		mvn	r3, #0
 4633 1a9c 670000EA 		b	.L104
 4634              	.L103:
 589:../tp.c       ****     
 590:../tp.c       ****     xr = g_ts_raw_x;
 4635              		.loc 1 590 0
 4636 1aa0 AC219FE5 		ldr	r2, .L106+4
 4637 1aa4 002092E5 		ldr	r2, [r2, #0]
 4638 1aa8 30200BE5 		str	r2, [fp, #-48]
 591:../tp.c       ****     yr = g_ts_raw_y;
 4639              		.loc 1 591 0
 4640 1aac A4219FE5 		ldr	r2, .L106+8
 4641 1ab0 002092E5 		ldr	r2, [r2, #0]
 4642 1ab4 34200BE5 		str	r2, [fp, #-52]
 592:../tp.c       ****     g_ts_ready = 0;
 4643              		.loc 1 592 0
 4644 1ab8 90219FE5 		ldr	r2, .L106
 4645 1abc 0010A0E3 		mov	r1, #0
 4646 1ac0 001082E5 		str	r1, [r2, #0]
 593:../tp.c       ****     
 594:../tp.c       ****     // Aplicar swap si necesario
 595:../tp.c       ****     if (g_swap_xy)
 4647              		.loc 1 595 0
 4648 1ac4 90219FE5 		ldr	r2, .L106+12
 4649 1ac8 002092E5 		ldr	r2, [r2, #0]
 4650 1acc 000052E3 		cmp	r2, #0
 4651 1ad0 0500000A 		beq	.L105
 4652              	.LBB3:
 596:../tp.c       ****     {
 597:../tp.c       ****         int tmp = xr;
 4653              		.loc 1 597 0
 4654 1ad4 30201BE5 		ldr	r2, [fp, #-48]
 4655 1ad8 38200BE5 		str	r2, [fp, #-56]
 598:../tp.c       ****         xr = yr;
 4656              		.loc 1 598 0
 4657 1adc 34201BE5 		ldr	r2, [fp, #-52]
 4658 1ae0 30200BE5 		str	r2, [fp, #-48]
 599:../tp.c       ****         yr = tmp;
 4659              		.loc 1 599 0
 4660 1ae4 38201BE5 		ldr	r2, [fp, #-56]
 4661 1ae8 34200BE5 		str	r2, [fp, #-52]
 4662              	.L105:
 4663              	.LBE3:
 600:../tp.c       ****     }
 601:../tp.c       ****     
 602:../tp.c       ****     // CONVERSIÓN con fixed-point 16.16
 603:../tp.c       ****     temp_x = (long long)g_kx_fp * (xr - g_ts_xc);
 4664              		.loc 1 603 0
 4665 1aec 6C219FE5 		ldr	r2, .L106+16
 4666 1af0 002092E5 		ldr	r2, [r2, #0]
 4667 1af4 0290A0E1 		mov	r9, r2
 4668 1af8 C9AFA0E1 		mov	sl, r9, asr #31
 4669 1afc 60219FE5 		ldr	r2, .L106+20
 4670 1b00 002092E5 		ldr	r2, [r2, #0]
 4671 1b04 30101BE5 		ldr	r1, [fp, #-48]
 4672 1b08 012062E0 		rsb	r2, r2, r1
 4673 1b0c 0270A0E1 		mov	r7, r2
 4674 1b10 C78FA0E1 		mov	r8, r7, asr #31
 4675 1b14 970A00E0 		mul	r0, r7, sl
 4676 1b18 990802E0 		mul	r2, r9, r8
 4677 1b1c 020080E0 		add	r0, r0, r2
 4678 1b20 991782E0 		umull	r1, r2, r9, r7
 4679 1b24 020080E0 		add	r0, r0, r2
 4680 1b28 0020A0E1 		mov	r2, r0
 4681 1b2c 44100BE5 		str	r1, [fp, #-68]
 4682 1b30 40200BE5 		str	r2, [fp, #-64]
 4683 1b34 44100BE5 		str	r1, [fp, #-68]
 4684 1b38 40200BE5 		str	r2, [fp, #-64]
 604:../tp.c       ****     *x = (int)(temp_x >> 16) + g_lcd_xc;
 4685              		.loc 1 604 0
 4686 1b3c 40201BE5 		ldr	r2, [fp, #-64]
 4687 1b40 0228A0E1 		mov	r2, r2, asl #16
 4688 1b44 44101BE5 		ldr	r1, [fp, #-68]
 4689 1b48 2158A0E1 		mov	r5, r1, lsr #16
 4690 1b4c 055082E1 		orr	r5, r2, r5
 4691 1b50 40201BE5 		ldr	r2, [fp, #-64]
 4692 1b54 4268A0E1 		mov	r6, r2, asr #16
 4693 1b58 0510A0E1 		mov	r1, r5
 4694 1b5c 04219FE5 		ldr	r2, .L106+24
 4695 1b60 002092E5 		ldr	r2, [r2, #0]
 4696 1b64 021081E0 		add	r1, r1, r2
 4697 1b68 50201BE5 		ldr	r2, [fp, #-80]
 4698 1b6c 001082E5 		str	r1, [r2, #0]
 605:../tp.c       ****     
 606:../tp.c       ****     temp_y = (long long)g_ky_fp * (yr - g_ts_yc);
 4699              		.loc 1 606 0
 4700 1b70 F4209FE5 		ldr	r2, .L106+28
 4701 1b74 002092E5 		ldr	r2, [r2, #0]
 4702 1b78 0270A0E1 		mov	r7, r2
 4703 1b7c C78FA0E1 		mov	r8, r7, asr #31
 4704 1b80 E8209FE5 		ldr	r2, .L106+32
 4705 1b84 002092E5 		ldr	r2, [r2, #0]
 4706 1b88 34101BE5 		ldr	r1, [fp, #-52]
 4707 1b8c 012062E0 		rsb	r2, r2, r1
 4708 1b90 0250A0E1 		mov	r5, r2
 4709 1b94 C56FA0E1 		mov	r6, r5, asr #31
 4710 1b98 950800E0 		mul	r0, r5, r8
 4711 1b9c 970602E0 		mul	r2, r7, r6
 4712 1ba0 020080E0 		add	r0, r0, r2
 4713 1ba4 971582E0 		umull	r1, r2, r7, r5
 4714 1ba8 020080E0 		add	r0, r0, r2
 4715 1bac 0020A0E1 		mov	r2, r0
 4716 1bb0 4C100BE5 		str	r1, [fp, #-76]
 4717 1bb4 48200BE5 		str	r2, [fp, #-72]
 4718 1bb8 4C100BE5 		str	r1, [fp, #-76]
 4719 1bbc 48200BE5 		str	r2, [fp, #-72]
 607:../tp.c       ****     *y = (int)(temp_y >> 16) + g_lcd_yc;
 4720              		.loc 1 607 0
 4721 1bc0 48201BE5 		ldr	r2, [fp, #-72]
 4722 1bc4 0228A0E1 		mov	r2, r2, asl #16
 4723 1bc8 4C101BE5 		ldr	r1, [fp, #-76]
 4724 1bcc 2138A0E1 		mov	r3, r1, lsr #16
 4725 1bd0 033082E1 		orr	r3, r2, r3
 4726 1bd4 48201BE5 		ldr	r2, [fp, #-72]
 4727 1bd8 4248A0E1 		mov	r4, r2, asr #16
 4728 1bdc 0320A0E1 		mov	r2, r3
 4729 1be0 8C309FE5 		ldr	r3, .L106+36
 4730 1be4 003093E5 		ldr	r3, [r3, #0]
 4731 1be8 032082E0 		add	r2, r2, r3
 4732 1bec 54301BE5 		ldr	r3, [fp, #-84]
 4733 1bf0 002083E5 		str	r2, [r3, #0]
 608:../tp.c       ****     
 609:../tp.c       ****     // Clampear
 610:../tp.c       ****     *x = clamp(*x, 0, SCR_XSIZE - 1);
 4734              		.loc 1 610 0
 4735 1bf4 50301BE5 		ldr	r3, [fp, #-80]
 4736 1bf8 003093E5 		ldr	r3, [r3, #0]
 4737 1bfc 0300A0E1 		mov	r0, r3
 4738 1c00 0010A0E3 		mov	r1, #0
 4739 1c04 6C209FE5 		ldr	r2, .L106+40
 4740 1c08 2DFCFFEB 		bl	clamp
 4741 1c0c 0020A0E1 		mov	r2, r0
 4742 1c10 50301BE5 		ldr	r3, [fp, #-80]
 4743 1c14 002083E5 		str	r2, [r3, #0]
 611:../tp.c       ****     *y = clamp(*y, 0, SCR_YSIZE - 1);
 4744              		.loc 1 611 0
 4745 1c18 54301BE5 		ldr	r3, [fp, #-84]
 4746 1c1c 003093E5 		ldr	r3, [r3, #0]
 4747 1c20 0300A0E1 		mov	r0, r3
 4748 1c24 0010A0E3 		mov	r1, #0
 4749 1c28 EF20A0E3 		mov	r2, #239
 4750 1c2c 24FCFFEB 		bl	clamp
 4751 1c30 0020A0E1 		mov	r2, r0
 4752 1c34 54301BE5 		ldr	r3, [fp, #-84]
 4753 1c38 002083E5 		str	r2, [r3, #0]
 612:../tp.c       ****     
 613:../tp.c       ****     return 0;
 4754              		.loc 1 613 0
 4755 1c3c 0030A0E3 		mov	r3, #0
 4756              	.L104:
 614:../tp.c       **** }
 4757              		.loc 1 614 0
 4758 1c40 0300A0E1 		mov	r0, r3
 4759 1c44 28D04BE2 		sub	sp, fp, #40
 4760 1c48 F06F9DE8 		ldmfd	sp, {r4, r5, r6, r7, r8, r9, sl, fp, sp, lr}
 4761 1c4c 1EFF2FE1 		bx	lr
 4762              	.L107:
 4763              		.align	2
 4764              	.L106:
 4765 1c50 1C000000 		.word	g_ts_ready
 4766 1c54 20000000 		.word	g_ts_raw_x
 4767 1c58 24000000 		.word	g_ts_raw_y
 4768 1c5c 00000000 		.word	g_swap_xy
 4769 1c60 04000000 		.word	g_kx_fp
 4770 1c64 0C000000 		.word	g_ts_xc
 4771 1c68 14000000 		.word	g_lcd_xc
 4772 1c6c 08000000 		.word	g_ky_fp
 4773 1c70 10000000 		.word	g_ts_yc
 4774 1c74 18000000 		.word	g_lcd_yc
 4775 1c78 3F010000 		.word	319
 4776              		.cfi_endproc
 4777              	.LFE14:
 4779              		.section	.rodata
 4780 00a2 0000     		.align	2
 4781              	.LC22:
 4782 00a4 44696275 		.ascii	"Dibuja!\000"
 4782      6A612100 
 4783              		.text
 4784              		.align	2
 4785              		.global	ts_test_calibracion
 4787              	ts_test_calibracion:
 4788              	.LFB15:
 615:../tp.c       **** 
 616:../tp.c       **** /*********************************************************************************************
 617:../tp.c       **** * name:     ts_test_calibracion
 618:../tp.c       **** * func:     Función de test completa: calibra y permite dibujar
 619:../tp.c       **** *********************************************************************************************/
 620:../tp.c       **** void ts_test_calibracion(void)
 621:../tp.c       **** {
 4789              		.loc 1 621 0
 4790              		.cfi_startproc
 4791              		@ Function supports interworking.
 4792              		@ args = 0, pretend = 0, frame = 8
 4793              		@ frame_needed = 1, uses_anonymous_args = 0
 4794 1c7c 0DC0A0E1 		mov	ip, sp
 4795              	.LCFI30:
 4796              		.cfi_def_cfa_register 12
 4797 1c80 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4798 1c84 04B04CE2 		sub	fp, ip, #4
 4799              		.cfi_offset 14, -8
 4800              		.cfi_offset 13, -12
 4801              		.cfi_offset 11, -16
 4802              	.LCFI31:
 4803              		.cfi_def_cfa 11, 4
 4804 1c88 08D04DE2 		sub	sp, sp, #8
 622:../tp.c       ****     int x, y;
 623:../tp.c       ****     
 624:../tp.c       ****     Lcd_Init();
 4805              		.loc 1 624 0
 4806 1c8c FEFFFFEB 		bl	Lcd_Init
 625:../tp.c       ****     TS_init();
 4807              		.loc 1 625 0
 4808 1c90 FEFFFFEB 		bl	TS_init
 626:../tp.c       ****     
 627:../tp.c       ****     // Calibrar con margen de 50 píxeles
 628:../tp.c       ****     ts_calibrate_5pt(SCR_XSIZE, SCR_YSIZE, 50);
 4809              		.loc 1 628 0
 4810 1c94 050DA0E3 		mov	r0, #320
 4811 1c98 F010A0E3 		mov	r1, #240
 4812 1c9c 3220A0E3 		mov	r2, #50
 4813 1ca0 FEFFFFEB 		bl	ts_calibrate_5pt
 629:../tp.c       ****     
 630:../tp.c       ****     Lcd_Clr();
 4814              		.loc 1 630 0
 4815 1ca4 FEFFFFEB 		bl	Lcd_Clr
 631:../tp.c       ****     Lcd_Active_Clr();
 4816              		.loc 1 631 0
 4817 1ca8 FEFFFFEB 		bl	Lcd_Active_Clr
 632:../tp.c       ****     Lcd_DspAscII8x16(80, 110, BLACK, (unsigned char *)"Dibuja!");
 4818              		.loc 1 632 0
 4819 1cac 5000A0E3 		mov	r0, #80
 4820 1cb0 6E10A0E3 		mov	r1, #110
 4821 1cb4 0F20A0E3 		mov	r2, #15
 4822 1cb8 68319FE5 		ldr	r3, .L113
 4823 1cbc FEFFFFEB 		bl	Lcd_DspAscII8x16
 633:../tp.c       ****     Lcd_Dma_Trans();
 4824              		.loc 1 633 0
 4825 1cc0 FEFFFFEB 		bl	Lcd_Dma_Trans
 634:../tp.c       ****     Delay(100);
 4826              		.loc 1 634 0
 4827 1cc4 6400A0E3 		mov	r0, #100
 4828 1cc8 FEFFFFEB 		bl	Delay
 635:../tp.c       ****     
 636:../tp.c       ****     Lcd_Clr();
 4829              		.loc 1 636 0
 4830 1ccc FEFFFFEB 		bl	Lcd_Clr
 637:../tp.c       ****     Lcd_Dma_Trans();
 4831              		.loc 1 637 0
 4832 1cd0 FEFFFFEB 		bl	Lcd_Dma_Trans
 4833 1cd4 020000EA 		b	.L110
 4834              	.L111:
 638:../tp.c       ****     
 639:../tp.c       ****     // Loop de dibujo
 640:../tp.c       ****     while (1)
 641:../tp.c       ****     {
 642:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 643:../tp.c       ****         {
 644:../tp.c       ****             (LCD_PutPixel(x, y, 0xf));
 645:../tp.c       ****             
 646:../tp.c       ****             static int count = 0;
 647:../tp.c       ****             if (++count >= 5)
 648:../tp.c       ****             {
 649:../tp.c       ****                 Lcd_Dma_Trans();
 650:../tp.c       ****                 count = 0;
 651:../tp.c       ****             }
 652:../tp.c       ****         }
 653:../tp.c       ****     }
 4835              		.loc 1 653 0
 4836 1cd8 0000A0E1 		mov	r0, r0	@ nop
 4837 1cdc 000000EA 		b	.L110
 4838              	.L112:
 4839 1ce0 0000A0E1 		mov	r0, r0	@ nop
 4840              	.L110:
 642:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 4841              		.loc 1 642 0
 4842 1ce4 10204BE2 		sub	r2, fp, #16
 4843 1ce8 14304BE2 		sub	r3, fp, #20
 4844 1cec 0200A0E1 		mov	r0, r2
 4845 1cf0 0310A0E1 		mov	r1, r3
 4846 1cf4 FEFFFFEB 		bl	ts_read_calibrated
 4847 1cf8 0030A0E1 		mov	r3, r0
 4848 1cfc 000053E3 		cmp	r3, #0
 4849 1d00 F4FFFF1A 		bne	.L111
 4850              	.LBB4:
 644:../tp.c       ****             (LCD_PutPixel(x, y, 0xf));
 4851              		.loc 1 644 0
 4852 1d04 14201BE5 		ldr	r2, [fp, #-20]
 4853 1d08 0230A0E1 		mov	r3, r2
 4854 1d0c 0331A0E1 		mov	r3, r3, asl #2
 4855 1d10 023083E0 		add	r3, r3, r2
 4856 1d14 0333A0E1 		mov	r3, r3, asl #6
 4857 1d18 A32FA0E1 		mov	r2, r3, lsr #31
 4858 1d1c 033082E0 		add	r3, r2, r3
 4859 1d20 C330A0E1 		mov	r3, r3, asr #1
 4860 1d24 C32683E2 		add	r2, r3, #204472320
 4861 1d28 962C82E2 		add	r2, r2, #38400
 4862 1d2c 10301BE5 		ldr	r3, [fp, #-16]
 4863 1d30 071083E2 		add	r1, r3, #7
 4864 1d34 000053E3 		cmp	r3, #0
 4865 1d38 0130A0B1 		movlt	r3, r1
 4866 1d3c C331A0E1 		mov	r3, r3, asr #3
 4867 1d40 0331A0E1 		mov	r3, r3, asl #2
 4868 1d44 033082E0 		add	r3, r2, r3
 4869 1d48 0310A0E1 		mov	r1, r3
 4870 1d4c 14201BE5 		ldr	r2, [fp, #-20]
 4871 1d50 0230A0E1 		mov	r3, r2
 4872 1d54 0331A0E1 		mov	r3, r3, asl #2
 4873 1d58 023083E0 		add	r3, r3, r2
 4874 1d5c 0333A0E1 		mov	r3, r3, asl #6
 4875 1d60 A32FA0E1 		mov	r2, r3, lsr #31
 4876 1d64 033082E0 		add	r3, r2, r3
 4877 1d68 C330A0E1 		mov	r3, r3, asr #1
 4878 1d6c C32683E2 		add	r2, r3, #204472320
 4879 1d70 962C82E2 		add	r2, r2, #38400
 4880 1d74 10301BE5 		ldr	r3, [fp, #-16]
 4881 1d78 070083E2 		add	r0, r3, #7
 4882 1d7c 000053E3 		cmp	r3, #0
 4883 1d80 0030A0B1 		movlt	r3, r0
 4884 1d84 C331A0E1 		mov	r3, r3, asr #3
 4885 1d88 0331A0E1 		mov	r3, r3, asl #2
 4886 1d8c 033082E0 		add	r3, r2, r3
 4887 1d90 000093E5 		ldr	r0, [r3, #0]
 4888 1d94 10201BE5 		ldr	r2, [fp, #-16]
 4889 1d98 C23FA0E1 		mov	r3, r2, asr #31
 4890 1d9c A33EA0E1 		mov	r3, r3, lsr #29
 4891 1da0 032082E0 		add	r2, r2, r3
 4892 1da4 072002E2 		and	r2, r2, #7
 4893 1da8 023063E0 		rsb	r3, r3, r2
 4894 1dac 0331A0E1 		mov	r3, r3, asl #2
 4895 1db0 0F22A0E3 		mov	r2, #-268435456
 4896 1db4 3233A0E1 		mov	r3, r2, lsr r3
 4897 1db8 0330E0E1 		mvn	r3, r3
 4898 1dbc 030000E0 		and	r0, r0, r3
 4899 1dc0 10201BE5 		ldr	r2, [fp, #-16]
 4900 1dc4 C23FA0E1 		mov	r3, r2, asr #31
 4901 1dc8 A33EA0E1 		mov	r3, r3, lsr #29
 4902 1dcc 032082E0 		add	r2, r2, r3
 4903 1dd0 072002E2 		and	r2, r2, #7
 4904 1dd4 023063E0 		rsb	r3, r3, r2
 4905 1dd8 073063E2 		rsb	r3, r3, #7
 4906 1ddc 0331A0E1 		mov	r3, r3, asl #2
 4907 1de0 0F20A0E3 		mov	r2, #15
 4908 1de4 1233A0E1 		mov	r3, r2, asl r3
 4909 1de8 033080E1 		orr	r3, r0, r3
 4910 1dec 003081E5 		str	r3, [r1, #0]
 647:../tp.c       ****             if (++count >= 5)
 4911              		.loc 1 647 0
 4912 1df0 34309FE5 		ldr	r3, .L113+4
 4913 1df4 003093E5 		ldr	r3, [r3, #0]
 4914 1df8 012083E2 		add	r2, r3, #1
 4915 1dfc 28309FE5 		ldr	r3, .L113+4
 4916 1e00 002083E5 		str	r2, [r3, #0]
 4917 1e04 20309FE5 		ldr	r3, .L113+4
 4918 1e08 003093E5 		ldr	r3, [r3, #0]
 4919 1e0c 040053E3 		cmp	r3, #4
 4920 1e10 B2FFFFDA 		ble	.L112
 649:../tp.c       ****                 Lcd_Dma_Trans();
 4921              		.loc 1 649 0
 4922 1e14 FEFFFFEB 		bl	Lcd_Dma_Trans
 650:../tp.c       ****                 count = 0;
 4923              		.loc 1 650 0
 4924 1e18 0C309FE5 		ldr	r3, .L113+4
 4925 1e1c 0020A0E3 		mov	r2, #0
 4926 1e20 002083E5 		str	r2, [r3, #0]
 4927              	.LBE4:
 4928              		.loc 1 653 0
 4929 1e24 AEFFFFEA 		b	.L110
 4930              	.L114:
 4931              		.align	2
 4932              	.L113:
 4933 1e28 A4000000 		.word	.LC22
 4934 1e2c 2C000000 		.word	count.4306
 4935              		.cfi_endproc
 4936              	.LFE15:
 4938              		.section	.rodata
 4939              		.align	2
 4940              	.LC23:
 4941 00ac 546F6361 		.ascii	"Toca un numero\000"
 4941      20756E20 
 4941      6E756D65 
 4941      726F00
 4942 00bb 00       		.align	2
 4943              	.LC24:
 4944 00bc 546F7175 		.ascii	"Toque detectado:\000"
 4944      65206465 
 4944      74656374 
 4944      61646F3A 
 4944      00
 4945 00cd 000000   		.align	2
 4946              	.LC25:
 4947 00d0 436F6F72 		.ascii	"Coordenadas guardadas\000"
 4947      64656E61 
 4947      64617320 
 4947      67756172 
 4947      64616461 
 4948 00e6 0000     		.align	2
 4949              	.LC26:
 4950 00e8 4E554D45 		.ascii	"NUMERO 1\000"
 4950      524F2031 
 4950      00
 4951 00f1 000000   		.align	2
 4952              	.LC27:
 4953 00f4 4E554D45 		.ascii	"NUMERO 2\000"
 4953      524F2032 
 4953      00
 4954 00fd 000000   		.align	2
 4955              	.LC28:
 4956 0100 46756572 		.ascii	"Fuera de zona\000"
 4956      61206465 
 4956      207A6F6E 
 4956      6100
 4957 010e 0000     		.text
 4958              		.align	2
 4959              		.global	ts_test_numeros
 4961              	ts_test_numeros:
 4962              	.LFB16:
 654:../tp.c       **** }
 655:../tp.c       **** 
 656:../tp.c       **** /*********************************************************************************************
 657:../tp.c       **** * name:     ts_test_numeros
 658:../tp.c       **** * func:     Test con dos números: muestra coordenadas al tocar
 659:../tp.c       **** *********************************************************************************************/
 660:../tp.c       **** void ts_test_numeros(void)
 661:../tp.c       **** {
 4963              		.loc 1 661 0
 4964              		.cfi_startproc
 4965              		@ Function supports interworking.
 4966              		@ args = 0, pretend = 0, frame = 40
 4967              		@ frame_needed = 1, uses_anonymous_args = 0
 4968 1e30 0DC0A0E1 		mov	ip, sp
 4969              	.LCFI32:
 4970              		.cfi_def_cfa_register 12
 4971 1e34 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4972 1e38 04B04CE2 		sub	fp, ip, #4
 4973              		.cfi_offset 14, -8
 4974              		.cfi_offset 13, -12
 4975              		.cfi_offset 11, -16
 4976              	.LCFI33:
 4977              		.cfi_def_cfa 11, 4
 4978 1e3c 28D04DE2 		sub	sp, sp, #40
 662:../tp.c       ****     int x, y;
 663:../tp.c       ****     int num1_x = 60, num1_y = 100;   // Posición número 1 (izquierda)
 4979              		.loc 1 663 0
 4980 1e40 3C30A0E3 		mov	r3, #60
 4981 1e44 20300BE5 		str	r3, [fp, #-32]
 4982 1e48 6430A0E3 		mov	r3, #100
 4983 1e4c 24300BE5 		str	r3, [fp, #-36]
 664:../tp.c       ****     int num2_x = 220, num2_y = 100;  // Posición número 2 (derecha)
 4984              		.loc 1 664 0
 4985 1e50 DC30A0E3 		mov	r3, #220
 4986 1e54 28300BE5 		str	r3, [fp, #-40]
 4987 1e58 6430A0E3 		mov	r3, #100
 4988 1e5c 2C300BE5 		str	r3, [fp, #-44]
 665:../tp.c       ****     
 666:../tp.c       ****     Lcd_Init();
 4989              		.loc 1 666 0
 4990 1e60 FEFFFFEB 		bl	Lcd_Init
 667:../tp.c       ****     TS_init();
 4991              		.loc 1 667 0
 4992 1e64 FEFFFFEB 		bl	TS_init
 668:../tp.c       ****     
 669:../tp.c       ****     // Calibrar con margen de 30 píxeles (más cerca de los bordes)
 670:../tp.c       ****     ts_calibrate_5pt(SCR_XSIZE, SCR_YSIZE, 30);
 4993              		.loc 1 670 0
 4994 1e68 050DA0E3 		mov	r0, #320
 4995 1e6c F010A0E3 		mov	r1, #240
 4996 1e70 1E20A0E3 		mov	r2, #30
 4997 1e74 FEFFFFEB 		bl	ts_calibrate_5pt
 671:../tp.c       ****     
 672:../tp.c       ****     // Mostrar los dos números
 673:../tp.c       ****     Lcd_Clr();
 4998              		.loc 1 673 0
 4999 1e78 FEFFFFEB 		bl	Lcd_Clr
 674:../tp.c       ****     Lcd_DspAscII8x16(num1_x, num1_y, BLACK, (unsigned char *)"1");
 5000              		.loc 1 674 0
 5001 1e7c 20301BE5 		ldr	r3, [fp, #-32]
 5002 1e80 0338A0E1 		mov	r3, r3, asl #16
 5003 1e84 2328A0E1 		mov	r2, r3, lsr #16
 5004 1e88 24301BE5 		ldr	r3, [fp, #-36]
 5005 1e8c 0338A0E1 		mov	r3, r3, asl #16
 5006 1e90 2338A0E1 		mov	r3, r3, lsr #16
 5007 1e94 0200A0E1 		mov	r0, r2
 5008 1e98 0310A0E1 		mov	r1, r3
 5009 1e9c 0F20A0E3 		mov	r2, #15
 5010 1ea0 14349FE5 		ldr	r3, .L131
 5011 1ea4 FEFFFFEB 		bl	Lcd_DspAscII8x16
 675:../tp.c       ****     Lcd_DspAscII8x16(num2_x, num2_y, BLACK, (unsigned char *)"2");
 5012              		.loc 1 675 0
 5013 1ea8 28301BE5 		ldr	r3, [fp, #-40]
 5014 1eac 0338A0E1 		mov	r3, r3, asl #16
 5015 1eb0 2328A0E1 		mov	r2, r3, lsr #16
 5016 1eb4 2C301BE5 		ldr	r3, [fp, #-44]
 5017 1eb8 0338A0E1 		mov	r3, r3, asl #16
 5018 1ebc 2338A0E1 		mov	r3, r3, lsr #16
 5019 1ec0 0200A0E1 		mov	r0, r2
 5020 1ec4 0310A0E1 		mov	r1, r3
 5021 1ec8 0F20A0E3 		mov	r2, #15
 5022 1ecc EC339FE5 		ldr	r3, .L131+4
 5023 1ed0 FEFFFFEB 		bl	Lcd_DspAscII8x16
 676:../tp.c       ****     Lcd_DspAscII6x8(60, 20, BLACK, (unsigned char *)"Toca un numero");
 5024              		.loc 1 676 0
 5025 1ed4 3C00A0E3 		mov	r0, #60
 5026 1ed8 1410A0E3 		mov	r1, #20
 5027 1edc 0F20A0E3 		mov	r2, #15
 5028 1ee0 DC339FE5 		ldr	r3, .L131+8
 5029 1ee4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 677:../tp.c       ****     Lcd_Dma_Trans();
 5030              		.loc 1 677 0
 5031 1ee8 FEFFFFEB 		bl	Lcd_Dma_Trans
 5032 1eec 000000EA 		b	.L129
 5033              	.L130:
 678:../tp.c       ****     
 679:../tp.c       ****     // Loop de detección de toques
 680:../tp.c       ****     while (1)
 681:../tp.c       ****     {
 682:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 683:../tp.c       ****         {
 684:../tp.c       ****             // Limpiar zona de información
 685:../tp.c       ****             int i, j;
 686:../tp.c       ****             for (i = 0; i < 320; i++)
 687:../tp.c       ****                 for (j = 150; j < 200; j++)
 688:../tp.c       ****                     (LCD_PutPixel(i, j, 0x0));
 689:../tp.c       ****             
 690:../tp.c       ****             // Mostrar coordenadas
 691:../tp.c       ****             Lcd_DspAscII6x8(10, 160, BLACK, (unsigned char *)"Toque detectado:");
 692:../tp.c       ****             
 693:../tp.c       ****             // Mostrar X (solo texto fijo, sin sprintf)
 694:../tp.c       ****             Lcd_DspAscII6x8(10, 175, BLACK, (unsigned char *)"Coordenadas guardadas");
 695:../tp.c       ****             
 696:../tp.c       ****             // Dibujar punto donde se tocó
 697:../tp.c       ****             int px, py;
 698:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 699:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 700:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 701:../tp.c       ****                         (LCD_PutPixel(px, py, 0xf));
 702:../tp.c       ****             
 703:../tp.c       ****             // Detectar qué número se tocó (área más amplia para test)
 704:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 705:../tp.c       ****             {
 706:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 1");
 707:../tp.c       ****             }
 708:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 709:../tp.c       ****             {
 710:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 2");
 711:../tp.c       ****             }
 712:../tp.c       ****             else
 713:../tp.c       ****             {
 714:../tp.c       ****                 Lcd_DspAscII6x8(70, 195, BLACK, (unsigned char *)"Fuera de zona");
 715:../tp.c       ****             }
 716:../tp.c       ****             
 717:../tp.c       ****             Lcd_Dma_Trans();
 718:../tp.c       ****             Delay(50);
 719:../tp.c       ****         }
 720:../tp.c       ****     }
 5034              		.loc 1 720 0
 5035 1ef0 0000A0E1 		mov	r0, r0	@ nop
 5036              	.L129:
 682:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 5037              		.loc 1 682 0
 5038 1ef4 30204BE2 		sub	r2, fp, #48
 5039 1ef8 34304BE2 		sub	r3, fp, #52
 5040 1efc 0200A0E1 		mov	r0, r2
 5041 1f00 0310A0E1 		mov	r1, r3
 5042 1f04 FEFFFFEB 		bl	ts_read_calibrated
 5043 1f08 0030A0E1 		mov	r3, r0
 5044 1f0c 000053E3 		cmp	r3, #0
 5045 1f10 F6FFFF1A 		bne	.L130
 5046              	.LBB5:
 686:../tp.c       ****             for (i = 0; i < 320; i++)
 5047              		.loc 1 686 0
 5048 1f14 0030A0E3 		mov	r3, #0
 5049 1f18 10300BE5 		str	r3, [fp, #-16]
 5050 1f1c 3B0000EA 		b	.L117
 5051              	.L120:
 687:../tp.c       ****                 for (j = 150; j < 200; j++)
 5052              		.loc 1 687 0
 5053 1f20 9630A0E3 		mov	r3, #150
 5054 1f24 14300BE5 		str	r3, [fp, #-20]
 5055 1f28 320000EA 		b	.L118
 5056              	.L119:
 688:../tp.c       ****                     (LCD_PutPixel(i, j, 0x0));
 5057              		.loc 1 688 0 discriminator 2
 5058 1f2c 14201BE5 		ldr	r2, [fp, #-20]
 5059 1f30 0230A0E1 		mov	r3, r2
 5060 1f34 0331A0E1 		mov	r3, r3, asl #2
 5061 1f38 023083E0 		add	r3, r3, r2
 5062 1f3c 0333A0E1 		mov	r3, r3, asl #6
 5063 1f40 A32FA0E1 		mov	r2, r3, lsr #31
 5064 1f44 033082E0 		add	r3, r2, r3
 5065 1f48 C330A0E1 		mov	r3, r3, asr #1
 5066 1f4c C32683E2 		add	r2, r3, #204472320
 5067 1f50 962C82E2 		add	r2, r2, #38400
 5068 1f54 10301BE5 		ldr	r3, [fp, #-16]
 5069 1f58 071083E2 		add	r1, r3, #7
 5070 1f5c 000053E3 		cmp	r3, #0
 5071 1f60 0130A0B1 		movlt	r3, r1
 5072 1f64 C331A0E1 		mov	r3, r3, asr #3
 5073 1f68 0331A0E1 		mov	r3, r3, asl #2
 5074 1f6c 033082E0 		add	r3, r2, r3
 5075 1f70 0310A0E1 		mov	r1, r3
 5076 1f74 14201BE5 		ldr	r2, [fp, #-20]
 5077 1f78 0230A0E1 		mov	r3, r2
 5078 1f7c 0331A0E1 		mov	r3, r3, asl #2
 5079 1f80 023083E0 		add	r3, r3, r2
 5080 1f84 0333A0E1 		mov	r3, r3, asl #6
 5081 1f88 A32FA0E1 		mov	r2, r3, lsr #31
 5082 1f8c 033082E0 		add	r3, r2, r3
 5083 1f90 C330A0E1 		mov	r3, r3, asr #1
 5084 1f94 C32683E2 		add	r2, r3, #204472320
 5085 1f98 962C82E2 		add	r2, r2, #38400
 5086 1f9c 10301BE5 		ldr	r3, [fp, #-16]
 5087 1fa0 070083E2 		add	r0, r3, #7
 5088 1fa4 000053E3 		cmp	r3, #0
 5089 1fa8 0030A0B1 		movlt	r3, r0
 5090 1fac C331A0E1 		mov	r3, r3, asr #3
 5091 1fb0 0331A0E1 		mov	r3, r3, asl #2
 5092 1fb4 033082E0 		add	r3, r2, r3
 5093 1fb8 000093E5 		ldr	r0, [r3, #0]
 5094 1fbc 10201BE5 		ldr	r2, [fp, #-16]
 5095 1fc0 C23FA0E1 		mov	r3, r2, asr #31
 5096 1fc4 A33EA0E1 		mov	r3, r3, lsr #29
 5097 1fc8 032082E0 		add	r2, r2, r3
 5098 1fcc 072002E2 		and	r2, r2, #7
 5099 1fd0 023063E0 		rsb	r3, r3, r2
 5100 1fd4 0331A0E1 		mov	r3, r3, asl #2
 5101 1fd8 0F22A0E3 		mov	r2, #-268435456
 5102 1fdc 3233A0E1 		mov	r3, r2, lsr r3
 5103 1fe0 0330E0E1 		mvn	r3, r3
 5104 1fe4 033000E0 		and	r3, r0, r3
 5105 1fe8 003081E5 		str	r3, [r1, #0]
 687:../tp.c       ****                 for (j = 150; j < 200; j++)
 5106              		.loc 1 687 0 discriminator 2
 5107 1fec 14301BE5 		ldr	r3, [fp, #-20]
 5108 1ff0 013083E2 		add	r3, r3, #1
 5109 1ff4 14300BE5 		str	r3, [fp, #-20]
 5110              	.L118:
 687:../tp.c       ****                 for (j = 150; j < 200; j++)
 5111              		.loc 1 687 0 is_stmt 0 discriminator 1
 5112 1ff8 14301BE5 		ldr	r3, [fp, #-20]
 5113 1ffc C70053E3 		cmp	r3, #199
 5114 2000 C9FFFFDA 		ble	.L119
 686:../tp.c       ****             for (i = 0; i < 320; i++)
 5115              		.loc 1 686 0 is_stmt 1
 5116 2004 10301BE5 		ldr	r3, [fp, #-16]
 5117 2008 013083E2 		add	r3, r3, #1
 5118 200c 10300BE5 		str	r3, [fp, #-16]
 5119              	.L117:
 686:../tp.c       ****             for (i = 0; i < 320; i++)
 5120              		.loc 1 686 0 is_stmt 0 discriminator 1
 5121 2010 10201BE5 		ldr	r2, [fp, #-16]
 5122 2014 AC329FE5 		ldr	r3, .L131+12
 5123 2018 030052E1 		cmp	r2, r3
 5124 201c BFFFFFDA 		ble	.L120
 691:../tp.c       ****             Lcd_DspAscII6x8(10, 160, BLACK, (unsigned char *)"Toque detectado:");
 5125              		.loc 1 691 0 is_stmt 1
 5126 2020 0A00A0E3 		mov	r0, #10
 5127 2024 A010A0E3 		mov	r1, #160
 5128 2028 0F20A0E3 		mov	r2, #15
 5129 202c 98329FE5 		ldr	r3, .L131+16
 5130 2030 FEFFFFEB 		bl	Lcd_DspAscII6x8
 694:../tp.c       ****             Lcd_DspAscII6x8(10, 175, BLACK, (unsigned char *)"Coordenadas guardadas");
 5131              		.loc 1 694 0
 5132 2034 0A00A0E3 		mov	r0, #10
 5133 2038 AF10A0E3 		mov	r1, #175
 5134 203c 0F20A0E3 		mov	r2, #15
 5135 2040 88329FE5 		ldr	r3, .L131+20
 5136 2044 FEFFFFEB 		bl	Lcd_DspAscII6x8
 698:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5137              		.loc 1 698 0
 5138 2048 30301BE5 		ldr	r3, [fp, #-48]
 5139 204c 033043E2 		sub	r3, r3, #3
 5140 2050 18300BE5 		str	r3, [fp, #-24]
 5141 2054 560000EA 		b	.L121
 5142              	.L125:
 699:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5143              		.loc 1 699 0
 5144 2058 34301BE5 		ldr	r3, [fp, #-52]
 5145 205c 033043E2 		sub	r3, r3, #3
 5146 2060 1C300BE5 		str	r3, [fp, #-28]
 5147 2064 4A0000EA 		b	.L122
 5148              	.L124:
 700:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 5149              		.loc 1 700 0
 5150 2068 18301BE5 		ldr	r3, [fp, #-24]
 5151 206c 000053E3 		cmp	r3, #0
 5152 2070 440000BA 		blt	.L123
 700:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 5153              		.loc 1 700 0 is_stmt 0 discriminator 1
 5154 2074 18201BE5 		ldr	r2, [fp, #-24]
 5155 2078 48329FE5 		ldr	r3, .L131+12
 5156 207c 030052E1 		cmp	r2, r3
 5157 2080 400000CA 		bgt	.L123
 5158 2084 1C301BE5 		ldr	r3, [fp, #-28]
 5159 2088 000053E3 		cmp	r3, #0
 5160 208c 3D0000BA 		blt	.L123
 5161 2090 1C301BE5 		ldr	r3, [fp, #-28]
 5162 2094 EF0053E3 		cmp	r3, #239
 5163 2098 3A0000CA 		bgt	.L123
 701:../tp.c       ****                         (LCD_PutPixel(px, py, 0xf));
 5164              		.loc 1 701 0 is_stmt 1
 5165 209c 1C201BE5 		ldr	r2, [fp, #-28]
 5166 20a0 0230A0E1 		mov	r3, r2
 5167 20a4 0331A0E1 		mov	r3, r3, asl #2
 5168 20a8 023083E0 		add	r3, r3, r2
 5169 20ac 0333A0E1 		mov	r3, r3, asl #6
 5170 20b0 A32FA0E1 		mov	r2, r3, lsr #31
 5171 20b4 033082E0 		add	r3, r2, r3
 5172 20b8 C330A0E1 		mov	r3, r3, asr #1
 5173 20bc C32683E2 		add	r2, r3, #204472320
 5174 20c0 962C82E2 		add	r2, r2, #38400
 5175 20c4 18301BE5 		ldr	r3, [fp, #-24]
 5176 20c8 071083E2 		add	r1, r3, #7
 5177 20cc 000053E3 		cmp	r3, #0
 5178 20d0 0130A0B1 		movlt	r3, r1
 5179 20d4 C331A0E1 		mov	r3, r3, asr #3
 5180 20d8 0331A0E1 		mov	r3, r3, asl #2
 5181 20dc 033082E0 		add	r3, r2, r3
 5182 20e0 0310A0E1 		mov	r1, r3
 5183 20e4 1C201BE5 		ldr	r2, [fp, #-28]
 5184 20e8 0230A0E1 		mov	r3, r2
 5185 20ec 0331A0E1 		mov	r3, r3, asl #2
 5186 20f0 023083E0 		add	r3, r3, r2
 5187 20f4 0333A0E1 		mov	r3, r3, asl #6
 5188 20f8 A32FA0E1 		mov	r2, r3, lsr #31
 5189 20fc 033082E0 		add	r3, r2, r3
 5190 2100 C330A0E1 		mov	r3, r3, asr #1
 5191 2104 C32683E2 		add	r2, r3, #204472320
 5192 2108 962C82E2 		add	r2, r2, #38400
 5193 210c 18301BE5 		ldr	r3, [fp, #-24]
 5194 2110 070083E2 		add	r0, r3, #7
 5195 2114 000053E3 		cmp	r3, #0
 5196 2118 0030A0B1 		movlt	r3, r0
 5197 211c C331A0E1 		mov	r3, r3, asr #3
 5198 2120 0331A0E1 		mov	r3, r3, asl #2
 5199 2124 033082E0 		add	r3, r2, r3
 5200 2128 000093E5 		ldr	r0, [r3, #0]
 5201 212c 18201BE5 		ldr	r2, [fp, #-24]
 5202 2130 C23FA0E1 		mov	r3, r2, asr #31
 5203 2134 A33EA0E1 		mov	r3, r3, lsr #29
 5204 2138 032082E0 		add	r2, r2, r3
 5205 213c 072002E2 		and	r2, r2, #7
 5206 2140 023063E0 		rsb	r3, r3, r2
 5207 2144 0331A0E1 		mov	r3, r3, asl #2
 5208 2148 0F22A0E3 		mov	r2, #-268435456
 5209 214c 3233A0E1 		mov	r3, r2, lsr r3
 5210 2150 0330E0E1 		mvn	r3, r3
 5211 2154 030000E0 		and	r0, r0, r3
 5212 2158 18201BE5 		ldr	r2, [fp, #-24]
 5213 215c C23FA0E1 		mov	r3, r2, asr #31
 5214 2160 A33EA0E1 		mov	r3, r3, lsr #29
 5215 2164 032082E0 		add	r2, r2, r3
 5216 2168 072002E2 		and	r2, r2, #7
 5217 216c 023063E0 		rsb	r3, r3, r2
 5218 2170 073063E2 		rsb	r3, r3, #7
 5219 2174 0331A0E1 		mov	r3, r3, asl #2
 5220 2178 0F20A0E3 		mov	r2, #15
 5221 217c 1233A0E1 		mov	r3, r2, asl r3
 5222 2180 033080E1 		orr	r3, r0, r3
 5223 2184 003081E5 		str	r3, [r1, #0]
 5224              	.L123:
 699:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5225              		.loc 1 699 0
 5226 2188 1C301BE5 		ldr	r3, [fp, #-28]
 5227 218c 013083E2 		add	r3, r3, #1
 5228 2190 1C300BE5 		str	r3, [fp, #-28]
 5229              	.L122:
 699:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5230              		.loc 1 699 0 is_stmt 0 discriminator 1
 5231 2194 34301BE5 		ldr	r3, [fp, #-52]
 5232 2198 032083E2 		add	r2, r3, #3
 5233 219c 1C301BE5 		ldr	r3, [fp, #-28]
 5234 21a0 030052E1 		cmp	r2, r3
 5235 21a4 AFFFFFAA 		bge	.L124
 698:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5236              		.loc 1 698 0 is_stmt 1
 5237 21a8 18301BE5 		ldr	r3, [fp, #-24]
 5238 21ac 013083E2 		add	r3, r3, #1
 5239 21b0 18300BE5 		str	r3, [fp, #-24]
 5240              	.L121:
 698:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5241              		.loc 1 698 0 is_stmt 0 discriminator 1
 5242 21b4 30301BE5 		ldr	r3, [fp, #-48]
 5243 21b8 032083E2 		add	r2, r3, #3
 5244 21bc 18301BE5 		ldr	r3, [fp, #-24]
 5245 21c0 030052E1 		cmp	r2, r3
 5246 21c4 A3FFFFAA 		bge	.L125
 704:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 5247              		.loc 1 704 0 is_stmt 1
 5248 21c8 20301BE5 		ldr	r3, [fp, #-32]
 5249 21cc 1E2043E2 		sub	r2, r3, #30
 5250 21d0 30301BE5 		ldr	r3, [fp, #-48]
 5251 21d4 030052E1 		cmp	r2, r3
 5252 21d8 140000CA 		bgt	.L126
 704:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 5253              		.loc 1 704 0 is_stmt 0 discriminator 1
 5254 21dc 20301BE5 		ldr	r3, [fp, #-32]
 5255 21e0 1E2083E2 		add	r2, r3, #30
 5256 21e4 30301BE5 		ldr	r3, [fp, #-48]
 5257 21e8 030052E1 		cmp	r2, r3
 5258 21ec 0F0000BA 		blt	.L126
 5259 21f0 24301BE5 		ldr	r3, [fp, #-36]
 5260 21f4 1E2043E2 		sub	r2, r3, #30
 5261 21f8 34301BE5 		ldr	r3, [fp, #-52]
 5262 21fc 030052E1 		cmp	r2, r3
 5263 2200 0A0000CA 		bgt	.L126
 5264 2204 24301BE5 		ldr	r3, [fp, #-36]
 5265 2208 1E2083E2 		add	r2, r3, #30
 5266 220c 34301BE5 		ldr	r3, [fp, #-52]
 5267 2210 030052E1 		cmp	r2, r3
 5268 2214 050000BA 		blt	.L126
 706:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 1");
 5269              		.loc 1 706 0 is_stmt 1
 5270 2218 5000A0E3 		mov	r0, #80
 5271 221c BE10A0E3 		mov	r1, #190
 5272 2220 0F20A0E3 		mov	r2, #15
 5273 2224 A8309FE5 		ldr	r3, .L131+24
 5274 2228 FEFFFFEB 		bl	Lcd_DspAscII8x16
 5275 222c 1E0000EA 		b	.L127
 5276              	.L126:
 708:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 5277              		.loc 1 708 0
 5278 2230 28301BE5 		ldr	r3, [fp, #-40]
 5279 2234 1E2043E2 		sub	r2, r3, #30
 5280 2238 30301BE5 		ldr	r3, [fp, #-48]
 5281 223c 030052E1 		cmp	r2, r3
 5282 2240 140000CA 		bgt	.L128
 708:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 5283              		.loc 1 708 0 is_stmt 0 discriminator 1
 5284 2244 28301BE5 		ldr	r3, [fp, #-40]
 5285 2248 1E2083E2 		add	r2, r3, #30
 5286 224c 30301BE5 		ldr	r3, [fp, #-48]
 5287 2250 030052E1 		cmp	r2, r3
 5288 2254 0F0000BA 		blt	.L128
 5289 2258 2C301BE5 		ldr	r3, [fp, #-44]
 5290 225c 1E2043E2 		sub	r2, r3, #30
 5291 2260 34301BE5 		ldr	r3, [fp, #-52]
 5292 2264 030052E1 		cmp	r2, r3
 5293 2268 0A0000CA 		bgt	.L128
 5294 226c 2C301BE5 		ldr	r3, [fp, #-44]
 5295 2270 1E2083E2 		add	r2, r3, #30
 5296 2274 34301BE5 		ldr	r3, [fp, #-52]
 5297 2278 030052E1 		cmp	r2, r3
 5298 227c 050000BA 		blt	.L128
 710:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 2");
 5299              		.loc 1 710 0 is_stmt 1
 5300 2280 5000A0E3 		mov	r0, #80
 5301 2284 BE10A0E3 		mov	r1, #190
 5302 2288 0F20A0E3 		mov	r2, #15
 5303 228c 44309FE5 		ldr	r3, .L131+28
 5304 2290 FEFFFFEB 		bl	Lcd_DspAscII8x16
 5305 2294 040000EA 		b	.L127
 5306              	.L128:
 714:../tp.c       ****                 Lcd_DspAscII6x8(70, 195, BLACK, (unsigned char *)"Fuera de zona");
 5307              		.loc 1 714 0
 5308 2298 4600A0E3 		mov	r0, #70
 5309 229c C310A0E3 		mov	r1, #195
 5310 22a0 0F20A0E3 		mov	r2, #15
 5311 22a4 30309FE5 		ldr	r3, .L131+32
 5312 22a8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 5313              	.L127:
 717:../tp.c       ****             Lcd_Dma_Trans();
 5314              		.loc 1 717 0
 5315 22ac FEFFFFEB 		bl	Lcd_Dma_Trans
 718:../tp.c       ****             Delay(50);
 5316              		.loc 1 718 0
 5317 22b0 3200A0E3 		mov	r0, #50
 5318 22b4 FEFFFFEB 		bl	Delay
 5319              	.LBE5:
 5320              		.loc 1 720 0
 5321 22b8 0DFFFFEA 		b	.L129
 5322              	.L132:
 5323              		.align	2
 5324              	.L131:
 5325 22bc 04000000 		.word	.LC1
 5326 22c0 08000000 		.word	.LC2
 5327 22c4 AC000000 		.word	.LC23
 5328 22c8 3F010000 		.word	319
 5329 22cc BC000000 		.word	.LC24
 5330 22d0 D0000000 		.word	.LC25
 5331 22d4 E8000000 		.word	.LC26
 5332 22d8 F4000000 		.word	.LC27
 5333 22dc 00010000 		.word	.LC28
 5334              		.cfi_endproc
 5335              	.LFE16:
 5337              		.bss
 5338              		.align	2
 5339              	count.4306:
 5340 002c 00000000 		.space	4
 5341              		.text
 5342              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 tp.c
                            *COM*:00000004 CheckTSP
                            *COM*:00000004 oneTouch
                            *COM*:00000004 Vx
                            *COM*:00000004 Vy
                            *COM*:00000004 Xmax
                            *COM*:00000004 Ymax
                            *COM*:00000004 Xmin
                            *COM*:00000004 Ymin
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2124   .bss:00000000 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2125   .bss:00000000 g_swap_xy
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2128   .bss:00000004 g_kx_fp
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2131   .bss:00000008 g_ky_fp
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2134   .bss:0000000c g_ts_xc
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2137   .bss:00000010 g_ts_yc
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2140   .bss:00000014 g_lcd_xc
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2143   .bss:00000018 g_lcd_yc
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2146   .bss:0000001c g_ts_ready
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2149   .bss:00000020 g_ts_raw_x
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2152   .bss:00000024 g_ts_raw_y
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2155   .bss:00000028 g_last_touch_time
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2158   .text:00000000 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2161   .text:00000000 TS_Test
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2857   .text:00000710 Lcd_TC
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2670   .text:000005e4 TS_init
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3257   .text:00000bbc Check_Sel
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2195   .text:00000024 TSInt
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3634   .text:00000ff0 report_touch_data
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3140   .text:00000a88 DesignREC
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2654   .text:000005bc $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2667   .text:000005e4 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2747   .text:000006a0 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2762   .text:000006d0 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2765   .text:000006d0 TS_close
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2799   .text:00000708 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2805   .rodata:00000000 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:2854   .text:00000710 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3117   .text:00000a44 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3137   .text:00000a88 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3243   .text:00000b9c $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3254   .text:00000bbc $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3347   .text:00000ca0 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3359   .text:00000cc4 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3361   .text:00000cc4 clamp
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3413   .text:00000d24 draw_cross
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3627   .text:00000fec $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3631   .text:00000ff0 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3714   .text:000010b4 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3722   .text:000010c8 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3724   .text:000010c8 ts_wait_for_touch
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3760   .text:00001100 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3764   .text:00001104 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3766   .text:00001104 ts_read_raw
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3805   .text:0000114c $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3810   .text:00001154 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:3812   .text:00001154 get_cal_point
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4163   .text:0000157c $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4193   .text:00001594 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4196   .text:00001594 ts_calibrate_5pt
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4580   .text:00001a3c $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4596   .text:00001a70 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4599   .text:00001a70 ts_read_calibrated
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4765   .text:00001c50 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4784   .text:00001c7c $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4787   .text:00001c7c ts_test_calibracion
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4933   .text:00001e28 $d
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:5339   .bss:0000002c count.4306
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4958   .text:00001e30 $a
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:4961   .text:00001e30 ts_test_numeros
C:\Users\jaime\AppData\Local\Temp\ccEpTujT.s:5325   .text:000022bc $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
__aeabi_uidiv
DelayTime
Lcd_Init
Lcd_Clr
Lcd_Active_Clr
Lcd_Draw_Box
Lcd_DspAscII6x8
Lcd_Dma_Trans
Delay
timer2_count
__aeabi_ldivmod
Lcd_DspAscII8x16
