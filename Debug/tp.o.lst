   1              		.cpu arm7tdmi
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 18, 4
  11              		.file	"tp.c"
  21              	.Ltext0:
  22              		.file 1 "../tp.c"
 2712              		.align	2
 2713              	g_swap_xy:
 2714 0000 00000000 		.space	4
 2715              		.align	2
 2716              	g_kx_fp:
 2717 0004 00000000 		.space	4
 2718              		.align	2
 2719              	g_ky_fp:
 2720 0008 00000000 		.space	4
 2721              		.align	2
 2722              	g_ts_xc:
 2723 000c 00000000 		.space	4
 2724              		.align	2
 2725              	g_ts_yc:
 2726 0010 00000000 		.space	4
 2727              		.align	2
 2728              	g_lcd_xc:
 2729 0014 00000000 		.space	4
 2730              		.align	2
 2731              	g_lcd_yc:
 2732 0018 00000000 		.space	4
 2733              		.align	2
 2734              	g_ts_ready:
 2735 001c 00000000 		.space	4
 2736              		.align	2
 2737              	g_ts_raw_x:
 2738 0020 00000000 		.space	4
 2739              		.align	2
 2740              	g_ts_raw_y:
 2741 0024 00000000 		.space	4
 2742              		.text
 2743              		.align	2
 2744              		.global	TS_Test
 2746              	TS_Test:
 2747              	.LFB0:
   1:../tp.c       **** /*********************************************************************************************
   2:../tp.c       **** * File��	tp.c
   3:../tp.c       **** * Author:	embest	
   4:../tp.c       **** * Desc��	LCD touch screen control function
   5:../tp.c       **** * History:	
   6:../tp.c       **** *********************************************************************************************/
   7:../tp.c       **** 
   8:../tp.c       **** /*--- include files ---*/
   9:../tp.c       **** #include <string.h>
  10:../tp.c       **** #include "tp.h"
  11:../tp.c       **** #include "lcd.h"
  12:../tp.c       **** 
  13:../tp.c       **** void TSInt(void) __attribute__((interrupt("IRQ")));
  14:../tp.c       **** 
  15:../tp.c       **** /*===================================================================================
  16:../tp.c       ****  * VARIABLES GLOBALES DE CALIBRACIÓN (Método 5 puntos)
  17:../tp.c       ****  *===================================================================================*/
  18:../tp.c       **** static int g_swap_xy = 0;           // 1 si los ejes están intercambiados
  19:../tp.c       **** static long g_kx_fp;                // Factor de escala X en formato 16.16 fixed-point
  20:../tp.c       **** static long g_ky_fp;                // Factor de escala Y en formato 16.16 fixed-point
  21:../tp.c       **** static int g_ts_xc;                 // Centro X crudo del touch
  22:../tp.c       **** static int g_ts_yc;                 // Centro Y crudo del touch
  23:../tp.c       **** static int g_lcd_xc;                // Centro X del LCD
  24:../tp.c       **** static int g_lcd_yc;                // Centro Y del LCD
  25:../tp.c       **** static volatile int g_ts_ready = 0; // Flag para indicar que hay datos del touch
  26:../tp.c       **** static int g_ts_raw_x;              // Última lectura X cruda
  27:../tp.c       **** static int g_ts_raw_y;              // Última lectura Y cruda
  28:../tp.c       **** 
  29:../tp.c       **** void TS_Test(void)
  30:../tp.c       **** {
 2748              		.loc 1 30 0
 2749              		.cfi_startproc
 2750              		@ Function supports interworking.
 2751              		@ args = 0, pretend = 0, frame = 0
 2752              		@ frame_needed = 1, uses_anonymous_args = 0
 2753 0000 0DC0A0E1 		mov	ip, sp
 2754              	.LCFI0:
 2755              		.cfi_def_cfa_register 12
 2756 0004 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2757 0008 04B04CE2 		sub	fp, ip, #4
 2758              		.cfi_offset 14, -8
 2759              		.cfi_offset 13, -12
 2760              		.cfi_offset 11, -16
 2761              	.LCFI1:
 2762              		.cfi_def_cfa 11, 4
  31:../tp.c       **** 		Lcd_TC();
 2763              		.loc 1 31 0
 2764 000c FEFFFFEB 		bl	Lcd_TC
  32:../tp.c       **** 		TS_init();
 2765              		.loc 1 32 0
 2766 0010 FEFFFFEB 		bl	TS_init
  33:../tp.c       **** 		Check_Sel();
 2767              		.loc 1 33 0
 2768 0014 FEFFFFEB 		bl	Check_Sel
  34:../tp.c       **** 			
  35:../tp.c       **** //		Uart_Printf("\n Pixel: 320 X 240. Coordinate Rang in: (0,0) - (320,240)\n");
  36:../tp.c       **** //		Uart_Printf("\nLCD TouchScreen Test Example(please touch LCD screen)\n");
  37:../tp.c       **** }
 2769              		.loc 1 37 0
 2770 0018 0CD04BE2 		sub	sp, fp, #12
 2771 001c 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2772 0020 1EFF2FE1 		bx	lr
 2773              		.cfi_endproc
 2774              	.LFE0:
 2776              		.global	__aeabi_uidiv
 2777              		.align	2
 2778              		.global	TSInt
 2780              	TSInt:
 2781              	.LFB1:
  38:../tp.c       **** /*--- function code ---*/
  39:../tp.c       **** /*********************************************************************************************
  40:../tp.c       **** * name:		TSInt
  41:../tp.c       **** * func:		TouchScreen interrupt handler function
  42:../tp.c       **** * para:		none
  43:../tp.c       **** * ret:		none
  44:../tp.c       **** * modify:
  45:../tp.c       **** * comment:		
  46:../tp.c       **** ********************************************************************************************/
  47:../tp.c       **** void TSInt(void)
  48:../tp.c       **** {
 2782              		.loc 1 48 0
 2783              		.cfi_startproc
 2784              		@ Interrupt Service Routine.
 2785              		@ args = 0, pretend = 0, frame = 40
 2786              		@ frame_needed = 1, uses_anonymous_args = 0
 2787 0024 04C02DE5 		str	ip, [sp, #-4]!
 2788 0028 0DC0A0E1 		mov	ip, sp
 2789              	.LCFI2:
 2790              		.cfi_def_cfa_register 12
 2791 002c 0FD82DE9 		stmfd	sp!, {r0, r1, r2, r3, fp, ip, lr, pc}
 2792 0030 04B04CE2 		sub	fp, ip, #4
 2793              		.cfi_offset 14, -8
 2794              		.cfi_offset 13, -12
 2795              		.cfi_offset 11, -16
 2796              		.cfi_offset 3, -20
 2797              		.cfi_offset 2, -24
 2798              		.cfi_offset 1, -28
 2799              		.cfi_offset 0, -32
 2800              	.LCFI3:
 2801              		.cfi_def_cfa 11, 4
 2802 0034 28D04DE2 		sub	sp, sp, #40
  49:../tp.c       ****     int   i;
  50:../tp.c       ****     char fail = 0;
 2803              		.loc 1 50 0
 2804 0038 0030A0E3 		mov	r3, #0
 2805 003c 25304BE5 		strb	r3, [fp, #-37]
  51:../tp.c       ****     ULONG tmp;
  52:../tp.c       ****     ULONG Pt[6];
  53:../tp.c       **** 
  54:../tp.c       **** 	// <X-Position Read>
  55:../tp.c       **** 	// TSPX(GPE4_Q4(+)) TSPY(GPE5_Q3(-)) TSMY(GPE6_Q2(+)) TSMX(GPE7_Q1(-))
  56:../tp.c       ****     //       0               1                 1                0
  57:../tp.c       **** 	rPDATE=0x68;
 2806              		.loc 1 57 0
 2807 0040 54339FE5 		ldr	r3, .L13
 2808 0044 6820A0E3 		mov	r2, #104
 2809 0048 002083E5 		str	r2, [r3, #0]
  58:../tp.c       **** 	rADCCON=0x1<<2;			// AIN1
 2810              		.loc 1 58 0
 2811 004c 7537A0E3 		mov	r3, #30670848
 2812 0050 0420A0E3 		mov	r2, #4
 2813 0054 002083E5 		str	r2, [r3, #0]
  59:../tp.c       **** 	
  60:../tp.c       **** 	DelayTime(1000);                // delay to set up the next channel
 2814              		.loc 1 60 0
 2815 0058 FA0FA0E3 		mov	r0, #1000
 2816 005c FEFFFFEB 		bl	DelayTime
  61:../tp.c       **** 	for( i=0; i<5; i++ )
 2817              		.loc 1 61 0
 2818 0060 0030A0E3 		mov	r3, #0
 2819 0064 20300BE5 		str	r3, [fp, #-32]
 2820 0068 1F0000EA 		b	.L3
 2821              	.L6:
  62:../tp.c       **** 	{
  63:../tp.c       **** 		rADCCON |= 0x1;				// Start X-position A/D conversion
 2822              		.loc 1 63 0
 2823 006c 7537A0E3 		mov	r3, #30670848
 2824 0070 7527A0E3 		mov	r2, #30670848
 2825 0074 002092E5 		ldr	r2, [r2, #0]
 2826 0078 012082E3 		orr	r2, r2, #1
 2827 007c 002083E5 		str	r2, [r3, #0]
  64:../tp.c       **** 	    while( rADCCON & 0x1 );		// Check if Enable_start is low
 2828              		.loc 1 64 0
 2829 0080 0000A0E1 		mov	r0, r0	@ nop
 2830              	.L4:
 2831              		.loc 1 64 0 is_stmt 0 discriminator 1
 2832 0084 7537A0E3 		mov	r3, #30670848
 2833 0088 003093E5 		ldr	r3, [r3, #0]
 2834 008c 013003E2 		and	r3, r3, #1
 2835 0090 FF3003E2 		and	r3, r3, #255
 2836 0094 000053E3 		cmp	r3, #0
 2837 0098 F9FFFF1A 		bne	.L4
  65:../tp.c       ****     	while( !(rADCCON & 0x40) );	// Check ECFLG
 2838              		.loc 1 65 0 is_stmt 1
 2839 009c 0000A0E1 		mov	r0, r0	@ nop
 2840              	.L5:
 2841              		.loc 1 65 0 is_stmt 0 discriminator 1
 2842 00a0 7537A0E3 		mov	r3, #30670848
 2843 00a4 003093E5 		ldr	r3, [r3, #0]
 2844 00a8 403003E2 		and	r3, r3, #64
 2845 00ac 000053E3 		cmp	r3, #0
 2846 00b0 FAFFFF0A 		beq	.L5
  66:../tp.c       **** 	    Pt[i] = (0x3ff&rADCDAT);
 2847              		.loc 1 66 0 is_stmt 1
 2848 00b4 E4329FE5 		ldr	r3, .L13+4
 2849 00b8 003093E5 		ldr	r3, [r3, #0]
 2850 00bc 033BA0E1 		mov	r3, r3, asl #22
 2851 00c0 233BA0E1 		mov	r3, r3, lsr #22
 2852 00c4 20101BE5 		ldr	r1, [fp, #-32]
 2853 00c8 2320E0E3 		mvn	r2, #35
 2854 00cc 0111A0E1 		mov	r1, r1, asl #2
 2855 00d0 1C004BE2 		sub	r0, fp, #28
 2856 00d4 011080E0 		add	r1, r0, r1
 2857 00d8 022081E0 		add	r2, r1, r2
 2858 00dc 003082E5 		str	r3, [r2, #0]
  61:../tp.c       **** 	for( i=0; i<5; i++ )
 2859              		.loc 1 61 0
 2860 00e0 20301BE5 		ldr	r3, [fp, #-32]
 2861 00e4 013083E2 		add	r3, r3, #1
 2862 00e8 20300BE5 		str	r3, [fp, #-32]
 2863              	.L3:
  61:../tp.c       **** 	for( i=0; i<5; i++ )
 2864              		.loc 1 61 0 is_stmt 0 discriminator 1
 2865 00ec 20301BE5 		ldr	r3, [fp, #-32]
 2866 00f0 040053E3 		cmp	r3, #4
 2867 00f4 DCFFFFDA 		ble	.L6
  67:../tp.c       **** 	}
  68:../tp.c       **** 	// read X-position average value
  69:../tp.c       **** 	Pt[5] = (Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4])/5;
 2868              		.loc 1 69 0 is_stmt 1
 2869 00f8 40201BE5 		ldr	r2, [fp, #-64]
 2870 00fc 3C301BE5 		ldr	r3, [fp, #-60]
 2871 0100 032082E0 		add	r2, r2, r3
 2872 0104 38301BE5 		ldr	r3, [fp, #-56]
 2873 0108 032082E0 		add	r2, r2, r3
 2874 010c 34301BE5 		ldr	r3, [fp, #-52]
 2875 0110 032082E0 		add	r2, r2, r3
 2876 0114 30301BE5 		ldr	r3, [fp, #-48]
 2877 0118 032082E0 		add	r2, r2, r3
 2878 011c 80329FE5 		ldr	r3, .L13+8
 2879 0120 921383E0 		umull	r1, r3, r2, r3
 2880 0124 2331A0E1 		mov	r3, r3, lsr #2
 2881 0128 2C300BE5 		str	r3, [fp, #-44]
  70:../tp.c       **** 	
  71:../tp.c       **** 	tmp = Pt[5];	
 2882              		.loc 1 71 0
 2883 012c 2C301BE5 		ldr	r3, [fp, #-44]
 2884 0130 24300BE5 		str	r3, [fp, #-36]
  72:../tp.c       **** 	
  73:../tp.c       ****     // <Y-Position Read>
  74:../tp.c       **** 	// TSPX(GPE4_Q4(-)) TSPY(GPE5_Q3(+)) TSMY(GPE6_Q2(-)) TSMX(GPE7_Q1(+))
  75:../tp.c       ****     //       1               0                 0                1
  76:../tp.c       **** 	rPDATE=0x98;
 2885              		.loc 1 76 0
 2886 0134 60329FE5 		ldr	r3, .L13
 2887 0138 9820A0E3 		mov	r2, #152
 2888 013c 002083E5 		str	r2, [r3, #0]
  77:../tp.c       **** 	rADCCON=0x0<<2;		        	// AIN0
 2889              		.loc 1 77 0
 2890 0140 7537A0E3 		mov	r3, #30670848
 2891 0144 0020A0E3 		mov	r2, #0
 2892 0148 002083E5 		str	r2, [r3, #0]
  78:../tp.c       **** 	
  79:../tp.c       **** 	DelayTime(1000);                // delay to set up the next channel
 2893              		.loc 1 79 0
 2894 014c FA0FA0E3 		mov	r0, #1000
 2895 0150 FEFFFFEB 		bl	DelayTime
  80:../tp.c       **** 	for( i=0; i<5; i++ )
 2896              		.loc 1 80 0
 2897 0154 0030A0E3 		mov	r3, #0
 2898 0158 20300BE5 		str	r3, [fp, #-32]
 2899 015c 1F0000EA 		b	.L7
 2900              	.L10:
  81:../tp.c       **** 	{
  82:../tp.c       ****     	rADCCON |= 0x1;             // Start Y-position conversion
 2901              		.loc 1 82 0
 2902 0160 7537A0E3 		mov	r3, #30670848
 2903 0164 7527A0E3 		mov	r2, #30670848
 2904 0168 002092E5 		ldr	r2, [r2, #0]
 2905 016c 012082E3 		orr	r2, r2, #1
 2906 0170 002083E5 		str	r2, [r3, #0]
  83:../tp.c       **** 	    while( rADCCON & 0x1 );     // Check if Enable_start is low
 2907              		.loc 1 83 0
 2908 0174 0000A0E1 		mov	r0, r0	@ nop
 2909              	.L8:
 2910              		.loc 1 83 0 is_stmt 0 discriminator 1
 2911 0178 7537A0E3 		mov	r3, #30670848
 2912 017c 003093E5 		ldr	r3, [r3, #0]
 2913 0180 013003E2 		and	r3, r3, #1
 2914 0184 FF3003E2 		and	r3, r3, #255
 2915 0188 000053E3 		cmp	r3, #0
 2916 018c F9FFFF1A 		bne	.L8
  84:../tp.c       ****     	while( !(rADCCON & 0x40) ); // Check ECFLG
 2917              		.loc 1 84 0 is_stmt 1
 2918 0190 0000A0E1 		mov	r0, r0	@ nop
 2919              	.L9:
 2920              		.loc 1 84 0 is_stmt 0 discriminator 1
 2921 0194 7537A0E3 		mov	r3, #30670848
 2922 0198 003093E5 		ldr	r3, [r3, #0]
 2923 019c 403003E2 		and	r3, r3, #64
 2924 01a0 000053E3 		cmp	r3, #0
 2925 01a4 FAFFFF0A 		beq	.L9
  85:../tp.c       **** 	    Pt[i] = (0x3ff&rADCDAT);
 2926              		.loc 1 85 0 is_stmt 1
 2927 01a8 F0319FE5 		ldr	r3, .L13+4
 2928 01ac 003093E5 		ldr	r3, [r3, #0]
 2929 01b0 033BA0E1 		mov	r3, r3, asl #22
 2930 01b4 233BA0E1 		mov	r3, r3, lsr #22
 2931 01b8 20101BE5 		ldr	r1, [fp, #-32]
 2932 01bc 2320E0E3 		mvn	r2, #35
 2933 01c0 0111A0E1 		mov	r1, r1, asl #2
 2934 01c4 1C004BE2 		sub	r0, fp, #28
 2935 01c8 011080E0 		add	r1, r0, r1
 2936 01cc 022081E0 		add	r2, r1, r2
 2937 01d0 003082E5 		str	r3, [r2, #0]
  80:../tp.c       **** 	for( i=0; i<5; i++ )
 2938              		.loc 1 80 0
 2939 01d4 20301BE5 		ldr	r3, [fp, #-32]
 2940 01d8 013083E2 		add	r3, r3, #1
 2941 01dc 20300BE5 		str	r3, [fp, #-32]
 2942              	.L7:
  80:../tp.c       **** 	for( i=0; i<5; i++ )
 2943              		.loc 1 80 0 is_stmt 0 discriminator 1
 2944 01e0 20301BE5 		ldr	r3, [fp, #-32]
 2945 01e4 040053E3 		cmp	r3, #4
 2946 01e8 DCFFFFDA 		ble	.L10
  86:../tp.c       **** 	}
  87:../tp.c       **** 	// read Y-position average value
  88:../tp.c       **** 	Pt[5] = (Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4])/5;
 2947              		.loc 1 88 0 is_stmt 1
 2948 01ec 40201BE5 		ldr	r2, [fp, #-64]
 2949 01f0 3C301BE5 		ldr	r3, [fp, #-60]
 2950 01f4 032082E0 		add	r2, r2, r3
 2951 01f8 38301BE5 		ldr	r3, [fp, #-56]
 2952 01fc 032082E0 		add	r2, r2, r3
 2953 0200 34301BE5 		ldr	r3, [fp, #-52]
 2954 0204 032082E0 		add	r2, r2, r3
 2955 0208 30301BE5 		ldr	r3, [fp, #-48]
 2956 020c 032082E0 		add	r2, r2, r3
 2957 0210 8C319FE5 		ldr	r3, .L13+8
 2958 0214 921383E0 		umull	r1, r3, r2, r3
 2959 0218 2331A0E1 		mov	r3, r3, lsr #2
 2960 021c 2C300BE5 		str	r3, [fp, #-44]
  89:../tp.c       **** 	
  90:../tp.c       **** 	// Reportar coordenadas crudas para calibración
  91:../tp.c       **** 	report_touch_data(tmp, Pt[5]);
 2961              		.loc 1 91 0
 2962 0220 24201BE5 		ldr	r2, [fp, #-36]
 2963 0224 2C301BE5 		ldr	r3, [fp, #-44]
 2964 0228 0200A0E1 		mov	r0, r2
 2965 022c 0310A0E1 		mov	r1, r3
 2966 0230 FEFFFFEB 		bl	report_touch_data
  92:../tp.c       ****      
  93:../tp.c       **** 	if(!(CheckTSP|(tmp < Xmin)|(tmp > Xmax)|(Pt[5] < Ymin)|(Pt[5] > Ymax)))   // Is valid value?
 2967              		.loc 1 93 0
 2968 0234 6C319FE5 		ldr	r3, .L13+12
 2969 0238 003093E5 		ldr	r3, [r3, #0]
 2970 023c 24201BE5 		ldr	r2, [fp, #-36]
 2971 0240 030052E1 		cmp	r2, r3
 2972 0244 0020A023 		movcs	r2, #0
 2973 0248 0120A033 		movcc	r2, #1
 2974 024c 58319FE5 		ldr	r3, .L13+16
 2975 0250 003093E5 		ldr	r3, [r3, #0]
 2976 0254 032082E1 		orr	r2, r2, r3
 2977 0258 50319FE5 		ldr	r3, .L13+20
 2978 025c 003093E5 		ldr	r3, [r3, #0]
 2979 0260 24101BE5 		ldr	r1, [fp, #-36]
 2980 0264 030051E1 		cmp	r1, r3
 2981 0268 0030A093 		movls	r3, #0
 2982 026c 0130A083 		movhi	r3, #1
 2983 0270 032082E1 		orr	r2, r2, r3
 2984 0274 2C101BE5 		ldr	r1, [fp, #-44]
 2985 0278 34319FE5 		ldr	r3, .L13+24
 2986 027c 003093E5 		ldr	r3, [r3, #0]
 2987 0280 030051E1 		cmp	r1, r3
 2988 0284 0030A023 		movcs	r3, #0
 2989 0288 0130A033 		movcc	r3, #1
 2990 028c 032082E1 		orr	r2, r2, r3
 2991 0290 2C101BE5 		ldr	r1, [fp, #-44]
 2992 0294 1C319FE5 		ldr	r3, .L13+28
 2993 0298 003093E5 		ldr	r3, [r3, #0]
 2994 029c 030051E1 		cmp	r1, r3
 2995 02a0 0030A093 		movls	r3, #0
 2996 02a4 0130A083 		movhi	r3, #1
 2997 02a8 033082E1 		orr	r3, r2, r3
 2998 02ac 000053E3 		cmp	r3, #0
 2999 02b0 2500001A 		bne	.L11
  94:../tp.c       **** 	  {
  95:../tp.c       **** 		tmp = 320*(tmp - Xmin)/(Xmax - Xmin);   // X - position
 3000              		.loc 1 95 0
 3001 02b4 EC309FE5 		ldr	r3, .L13+12
 3002 02b8 003093E5 		ldr	r3, [r3, #0]
 3003 02bc 24201BE5 		ldr	r2, [fp, #-36]
 3004 02c0 022063E0 		rsb	r2, r3, r2
 3005 02c4 0230A0E1 		mov	r3, r2
 3006 02c8 0331A0E1 		mov	r3, r3, asl #2
 3007 02cc 023083E0 		add	r3, r3, r2
 3008 02d0 0333A0E1 		mov	r3, r3, asl #6
 3009 02d4 0320A0E1 		mov	r2, r3
 3010 02d8 D0309FE5 		ldr	r3, .L13+20
 3011 02dc 001093E5 		ldr	r1, [r3, #0]
 3012 02e0 C0309FE5 		ldr	r3, .L13+12
 3013 02e4 003093E5 		ldr	r3, [r3, #0]
 3014 02e8 013063E0 		rsb	r3, r3, r1
 3015 02ec 0200A0E1 		mov	r0, r2
 3016 02f0 0310A0E1 		mov	r1, r3
 3017 02f4 FEFFFFEB 		bl	__aeabi_uidiv
 3018 02f8 0030A0E1 		mov	r3, r0
 3019 02fc 24300BE5 		str	r3, [fp, #-36]
  96:../tp.c       **** //		Uart_Printf("X-Posion[AIN1] is %04d   ", tmp);
  97:../tp.c       **** 			
  98:../tp.c       **** 		Pt[5] = 240*(Pt[5] - Xmin)/(Ymax - Ymin);
 3020              		.loc 1 98 0
 3021 0300 2C201BE5 		ldr	r2, [fp, #-44]
 3022 0304 9C309FE5 		ldr	r3, .L13+12
 3023 0308 003093E5 		ldr	r3, [r3, #0]
 3024 030c 022063E0 		rsb	r2, r3, r2
 3025 0310 0230A0E1 		mov	r3, r2
 3026 0314 0332A0E1 		mov	r3, r3, asl #4
 3027 0318 033062E0 		rsb	r3, r2, r3
 3028 031c 0332A0E1 		mov	r3, r3, asl #4
 3029 0320 0320A0E1 		mov	r2, r3
 3030 0324 8C309FE5 		ldr	r3, .L13+28
 3031 0328 001093E5 		ldr	r1, [r3, #0]
 3032 032c 80309FE5 		ldr	r3, .L13+24
 3033 0330 003093E5 		ldr	r3, [r3, #0]
 3034 0334 013063E0 		rsb	r3, r3, r1
 3035 0338 0200A0E1 		mov	r0, r2
 3036 033c 0310A0E1 		mov	r1, r3
 3037 0340 FEFFFFEB 		bl	__aeabi_uidiv
 3038 0344 0030A0E1 		mov	r3, r0
 3039 0348 2C300BE5 		str	r3, [fp, #-44]
 3040              	.L11:
  99:../tp.c       **** //		Uart_Printf("  Y-Posion[AIN0] is %04d\n", Pt[5]);
 100:../tp.c       ****       }
 101:../tp.c       **** 
 102:../tp.c       ****     if(CheckTSP)
 3041              		.loc 1 102 0
 3042 034c 58309FE5 		ldr	r3, .L13+16
 3043 0350 003093E5 		ldr	r3, [r3, #0]
 3044 0354 000053E3 		cmp	r3, #0
 3045 0358 0300000A 		beq	.L12
 103:../tp.c       ****  	/*----------- check to ensure Xmax Ymax Xmin Ymin ------------*/
 104:../tp.c       ****  	    DesignREC(tmp,Pt[5]);
 3046              		.loc 1 104 0
 3047 035c 2C301BE5 		ldr	r3, [fp, #-44]
 3048 0360 24001BE5 		ldr	r0, [fp, #-36]
 3049 0364 0310A0E1 		mov	r1, r3
 3050 0368 FEFFFFEB 		bl	DesignREC
 3051              	.L12:
 105:../tp.c       **** 
 106:../tp.c       **** 	rPDATE = 0xb8;                  // should be enabled	
 3052              		.loc 1 106 0
 3053 036c 28309FE5 		ldr	r3, .L13
 3054 0370 B820A0E3 		mov	r2, #184
 3055 0374 002083E5 		str	r2, [r3, #0]
 107:../tp.c       **** 	DelayTime(3000);                // delay to set up the next channel	
 3056              		.loc 1 107 0
 3057 0378 3C009FE5 		ldr	r0, .L13+32
 3058 037c FEFFFFEB 		bl	DelayTime
 108:../tp.c       **** 
 109:../tp.c       ****     rI_ISPC = BIT_EINT2;            // clear pending_bit
 3059              		.loc 1 109 0
 3060 0380 38309FE5 		ldr	r3, .L13+36
 3061 0384 0225A0E3 		mov	r2, #8388608
 3062 0388 002083E5 		str	r2, [r3, #0]
 110:../tp.c       **** }
 3063              		.loc 1 110 0
 3064 038c 1CD04BE2 		sub	sp, fp, #28
 3065 0390 0F689DE8 		ldmfd	sp, {r0, r1, r2, r3, fp, sp, lr}
 3066 0394 04C09DE4 		ldmfd	sp!, {ip}
 3067 0398 04F05EE2 		subs	pc, lr, #4
 3068              	.L14:
 3069              		.align	2
 3070              	.L13:
 3071 039c 2C00D201 		.word	30539820
 3072 03a0 0800D401 		.word	30670856
 3073 03a4 CDCCCCCC 		.word	-858993459
 3074 03a8 00000000 		.word	Xmin
 3075 03ac 00000000 		.word	CheckTSP
 3076 03b0 00000000 		.word	Xmax
 3077 03b4 00000000 		.word	Ymin
 3078 03b8 00000000 		.word	Ymax
 3079 03bc B80B0000 		.word	3000
 3080 03c0 2400E001 		.word	31457316
 3081              		.cfi_endproc
 3082              	.LFE1:
 3084              		.align	2
 3085              		.global	TS_init
 3087              	TS_init:
 3088              	.LFB2:
 111:../tp.c       **** 			
 112:../tp.c       **** /*********************************************************************************************
 113:../tp.c       **** * name:		TS_init
 114:../tp.c       **** * func:		initialize TouchScreen
 115:../tp.c       **** * para:		none
 116:../tp.c       **** * ret:		none
 117:../tp.c       **** * modify:
 118:../tp.c       **** * comment:		
 119:../tp.c       **** *********************************************************************************************/
 120:../tp.c       **** void TS_init(void)
 121:../tp.c       **** {
 3089              		.loc 1 121 0
 3090              		.cfi_startproc
 3091              		@ Function supports interworking.
 3092              		@ args = 0, pretend = 0, frame = 0
 3093              		@ frame_needed = 1, uses_anonymous_args = 0
 3094 03c4 0DC0A0E1 		mov	ip, sp
 3095              	.LCFI4:
 3096              		.cfi_def_cfa_register 12
 3097 03c8 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3098 03cc 04B04CE2 		sub	fp, ip, #4
 3099              		.cfi_offset 14, -8
 3100              		.cfi_offset 13, -12
 3101              		.cfi_offset 11, -16
 3102              	.LCFI5:
 3103              		.cfi_def_cfa 11, 4
 122:../tp.c       ****     /* enable interrupt */
 123:../tp.c       **** 	rINTMOD=0x0;
 3104              		.loc 1 123 0
 3105 03d0 A8309FE5 		ldr	r3, .L16
 3106 03d4 0020A0E3 		mov	r2, #0
 3107 03d8 002083E5 		str	r2, [r3, #0]
 124:../tp.c       **** 	rINTCON=0x1;
 3108              		.loc 1 124 0
 3109 03dc 1E36A0E3 		mov	r3, #31457280
 3110 03e0 0120A0E3 		mov	r2, #1
 3111 03e4 002083E5 		str	r2, [r3, #0]
 125:../tp.c       ****     rI_ISPC |= BIT_EINT2;            // clear pending_bit
 3112              		.loc 1 125 0
 3113 03e8 94309FE5 		ldr	r3, .L16+4
 3114 03ec 90209FE5 		ldr	r2, .L16+4
 3115 03f0 002092E5 		ldr	r2, [r2, #0]
 3116 03f4 022582E3 		orr	r2, r2, #8388608
 3117 03f8 002083E5 		str	r2, [r3, #0]
 126:../tp.c       **** 	
 127:../tp.c       **** 	// TSPX(GPE4_Q4(-)) TSPY(GPE5_Q3(-)) TSMY(GPE6_Q2(-)) TSMX(GPE7_Q1(+)) 
 128:../tp.c       **** 	//          1               1                0                 1
 129:../tp.c       ****     rPUPE  = 0x0;	                 // Pull up
 3118              		.loc 1 129 0
 3119 03fc 84309FE5 		ldr	r3, .L16+8
 3120 0400 0020A0E3 		mov	r2, #0
 3121 0404 002083E5 		str	r2, [r3, #0]
 130:../tp.c       ****     rPDATE = 0xb8;                   // should be enabled	
 3122              		.loc 1 130 0
 3123 0408 7C309FE5 		ldr	r3, .L16+12
 3124 040c B820A0E3 		mov	r2, #184
 3125 0410 002083E5 		str	r2, [r3, #0]
 131:../tp.c       ****     DelayTime(100); 
 3126              		.loc 1 131 0
 3127 0414 6400A0E3 		mov	r0, #100
 3128 0418 FEFFFFEB 		bl	DelayTime
 132:../tp.c       ****     
 133:../tp.c       ****     rEXTINT |= 0x200;                // falling edge trigger
 3129              		.loc 1 133 0
 3130 041c 6C309FE5 		ldr	r3, .L16+16
 3131 0420 68209FE5 		ldr	r2, .L16+16
 3132 0424 002092E5 		ldr	r2, [r2, #0]
 3133 0428 022C82E3 		orr	r2, r2, #512
 3134 042c 002083E5 		str	r2, [r3, #0]
 134:../tp.c       ****     pISR_EINT2=(unsigned *)TSInt;       // set interrupt handler
 3135              		.loc 1 134 0
 3136 0430 5C309FE5 		ldr	r3, .L16+20
 3137 0434 5C209FE5 		ldr	r2, .L16+24
 3138 0438 002083E5 		str	r2, [r3, #0]
 135:../tp.c       ****     
 136:../tp.c       ****     rCLKCON = 0x7ff8;                // enable clock
 3139              		.loc 1 136 0
 3140 043c 58309FE5 		ldr	r3, .L16+28
 3141 0440 58209FE5 		ldr	r2, .L16+32
 3142 0444 002083E5 		str	r2, [r3, #0]
 137:../tp.c       ****     rADCPSR = 0x1;//0x4;             // A/D prescaler
 3143              		.loc 1 137 0
 3144 0448 54309FE5 		ldr	r3, .L16+36
 3145 044c 0120A0E3 		mov	r2, #1
 3146 0450 002083E5 		str	r2, [r3, #0]
 138:../tp.c       ****     rINTMSK &= ~(BIT_EINT2);
 3147              		.loc 1 138 0
 3148 0454 4C309FE5 		ldr	r3, .L16+40
 3149 0458 48209FE5 		ldr	r2, .L16+40
 3150 045c 002092E5 		ldr	r2, [r2, #0]
 3151 0460 0225C2E3 		bic	r2, r2, #8388608
 3152 0464 002083E5 		str	r2, [r3, #0]
 139:../tp.c       **** 
 140:../tp.c       ****     oneTouch = 0;
 3153              		.loc 1 140 0
 3154 0468 3C309FE5 		ldr	r3, .L16+44
 3155 046c 0020A0E3 		mov	r2, #0
 3156 0470 002083E5 		str	r2, [r3, #0]
 141:../tp.c       **** }
 3157              		.loc 1 141 0
 3158 0474 0CD04BE2 		sub	sp, fp, #12
 3159 0478 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3160 047c 1EFF2FE1 		bx	lr
 3161              	.L17:
 3162              		.align	2
 3163              	.L16:
 3164 0480 0800E001 		.word	31457288
 3165 0484 2400E001 		.word	31457316
 3166 0488 3000D201 		.word	30539824
 3167 048c 2C00D201 		.word	30539820
 3168 0490 5000D201 		.word	30539856
 3169 0494 7CFF7F0C 		.word	209715068
 3170 0498 00000000 		.word	TSInt
 3171 049c 0400D801 		.word	30932996
 3172 04a0 F87F0000 		.word	32760
 3173 04a4 0400D401 		.word	30670852
 3174 04a8 0C00E001 		.word	31457292
 3175 04ac 00000000 		.word	oneTouch
 3176              		.cfi_endproc
 3177              	.LFE2:
 3179              		.align	2
 3180              		.global	TS_close
 3182              	TS_close:
 3183              	.LFB3:
 142:../tp.c       **** 
 143:../tp.c       **** /*********************************************************************************************
 144:../tp.c       **** * name:		TS_close
 145:../tp.c       **** * func:		close TouchScreen
 146:../tp.c       **** * para:		none
 147:../tp.c       **** * ret:		none
 148:../tp.c       **** * modify:
 149:../tp.c       **** * comment:		
 150:../tp.c       **** *********************************************************************************************/
 151:../tp.c       **** void TS_close(void)
 152:../tp.c       **** {
 3184              		.loc 1 152 0
 3185              		.cfi_startproc
 3186              		@ Function supports interworking.
 3187              		@ args = 0, pretend = 0, frame = 0
 3188              		@ frame_needed = 1, uses_anonymous_args = 0
 3189 04b0 0DC0A0E1 		mov	ip, sp
 3190              	.LCFI6:
 3191              		.cfi_def_cfa_register 12
 3192 04b4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3193 04b8 04B04CE2 		sub	fp, ip, #4
 3194              		.cfi_offset 14, -8
 3195              		.cfi_offset 13, -12
 3196              		.cfi_offset 11, -16
 3197              	.LCFI7:
 3198              		.cfi_def_cfa 11, 4
 153:../tp.c       **** 	/* Mask interrupt */
 154:../tp.c       **** 	rINTMSK |=BIT_GLOBAL|BIT_EINT2;
 3199              		.loc 1 154 0
 3200 04bc 24309FE5 		ldr	r3, .L19
 3201 04c0 20209FE5 		ldr	r2, .L19
 3202 04c4 002092E5 		ldr	r2, [r2, #0]
 3203 04c8 122582E3 		orr	r2, r2, #75497472
 3204 04cc 002083E5 		str	r2, [r3, #0]
 155:../tp.c       **** 	pISR_EINT2 = (int)NULL;
 3205              		.loc 1 155 0
 3206 04d0 14309FE5 		ldr	r3, .L19+4
 3207 04d4 0020A0E3 		mov	r2, #0
 3208 04d8 002083E5 		str	r2, [r3, #0]
 156:../tp.c       **** }
 3209              		.loc 1 156 0
 3210 04dc 0CD04BE2 		sub	sp, fp, #12
 3211 04e0 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3212 04e4 1EFF2FE1 		bx	lr
 3213              	.L20:
 3214              		.align	2
 3215              	.L19:
 3216 04e8 0C00E001 		.word	31457292
 3217 04ec 7CFF7F0C 		.word	209715068
 3218              		.cfi_endproc
 3219              	.LFE3:
 3221              		.section	.rodata
 3222              		.align	2
 3223              	.LC0:
 3224 0000 3000     		.ascii	"0\000"
 3225 0002 0000     		.align	2
 3226              	.LC1:
 3227 0004 3100     		.ascii	"1\000"
 3228 0006 0000     		.align	2
 3229              	.LC2:
 3230 0008 3200     		.ascii	"2\000"
 3231 000a 0000     		.align	2
 3232              	.LC3:
 3233 000c 3300     		.ascii	"3\000"
 3234 000e 0000     		.align	2
 3235              	.LC4:
 3236 0010 3400     		.ascii	"4\000"
 3237 0012 0000     		.align	2
 3238              	.LC5:
 3239 0014 3500     		.ascii	"5\000"
 3240 0016 0000     		.align	2
 3241              	.LC6:
 3242 0018 3600     		.ascii	"6\000"
 3243 001a 0000     		.align	2
 3244              	.LC7:
 3245 001c 3700     		.ascii	"7\000"
 3246 001e 0000     		.align	2
 3247              	.LC8:
 3248 0020 3800     		.ascii	"8\000"
 3249 0022 0000     		.align	2
 3250              	.LC9:
 3251 0024 3900     		.ascii	"9\000"
 3252 0026 0000     		.align	2
 3253              	.LC10:
 3254 0028 4100     		.ascii	"A\000"
 3255 002a 0000     		.align	2
 3256              	.LC11:
 3257 002c 4200     		.ascii	"B\000"
 3258 002e 0000     		.align	2
 3259              	.LC12:
 3260 0030 4300     		.ascii	"C\000"
 3261 0032 0000     		.align	2
 3262              	.LC13:
 3263 0034 4400     		.ascii	"D\000"
 3264 0036 0000     		.align	2
 3265              	.LC14:
 3266 0038 4500     		.ascii	"E\000"
 3267 003a 0000     		.align	2
 3268              	.LC15:
 3269 003c 4600     		.ascii	"F\000"
 3270              		.text
 3271              		.align	2
 3272              		.global	Lcd_TC
 3274              	Lcd_TC:
 3275              	.LFB4:
 157:../tp.c       **** 
 158:../tp.c       **** void Lcd_TC(void)
 159:../tp.c       **** {
 3276              		.loc 1 159 0
 3277              		.cfi_startproc
 3278              		@ Function supports interworking.
 3279              		@ args = 0, pretend = 0, frame = 0
 3280              		@ frame_needed = 1, uses_anonymous_args = 0
 3281 04f0 0DC0A0E1 		mov	ip, sp
 3282              	.LCFI8:
 3283              		.cfi_def_cfa_register 12
 3284 04f4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3285 04f8 04B04CE2 		sub	fp, ip, #4
 3286              		.cfi_offset 14, -8
 3287              		.cfi_offset 13, -12
 3288              		.cfi_offset 11, -16
 3289              	.LCFI9:
 3290              		.cfi_def_cfa 11, 4
 3291 04fc 08D04DE2 		sub	sp, sp, #8
 160:../tp.c       **** 	/* initial LCD controller */
 161:../tp.c       **** 	Lcd_Init();
 3292              		.loc 1 161 0
 3293 0500 FEFFFFEB 		bl	Lcd_Init
 162:../tp.c       **** 	/* clear screen */
 163:../tp.c       **** 	Lcd_Clr();
 3294              		.loc 1 163 0
 3295 0504 FEFFFFEB 		bl	Lcd_Clr
 164:../tp.c       **** 	Lcd_Active_Clr();
 3296              		.loc 1 164 0
 3297 0508 FEFFFFEB 		bl	Lcd_Active_Clr
 165:../tp.c       **** 	/* draw rectangle pattern */ 
 166:../tp.c       **** 	Lcd_Draw_Box(0,0,80,60,15);
 3298              		.loc 1 166 0
 3299 050c 0F30A0E3 		mov	r3, #15
 3300 0510 00308DE5 		str	r3, [sp, #0]
 3301 0514 0000A0E3 		mov	r0, #0
 3302 0518 0010A0E3 		mov	r1, #0
 3303 051c 5020A0E3 		mov	r2, #80
 3304 0520 3C30A0E3 		mov	r3, #60
 3305 0524 FEFFFFEB 		bl	Lcd_Draw_Box
 167:../tp.c       **** 	Lcd_Draw_Box(80,0,160,60,15);
 3306              		.loc 1 167 0
 3307 0528 0F30A0E3 		mov	r3, #15
 3308 052c 00308DE5 		str	r3, [sp, #0]
 3309 0530 5000A0E3 		mov	r0, #80
 3310 0534 0010A0E3 		mov	r1, #0
 3311 0538 A020A0E3 		mov	r2, #160
 3312 053c 3C30A0E3 		mov	r3, #60
 3313 0540 FEFFFFEB 		bl	Lcd_Draw_Box
 168:../tp.c       **** 	Lcd_Draw_Box(160,0,240,60,15);
 3314              		.loc 1 168 0
 3315 0544 0F30A0E3 		mov	r3, #15
 3316 0548 00308DE5 		str	r3, [sp, #0]
 3317 054c A000A0E3 		mov	r0, #160
 3318 0550 0010A0E3 		mov	r1, #0
 3319 0554 F020A0E3 		mov	r2, #240
 3320 0558 3C30A0E3 		mov	r3, #60
 3321 055c FEFFFFEB 		bl	Lcd_Draw_Box
 169:../tp.c       **** 	Lcd_Draw_Box(240,0,320,60,15);
 3322              		.loc 1 169 0
 3323 0560 0F30A0E3 		mov	r3, #15
 3324 0564 00308DE5 		str	r3, [sp, #0]
 3325 0568 F000A0E3 		mov	r0, #240
 3326 056c 0010A0E3 		mov	r1, #0
 3327 0570 052DA0E3 		mov	r2, #320
 3328 0574 3C30A0E3 		mov	r3, #60
 3329 0578 FEFFFFEB 		bl	Lcd_Draw_Box
 170:../tp.c       **** 	Lcd_Draw_Box(0,60,80,120,15);
 3330              		.loc 1 170 0
 3331 057c 0F30A0E3 		mov	r3, #15
 3332 0580 00308DE5 		str	r3, [sp, #0]
 3333 0584 0000A0E3 		mov	r0, #0
 3334 0588 3C10A0E3 		mov	r1, #60
 3335 058c 5020A0E3 		mov	r2, #80
 3336 0590 7830A0E3 		mov	r3, #120
 3337 0594 FEFFFFEB 		bl	Lcd_Draw_Box
 171:../tp.c       **** 	Lcd_Draw_Box(80,60,160,120,15);
 3338              		.loc 1 171 0
 3339 0598 0F30A0E3 		mov	r3, #15
 3340 059c 00308DE5 		str	r3, [sp, #0]
 3341 05a0 5000A0E3 		mov	r0, #80
 3342 05a4 3C10A0E3 		mov	r1, #60
 3343 05a8 A020A0E3 		mov	r2, #160
 3344 05ac 7830A0E3 		mov	r3, #120
 3345 05b0 FEFFFFEB 		bl	Lcd_Draw_Box
 172:../tp.c       **** 	Lcd_Draw_Box(160,60,240,120,15);
 3346              		.loc 1 172 0
 3347 05b4 0F30A0E3 		mov	r3, #15
 3348 05b8 00308DE5 		str	r3, [sp, #0]
 3349 05bc A000A0E3 		mov	r0, #160
 3350 05c0 3C10A0E3 		mov	r1, #60
 3351 05c4 F020A0E3 		mov	r2, #240
 3352 05c8 7830A0E3 		mov	r3, #120
 3353 05cc FEFFFFEB 		bl	Lcd_Draw_Box
 173:../tp.c       **** 	Lcd_Draw_Box(240,60,320,120,15);
 3354              		.loc 1 173 0
 3355 05d0 0F30A0E3 		mov	r3, #15
 3356 05d4 00308DE5 		str	r3, [sp, #0]
 3357 05d8 F000A0E3 		mov	r0, #240
 3358 05dc 3C10A0E3 		mov	r1, #60
 3359 05e0 052DA0E3 		mov	r2, #320
 3360 05e4 7830A0E3 		mov	r3, #120
 3361 05e8 FEFFFFEB 		bl	Lcd_Draw_Box
 174:../tp.c       **** 	Lcd_Draw_Box(0,120,80,180,15);
 3362              		.loc 1 174 0
 3363 05ec 0F30A0E3 		mov	r3, #15
 3364 05f0 00308DE5 		str	r3, [sp, #0]
 3365 05f4 0000A0E3 		mov	r0, #0
 3366 05f8 7810A0E3 		mov	r1, #120
 3367 05fc 5020A0E3 		mov	r2, #80
 3368 0600 B430A0E3 		mov	r3, #180
 3369 0604 FEFFFFEB 		bl	Lcd_Draw_Box
 175:../tp.c       **** 	Lcd_Draw_Box(80,120,160,180,15);
 3370              		.loc 1 175 0
 3371 0608 0F30A0E3 		mov	r3, #15
 3372 060c 00308DE5 		str	r3, [sp, #0]
 3373 0610 5000A0E3 		mov	r0, #80
 3374 0614 7810A0E3 		mov	r1, #120
 3375 0618 A020A0E3 		mov	r2, #160
 3376 061c B430A0E3 		mov	r3, #180
 3377 0620 FEFFFFEB 		bl	Lcd_Draw_Box
 176:../tp.c       **** 	Lcd_Draw_Box(160,120,240,180,15);
 3378              		.loc 1 176 0
 3379 0624 0F30A0E3 		mov	r3, #15
 3380 0628 00308DE5 		str	r3, [sp, #0]
 3381 062c A000A0E3 		mov	r0, #160
 3382 0630 7810A0E3 		mov	r1, #120
 3383 0634 F020A0E3 		mov	r2, #240
 3384 0638 B430A0E3 		mov	r3, #180
 3385 063c FEFFFFEB 		bl	Lcd_Draw_Box
 177:../tp.c       **** 	Lcd_Draw_Box(240,120,320,180,15);
 3386              		.loc 1 177 0
 3387 0640 0F30A0E3 		mov	r3, #15
 3388 0644 00308DE5 		str	r3, [sp, #0]
 3389 0648 F000A0E3 		mov	r0, #240
 3390 064c 7810A0E3 		mov	r1, #120
 3391 0650 052DA0E3 		mov	r2, #320
 3392 0654 B430A0E3 		mov	r3, #180
 3393 0658 FEFFFFEB 		bl	Lcd_Draw_Box
 178:../tp.c       **** 	Lcd_Draw_Box(0,180,80,240,15);
 3394              		.loc 1 178 0
 3395 065c 0F30A0E3 		mov	r3, #15
 3396 0660 00308DE5 		str	r3, [sp, #0]
 3397 0664 0000A0E3 		mov	r0, #0
 3398 0668 B410A0E3 		mov	r1, #180
 3399 066c 5020A0E3 		mov	r2, #80
 3400 0670 F030A0E3 		mov	r3, #240
 3401 0674 FEFFFFEB 		bl	Lcd_Draw_Box
 179:../tp.c       **** 	Lcd_Draw_Box(80,180,160,240,15);
 3402              		.loc 1 179 0
 3403 0678 0F30A0E3 		mov	r3, #15
 3404 067c 00308DE5 		str	r3, [sp, #0]
 3405 0680 5000A0E3 		mov	r0, #80
 3406 0684 B410A0E3 		mov	r1, #180
 3407 0688 A020A0E3 		mov	r2, #160
 3408 068c F030A0E3 		mov	r3, #240
 3409 0690 FEFFFFEB 		bl	Lcd_Draw_Box
 180:../tp.c       **** 	Lcd_Draw_Box(160,180,240,240,15);
 3410              		.loc 1 180 0
 3411 0694 0F30A0E3 		mov	r3, #15
 3412 0698 00308DE5 		str	r3, [sp, #0]
 3413 069c A000A0E3 		mov	r0, #160
 3414 06a0 B410A0E3 		mov	r1, #180
 3415 06a4 F020A0E3 		mov	r2, #240
 3416 06a8 F030A0E3 		mov	r3, #240
 3417 06ac FEFFFFEB 		bl	Lcd_Draw_Box
 181:../tp.c       **** 	Lcd_Draw_Box(240,180,320,240,15);
 3418              		.loc 1 181 0
 3419 06b0 0F30A0E3 		mov	r3, #15
 3420 06b4 00308DE5 		str	r3, [sp, #0]
 3421 06b8 F000A0E3 		mov	r0, #240
 3422 06bc B410A0E3 		mov	r1, #180
 3423 06c0 052DA0E3 		mov	r2, #320
 3424 06c4 F030A0E3 		mov	r3, #240
 3425 06c8 FEFFFFEB 		bl	Lcd_Draw_Box
 182:../tp.c       **** 	/* output ASCII symbol */
 183:../tp.c       **** 	Lcd_DspAscII6x8(37,26,BLACK,"0");
 3426              		.loc 1 183 0
 3427 06cc 2500A0E3 		mov	r0, #37
 3428 06d0 1A10A0E3 		mov	r1, #26
 3429 06d4 0F20A0E3 		mov	r2, #15
 3430 06d8 44319FE5 		ldr	r3, .L22
 3431 06dc FEFFFFEB 		bl	Lcd_DspAscII6x8
 184:../tp.c       **** 	Lcd_DspAscII6x8(117,26,BLACK,"1");
 3432              		.loc 1 184 0
 3433 06e0 7500A0E3 		mov	r0, #117
 3434 06e4 1A10A0E3 		mov	r1, #26
 3435 06e8 0F20A0E3 		mov	r2, #15
 3436 06ec 34319FE5 		ldr	r3, .L22+4
 3437 06f0 FEFFFFEB 		bl	Lcd_DspAscII6x8
 185:../tp.c       **** 	Lcd_DspAscII6x8(197,26,BLACK,"2");
 3438              		.loc 1 185 0
 3439 06f4 C500A0E3 		mov	r0, #197
 3440 06f8 1A10A0E3 		mov	r1, #26
 3441 06fc 0F20A0E3 		mov	r2, #15
 3442 0700 24319FE5 		ldr	r3, .L22+8
 3443 0704 FEFFFFEB 		bl	Lcd_DspAscII6x8
 186:../tp.c       **** 	Lcd_DspAscII6x8(277,26,BLACK,"3");
 3444              		.loc 1 186 0
 3445 0708 20019FE5 		ldr	r0, .L22+12
 3446 070c 1A10A0E3 		mov	r1, #26
 3447 0710 0F20A0E3 		mov	r2, #15
 3448 0714 18319FE5 		ldr	r3, .L22+16
 3449 0718 FEFFFFEB 		bl	Lcd_DspAscII6x8
 187:../tp.c       **** 	Lcd_DspAscII6x8(37,86,BLACK,"4");
 3450              		.loc 1 187 0
 3451 071c 2500A0E3 		mov	r0, #37
 3452 0720 5610A0E3 		mov	r1, #86
 3453 0724 0F20A0E3 		mov	r2, #15
 3454 0728 08319FE5 		ldr	r3, .L22+20
 3455 072c FEFFFFEB 		bl	Lcd_DspAscII6x8
 188:../tp.c       **** 	Lcd_DspAscII6x8(117,86,BLACK,"5");
 3456              		.loc 1 188 0
 3457 0730 7500A0E3 		mov	r0, #117
 3458 0734 5610A0E3 		mov	r1, #86
 3459 0738 0F20A0E3 		mov	r2, #15
 3460 073c F8309FE5 		ldr	r3, .L22+24
 3461 0740 FEFFFFEB 		bl	Lcd_DspAscII6x8
 189:../tp.c       **** 	Lcd_DspAscII6x8(197,86,BLACK,"6");
 3462              		.loc 1 189 0
 3463 0744 C500A0E3 		mov	r0, #197
 3464 0748 5610A0E3 		mov	r1, #86
 3465 074c 0F20A0E3 		mov	r2, #15
 3466 0750 E8309FE5 		ldr	r3, .L22+28
 3467 0754 FEFFFFEB 		bl	Lcd_DspAscII6x8
 190:../tp.c       **** 	Lcd_DspAscII6x8(277,86,BLACK,"7");
 3468              		.loc 1 190 0
 3469 0758 D0009FE5 		ldr	r0, .L22+12
 3470 075c 5610A0E3 		mov	r1, #86
 3471 0760 0F20A0E3 		mov	r2, #15
 3472 0764 D8309FE5 		ldr	r3, .L22+32
 3473 0768 FEFFFFEB 		bl	Lcd_DspAscII6x8
 191:../tp.c       **** 	Lcd_DspAscII6x8(37,146,BLACK,"8");
 3474              		.loc 1 191 0
 3475 076c 2500A0E3 		mov	r0, #37
 3476 0770 9210A0E3 		mov	r1, #146
 3477 0774 0F20A0E3 		mov	r2, #15
 3478 0778 C8309FE5 		ldr	r3, .L22+36
 3479 077c FEFFFFEB 		bl	Lcd_DspAscII6x8
 192:../tp.c       **** 	Lcd_DspAscII6x8(117,146,BLACK,"9");
 3480              		.loc 1 192 0
 3481 0780 7500A0E3 		mov	r0, #117
 3482 0784 9210A0E3 		mov	r1, #146
 3483 0788 0F20A0E3 		mov	r2, #15
 3484 078c B8309FE5 		ldr	r3, .L22+40
 3485 0790 FEFFFFEB 		bl	Lcd_DspAscII6x8
 193:../tp.c       **** 	Lcd_DspAscII6x8(197,146,BLACK,"A");
 3486              		.loc 1 193 0
 3487 0794 C500A0E3 		mov	r0, #197
 3488 0798 9210A0E3 		mov	r1, #146
 3489 079c 0F20A0E3 		mov	r2, #15
 3490 07a0 A8309FE5 		ldr	r3, .L22+44
 3491 07a4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 194:../tp.c       **** 	Lcd_DspAscII6x8(277,146,BLACK,"B");
 3492              		.loc 1 194 0
 3493 07a8 80009FE5 		ldr	r0, .L22+12
 3494 07ac 9210A0E3 		mov	r1, #146
 3495 07b0 0F20A0E3 		mov	r2, #15
 3496 07b4 98309FE5 		ldr	r3, .L22+48
 3497 07b8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 195:../tp.c       **** 	Lcd_DspAscII6x8(37,206,BLACK,"C");
 3498              		.loc 1 195 0
 3499 07bc 2500A0E3 		mov	r0, #37
 3500 07c0 CE10A0E3 		mov	r1, #206
 3501 07c4 0F20A0E3 		mov	r2, #15
 3502 07c8 88309FE5 		ldr	r3, .L22+52
 3503 07cc FEFFFFEB 		bl	Lcd_DspAscII6x8
 196:../tp.c       **** 	Lcd_DspAscII6x8(117,206,BLACK,"D");
 3504              		.loc 1 196 0
 3505 07d0 7500A0E3 		mov	r0, #117
 3506 07d4 CE10A0E3 		mov	r1, #206
 3507 07d8 0F20A0E3 		mov	r2, #15
 3508 07dc 78309FE5 		ldr	r3, .L22+56
 3509 07e0 FEFFFFEB 		bl	Lcd_DspAscII6x8
 197:../tp.c       **** 	Lcd_DspAscII6x8(197,206,BLACK,"E");
 3510              		.loc 1 197 0
 3511 07e4 C500A0E3 		mov	r0, #197
 3512 07e8 CE10A0E3 		mov	r1, #206
 3513 07ec 0F20A0E3 		mov	r2, #15
 3514 07f0 68309FE5 		ldr	r3, .L22+60
 3515 07f4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 198:../tp.c       **** 	Lcd_DspAscII6x8(277,206,BLACK,"F");
 3516              		.loc 1 198 0
 3517 07f8 30009FE5 		ldr	r0, .L22+12
 3518 07fc CE10A0E3 		mov	r1, #206
 3519 0800 0F20A0E3 		mov	r2, #15
 3520 0804 58309FE5 		ldr	r3, .L22+64
 3521 0808 FEFFFFEB 		bl	Lcd_DspAscII6x8
 199:../tp.c       **** 	Lcd_Dma_Trans();
 3522              		.loc 1 199 0
 3523 080c FEFFFFEB 		bl	Lcd_Dma_Trans
 200:../tp.c       **** 	Delay(100);
 3524              		.loc 1 200 0
 3525 0810 6400A0E3 		mov	r0, #100
 3526 0814 FEFFFFEB 		bl	Delay
 201:../tp.c       **** }
 3527              		.loc 1 201 0
 3528 0818 0CD04BE2 		sub	sp, fp, #12
 3529 081c 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3530 0820 1EFF2FE1 		bx	lr
 3531              	.L23:
 3532              		.align	2
 3533              	.L22:
 3534 0824 00000000 		.word	.LC0
 3535 0828 04000000 		.word	.LC1
 3536 082c 08000000 		.word	.LC2
 3537 0830 15010000 		.word	277
 3538 0834 0C000000 		.word	.LC3
 3539 0838 10000000 		.word	.LC4
 3540 083c 14000000 		.word	.LC5
 3541 0840 18000000 		.word	.LC6
 3542 0844 1C000000 		.word	.LC7
 3543 0848 20000000 		.word	.LC8
 3544 084c 24000000 		.word	.LC9
 3545 0850 28000000 		.word	.LC10
 3546 0854 2C000000 		.word	.LC11
 3547 0858 30000000 		.word	.LC12
 3548 085c 34000000 		.word	.LC13
 3549 0860 38000000 		.word	.LC14
 3550 0864 3C000000 		.word	.LC15
 3551              		.cfi_endproc
 3552              	.LFE4:
 3554              		.align	2
 3555              		.global	DesignREC
 3557              	DesignREC:
 3558              	.LFB5:
 202:../tp.c       **** 
 203:../tp.c       **** /*********************************************************************************************
 204:../tp.c       **** * name:		DesignREC
 205:../tp.c       **** * func:		confirm the coordinate rang
 206:../tp.c       **** * para:		none
 207:../tp.c       **** * ret:		none
 208:../tp.c       **** * modify:
 209:../tp.c       **** * comment:		
 210:../tp.c       **** *********************************************************************************************/
 211:../tp.c       **** void DesignREC(ULONG tx, ULONG ty)
 212:../tp.c       **** {
 3559              		.loc 1 212 0
 3560              		.cfi_startproc
 3561              		@ Function supports interworking.
 3562              		@ args = 0, pretend = 0, frame = 16
 3563              		@ frame_needed = 1, uses_anonymous_args = 0
 3564 0868 0DC0A0E1 		mov	ip, sp
 3565              	.LCFI10:
 3566              		.cfi_def_cfa_register 12
 3567 086c 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3568 0870 04B04CE2 		sub	fp, ip, #4
 3569              		.cfi_offset 14, -8
 3570              		.cfi_offset 13, -12
 3571              		.cfi_offset 11, -16
 3572              	.LCFI11:
 3573              		.cfi_def_cfa 11, 4
 3574 0874 10D04DE2 		sub	sp, sp, #16
 3575 0878 18000BE5 		str	r0, [fp, #-24]
 3576 087c 1C100BE5 		str	r1, [fp, #-28]
 213:../tp.c       ****     int tm;
 214:../tp.c       ****     
 215:../tp.c       **** //  Uart_Printf("\n\r User touch coordinate(X,Y) is :");
 216:../tp.c       **** //	Uart_Printf("(%04d",tx);	
 217:../tp.c       **** //	Uart_Printf(",%04d)\n",ty);    
 218:../tp.c       ****     if(oneTouch == 0)
 3577              		.loc 1 218 0
 3578 0880 F4309FE5 		ldr	r3, .L29
 3579 0884 003093E5 		ldr	r3, [r3, #0]
 3580 0888 000053E3 		cmp	r3, #0
 3581 088c 0900001A 		bne	.L25
 219:../tp.c       ****      {
 220:../tp.c       ****        Vx = tx;                   // Vx as Xmax
 3582              		.loc 1 220 0
 3583 0890 E8309FE5 		ldr	r3, .L29+4
 3584 0894 18201BE5 		ldr	r2, [fp, #-24]
 3585 0898 002083E5 		str	r2, [r3, #0]
 221:../tp.c       ****        Vy = ty;                   // Vy as Ymax
 3586              		.loc 1 221 0
 3587 089c E0309FE5 		ldr	r3, .L29+8
 3588 08a0 1C201BE5 		ldr	r2, [fp, #-28]
 3589 08a4 002083E5 		str	r2, [r3, #0]
 222:../tp.c       ****        oneTouch = 1;       		           
 3590              		.loc 1 222 0
 3591 08a8 CC309FE5 		ldr	r3, .L29
 3592 08ac 0120A0E3 		mov	r2, #1
 3593 08b0 002083E5 		str	r2, [r3, #0]
 3594 08b4 2D0000EA 		b	.L24
 3595              	.L25:
 223:../tp.c       ****     }else{
 224:../tp.c       ****     
 225:../tp.c       ****     if(Vx < tx )
 3596              		.loc 1 225 0
 3597 08b8 C0309FE5 		ldr	r3, .L29+4
 3598 08bc 002093E5 		ldr	r2, [r3, #0]
 3599 08c0 18301BE5 		ldr	r3, [fp, #-24]
 3600 08c4 030052E1 		cmp	r2, r3
 3601 08c8 0700002A 		bcs	.L27
 226:../tp.c       ****      {
 227:../tp.c       ****        tm = tx; tx = Vx; Vx = tm; // tx as Xmin
 3602              		.loc 1 227 0
 3603 08cc 18301BE5 		ldr	r3, [fp, #-24]
 3604 08d0 10300BE5 		str	r3, [fp, #-16]
 3605 08d4 A4309FE5 		ldr	r3, .L29+4
 3606 08d8 003093E5 		ldr	r3, [r3, #0]
 3607 08dc 18300BE5 		str	r3, [fp, #-24]
 3608 08e0 10201BE5 		ldr	r2, [fp, #-16]
 3609 08e4 94309FE5 		ldr	r3, .L29+4
 3610 08e8 002083E5 		str	r2, [r3, #0]
 3611              	.L27:
 228:../tp.c       ****      }
 229:../tp.c       ****     if(Vy < ty )
 3612              		.loc 1 229 0
 3613 08ec 90309FE5 		ldr	r3, .L29+8
 3614 08f0 002093E5 		ldr	r2, [r3, #0]
 3615 08f4 1C301BE5 		ldr	r3, [fp, #-28]
 3616 08f8 030052E1 		cmp	r2, r3
 3617 08fc 0700002A 		bcs	.L28
 230:../tp.c       ****      { 
 231:../tp.c       ****        tm = ty; ty = Vy; Vy = tm; // ty as Ymin
 3618              		.loc 1 231 0
 3619 0900 1C301BE5 		ldr	r3, [fp, #-28]
 3620 0904 10300BE5 		str	r3, [fp, #-16]
 3621 0908 74309FE5 		ldr	r3, .L29+8
 3622 090c 003093E5 		ldr	r3, [r3, #0]
 3623 0910 1C300BE5 		str	r3, [fp, #-28]
 3624 0914 10201BE5 		ldr	r2, [fp, #-16]
 3625 0918 64309FE5 		ldr	r3, .L29+8
 3626 091c 002083E5 		str	r2, [r3, #0]
 3627              	.L28:
 232:../tp.c       ****      }
 233:../tp.c       ****      
 234:../tp.c       ****     Xmax = Vx;    Xmin = tx;
 3628              		.loc 1 234 0
 3629 0920 58309FE5 		ldr	r3, .L29+4
 3630 0924 002093E5 		ldr	r2, [r3, #0]
 3631 0928 58309FE5 		ldr	r3, .L29+12
 3632 092c 002083E5 		str	r2, [r3, #0]
 3633 0930 54309FE5 		ldr	r3, .L29+16
 3634 0934 18201BE5 		ldr	r2, [fp, #-24]
 3635 0938 002083E5 		str	r2, [r3, #0]
 235:../tp.c       ****     Ymax = Vy;    Ymin = ty;
 3636              		.loc 1 235 0
 3637 093c 40309FE5 		ldr	r3, .L29+8
 3638 0940 002093E5 		ldr	r2, [r3, #0]
 3639 0944 44309FE5 		ldr	r3, .L29+20
 3640 0948 002083E5 		str	r2, [r3, #0]
 3641 094c 40309FE5 		ldr	r3, .L29+24
 3642 0950 1C201BE5 		ldr	r2, [fp, #-28]
 3643 0954 002083E5 		str	r2, [r3, #0]
 236:../tp.c       ****     
 237:../tp.c       ****     oneTouch = 0;
 3644              		.loc 1 237 0
 3645 0958 1C309FE5 		ldr	r3, .L29
 3646 095c 0020A0E3 		mov	r2, #0
 3647 0960 002083E5 		str	r2, [r3, #0]
 238:../tp.c       **** 	CheckTSP = 0;// has checked
 3648              		.loc 1 238 0
 3649 0964 2C309FE5 		ldr	r3, .L29+28
 3650 0968 0020A0E3 		mov	r2, #0
 3651 096c 002083E5 		str	r2, [r3, #0]
 3652              	.L24:
 239:../tp.c       **** 	
 240:../tp.c       **** 	}// end if(oneTouch == 0)
 241:../tp.c       **** 
 242:../tp.c       **** }
 3653              		.loc 1 242 0
 3654 0970 0CD04BE2 		sub	sp, fp, #12
 3655 0974 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3656 0978 1EFF2FE1 		bx	lr
 3657              	.L30:
 3658              		.align	2
 3659              	.L29:
 3660 097c 00000000 		.word	oneTouch
 3661 0980 00000000 		.word	Vx
 3662 0984 00000000 		.word	Vy
 3663 0988 00000000 		.word	Xmax
 3664 098c 00000000 		.word	Xmin
 3665 0990 00000000 		.word	Ymax
 3666 0994 00000000 		.word	Ymin
 3667 0998 00000000 		.word	CheckTSP
 3668              		.cfi_endproc
 3669              	.LFE5:
 3671              		.align	2
 3672              		.global	Check_Sel
 3674              	Check_Sel:
 3675              	.LFB6:
 243:../tp.c       **** 
 244:../tp.c       **** void Check_Sel(void)
 245:../tp.c       **** {
 3676              		.loc 1 245 0
 3677              		.cfi_startproc
 3678              		@ Function supports interworking.
 3679              		@ args = 0, pretend = 0, frame = 8
 3680              		@ frame_needed = 1, uses_anonymous_args = 0
 3681 099c 0DC0A0E1 		mov	ip, sp
 3682              	.LCFI12:
 3683              		.cfi_def_cfa_register 12
 3684 09a0 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3685 09a4 04B04CE2 		sub	fp, ip, #4
 3686              		.cfi_offset 14, -8
 3687              		.cfi_offset 13, -12
 3688              		.cfi_offset 11, -16
 3689              	.LCFI13:
 3690              		.cfi_def_cfa 11, 4
 3691 09a8 08D04DE2 		sub	sp, sp, #8
 3692              	.L35:
 246:../tp.c       **** 	char yn;
 247:../tp.c       ****     
 248:../tp.c       **** 	do{
 249:../tp.c       **** 	  
 250:../tp.c       **** 	  rINTMSK |=BIT_GLOBAL|BIT_EINT2;
 3693              		.loc 1 250 0
 3694 09ac CC309FE5 		ldr	r3, .L37
 3695 09b0 C8209FE5 		ldr	r2, .L37
 3696 09b4 002092E5 		ldr	r2, [r2, #0]
 3697 09b8 122582E3 		orr	r2, r2, #75497472
 3698 09bc 002083E5 		str	r2, [r3, #0]
 251:../tp.c       **** //    Uart_Printf("\n\r Touch Screen coordinate Rang in:\n");
 252:../tp.c       **** //    Uart_Printf("   (Xmin,Ymin) is :(%04d,%04d)\n",Xmin,Ymin);	
 253:../tp.c       **** //	  Uart_Printf("   (Xmax,Ymax) is :(%04d,%04d)\n",Xmax,Ymax);	
 254:../tp.c       **** //	  Uart_Printf("\n  To use current settings. Press N/n key. ");
 255:../tp.c       **** //	  Uart_Printf("\n\n\r  Want to Set Again(Y/N)? ");	        	      
 256:../tp.c       **** //	  yn = Uart_Getch();
 257:../tp.c       ****       rI_ISPC = BIT_EINT2;              // clear pending_bit
 3699              		.loc 1 257 0
 3700 09c0 BC309FE5 		ldr	r3, .L37+4
 3701 09c4 0225A0E3 		mov	r2, #8388608
 3702 09c8 002083E5 		str	r2, [r3, #0]
 258:../tp.c       ****       rINTMSK =~(BIT_GLOBAL|BIT_EINT2);
 3703              		.loc 1 258 0
 3704 09cc AC309FE5 		ldr	r3, .L37
 3705 09d0 1225E0E3 		mvn	r2, #75497472
 3706 09d4 002083E5 		str	r2, [r3, #0]
 259:../tp.c       **** //	  if((yn == 0x59)|(yn == 0x79)|(yn == 0x4E)|(yn == 0x6E)) Uart_SendByte(yn);	  
 260:../tp.c       **** 	  if((yn == 0x59)|(yn == 0x79))
 3707              		.loc 1 260 0
 3708 09d8 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 3709 09dc 590053E3 		cmp	r3, #89
 3710 09e0 0030A013 		movne	r3, #0
 3711 09e4 0130A003 		moveq	r3, #1
 3712 09e8 FF2003E2 		and	r2, r3, #255
 3713 09ec 0D305BE5 		ldrb	r3, [fp, #-13]	@ zero_extendqisi2
 3714 09f0 790053E3 		cmp	r3, #121
 3715 09f4 0030A013 		movne	r3, #0
 3716 09f8 0130A003 		moveq	r3, #1
 3717 09fc FF3003E2 		and	r3, r3, #255
 3718 0a00 033082E1 		orr	r3, r2, r3
 3719 0a04 FF3003E2 		and	r3, r3, #255
 3720 0a08 000053E3 		cmp	r3, #0
 3721 0a0c 1700000A 		beq	.L36
 261:../tp.c       **** 	    {
 262:../tp.c       **** //	      Uart_Printf("\n\n Touch TSP's Cornor to ensure Xmax,Ymax,Xmax,Xmin");	      
 263:../tp.c       **** 
 264:../tp.c       ****          //Init X Y rectangle
 265:../tp.c       ****           Xmax = 750;    Xmin = 200;
 3722              		.loc 1 265 0
 3723 0a10 70309FE5 		ldr	r3, .L37+8
 3724 0a14 70209FE5 		ldr	r2, .L37+12
 3725 0a18 002083E5 		str	r2, [r3, #0]
 3726 0a1c 6C309FE5 		ldr	r3, .L37+16
 3727 0a20 C820A0E3 		mov	r2, #200
 3728 0a24 002083E5 		str	r2, [r3, #0]
 266:../tp.c       ****           Ymax = 620;    Ymin = 120;
 3729              		.loc 1 266 0
 3730 0a28 64309FE5 		ldr	r3, .L37+20
 3731 0a2c 9B2FA0E3 		mov	r2, #620
 3732 0a30 002083E5 		str	r2, [r3, #0]
 3733 0a34 5C309FE5 		ldr	r3, .L37+24
 3734 0a38 7820A0E3 		mov	r2, #120
 3735 0a3c 002083E5 		str	r2, [r3, #0]
 267:../tp.c       **** 
 268:../tp.c       **** 	      oneTouch = 0;
 3736              		.loc 1 268 0
 3737 0a40 54309FE5 		ldr	r3, .L37+28
 3738 0a44 0020A0E3 		mov	r2, #0
 3739 0a48 002083E5 		str	r2, [r3, #0]
 269:../tp.c       **** 	      CheckTSP = 1; // mask to check
 3740              		.loc 1 269 0
 3741 0a4c 4C309FE5 		ldr	r3, .L37+32
 3742 0a50 0120A0E3 		mov	r2, #1
 3743 0a54 002083E5 		str	r2, [r3, #0]
 270:../tp.c       **** 	      while(CheckTSP);
 3744              		.loc 1 270 0
 3745 0a58 0000A0E1 		mov	r0, r0	@ nop
 3746              	.L33:
 3747              		.loc 1 270 0 is_stmt 0 discriminator 1
 3748 0a5c 3C309FE5 		ldr	r3, .L37+32
 3749 0a60 003093E5 		ldr	r3, [r3, #0]
 3750 0a64 000053E3 		cmp	r3, #0
 3751 0a68 FBFFFF1A 		bne	.L33
 271:../tp.c       **** 	      
 272:../tp.c       **** 	    }else break;	    
 273:../tp.c       **** 	  
 274:../tp.c       **** 	}while(1);
 3752              		.loc 1 274 0 is_stmt 1
 3753 0a6c CEFFFFEA 		b	.L35
 3754              	.L36:
 275:../tp.c       **** 	
 276:../tp.c       **** }
 3755              		.loc 1 276 0
 3756 0a70 0000A0E1 		mov	r0, r0	@ nop
 3757              	.L31:
 3758 0a74 0CD04BE2 		sub	sp, fp, #12
 3759 0a78 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3760 0a7c 1EFF2FE1 		bx	lr
 3761              	.L38:
 3762              		.align	2
 3763              	.L37:
 3764 0a80 0C00E001 		.word	31457292
 3765 0a84 2400E001 		.word	31457316
 3766 0a88 00000000 		.word	Xmax
 3767 0a8c EE020000 		.word	750
 3768 0a90 00000000 		.word	Xmin
 3769 0a94 00000000 		.word	Ymax
 3770 0a98 00000000 		.word	Ymin
 3771 0a9c 00000000 		.word	oneTouch
 3772 0aa0 00000000 		.word	CheckTSP
 3773              		.cfi_endproc
 3774              	.LFE6:
 3776              		.align	2
 3778              	clamp:
 3779              	.LFB7:
 277:../tp.c       **** 
 278:../tp.c       **** /*===================================================================================
 279:../tp.c       ****  * FUNCIONES DE CALIBRACIÓN DE 5 PUNTOS
 280:../tp.c       ****  *===================================================================================*/
 281:../tp.c       **** 
 282:../tp.c       **** /*********************************************************************************************
 283:../tp.c       **** * name:     clamp
 284:../tp.c       **** * func:     Limita un valor entre mínimo y máximo
 285:../tp.c       **** *********************************************************************************************/
 286:../tp.c       **** static int clamp(int val, int min, int max)
 287:../tp.c       **** {
 3780              		.loc 1 287 0
 3781              		.cfi_startproc
 3782              		@ Function supports interworking.
 3783              		@ args = 0, pretend = 0, frame = 16
 3784              		@ frame_needed = 1, uses_anonymous_args = 0
 3785 0aa4 0DC0A0E1 		mov	ip, sp
 3786              	.LCFI14:
 3787              		.cfi_def_cfa_register 12
 3788 0aa8 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3789 0aac 04B04CE2 		sub	fp, ip, #4
 3790              		.cfi_offset 14, -8
 3791              		.cfi_offset 13, -12
 3792              		.cfi_offset 11, -16
 3793              	.LCFI15:
 3794              		.cfi_def_cfa 11, 4
 3795 0ab0 10D04DE2 		sub	sp, sp, #16
 3796 0ab4 10000BE5 		str	r0, [fp, #-16]
 3797 0ab8 14100BE5 		str	r1, [fp, #-20]
 3798 0abc 18200BE5 		str	r2, [fp, #-24]
 288:../tp.c       ****     if (val < min) return min;
 3799              		.loc 1 288 0
 3800 0ac0 10201BE5 		ldr	r2, [fp, #-16]
 3801 0ac4 14301BE5 		ldr	r3, [fp, #-20]
 3802 0ac8 030052E1 		cmp	r2, r3
 3803 0acc 010000AA 		bge	.L40
 3804              		.loc 1 288 0 is_stmt 0 discriminator 1
 3805 0ad0 14301BE5 		ldr	r3, [fp, #-20]
 3806 0ad4 060000EA 		b	.L41
 3807              	.L40:
 289:../tp.c       ****     if (val > max) return max;
 3808              		.loc 1 289 0 is_stmt 1
 3809 0ad8 10201BE5 		ldr	r2, [fp, #-16]
 3810 0adc 18301BE5 		ldr	r3, [fp, #-24]
 3811 0ae0 030052E1 		cmp	r2, r3
 3812 0ae4 010000DA 		ble	.L42
 3813              		.loc 1 289 0 is_stmt 0 discriminator 1
 3814 0ae8 18301BE5 		ldr	r3, [fp, #-24]
 3815 0aec 000000EA 		b	.L41
 3816              	.L42:
 290:../tp.c       ****     return val;
 3817              		.loc 1 290 0 is_stmt 1
 3818 0af0 10301BE5 		ldr	r3, [fp, #-16]
 3819              	.L41:
 291:../tp.c       **** }
 3820              		.loc 1 291 0
 3821 0af4 0300A0E1 		mov	r0, r3
 3822 0af8 0CD04BE2 		sub	sp, fp, #12
 3823 0afc 00689DE8 		ldmfd	sp, {fp, sp, lr}
 3824 0b00 1EFF2FE1 		bx	lr
 3825              		.cfi_endproc
 3826              	.LFE7:
 3828              		.align	2
 3830              	draw_cross:
 3831              	.LFB8:
 292:../tp.c       **** 
 293:../tp.c       **** /*********************************************************************************************
 294:../tp.c       **** * name:     draw_cross
 295:../tp.c       **** * func:     Dibuja una cruz en las coordenadas especificadas
 296:../tp.c       **** *********************************************************************************************/
 297:../tp.c       **** static void draw_cross(int x, int y)
 298:../tp.c       **** {
 3832              		.loc 1 298 0
 3833              		.cfi_startproc
 3834              		@ Function supports interworking.
 3835              		@ args = 0, pretend = 0, frame = 16
 3836              		@ frame_needed = 1, uses_anonymous_args = 0
 3837 0b04 0DC0A0E1 		mov	ip, sp
 3838              	.LCFI16:
 3839              		.cfi_def_cfa_register 12
 3840 0b08 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 3841 0b0c 04B04CE2 		sub	fp, ip, #4
 3842              		.cfi_offset 14, -8
 3843              		.cfi_offset 13, -12
 3844              		.cfi_offset 11, -16
 3845              	.LCFI17:
 3846              		.cfi_def_cfa 11, 4
 3847 0b10 10D04DE2 		sub	sp, sp, #16
 3848 0b14 18000BE5 		str	r0, [fp, #-24]
 3849 0b18 1C100BE5 		str	r1, [fp, #-28]
 299:../tp.c       ****     int i;
 300:../tp.c       ****     // Línea horizontal
 301:../tp.c       ****     for (i = -10; i <= 10; i++)
 3850              		.loc 1 301 0
 3851 0b1c 0930E0E3 		mvn	r3, #9
 3852 0b20 10300BE5 		str	r3, [fp, #-16]
 3853 0b24 500000EA 		b	.L44
 3854              	.L46:
 302:../tp.c       ****     {
 303:../tp.c       ****         if (x + i >= 0 && x + i < SCR_XSIZE)
 3855              		.loc 1 303 0
 3856 0b28 18201BE5 		ldr	r2, [fp, #-24]
 3857 0b2c 10301BE5 		ldr	r3, [fp, #-16]
 3858 0b30 033082E0 		add	r3, r2, r3
 3859 0b34 000053E3 		cmp	r3, #0
 3860 0b38 480000BA 		blt	.L45
 3861              		.loc 1 303 0 is_stmt 0 discriminator 1
 3862 0b3c 18201BE5 		ldr	r2, [fp, #-24]
 3863 0b40 10301BE5 		ldr	r3, [fp, #-16]
 3864 0b44 032082E0 		add	r2, r2, r3
 3865 0b48 7C329FE5 		ldr	r3, .L50
 3866 0b4c 030052E1 		cmp	r2, r3
 3867 0b50 420000CA 		bgt	.L45
 304:../tp.c       ****             (LCD_PutPixel(x + i, y, 0xf));
 3868              		.loc 1 304 0 is_stmt 1
 3869 0b54 1C201BE5 		ldr	r2, [fp, #-28]
 3870 0b58 0230A0E1 		mov	r3, r2
 3871 0b5c 0331A0E1 		mov	r3, r3, asl #2
 3872 0b60 023083E0 		add	r3, r3, r2
 3873 0b64 0333A0E1 		mov	r3, r3, asl #6
 3874 0b68 A32FA0E1 		mov	r2, r3, lsr #31
 3875 0b6c 033082E0 		add	r3, r2, r3
 3876 0b70 C330A0E1 		mov	r3, r3, asr #1
 3877 0b74 C32683E2 		add	r2, r3, #204472320
 3878 0b78 962C82E2 		add	r2, r2, #38400
 3879 0b7c 18101BE5 		ldr	r1, [fp, #-24]
 3880 0b80 10301BE5 		ldr	r3, [fp, #-16]
 3881 0b84 033081E0 		add	r3, r1, r3
 3882 0b88 071083E2 		add	r1, r3, #7
 3883 0b8c 000053E3 		cmp	r3, #0
 3884 0b90 0130A0B1 		movlt	r3, r1
 3885 0b94 C331A0E1 		mov	r3, r3, asr #3
 3886 0b98 0331A0E1 		mov	r3, r3, asl #2
 3887 0b9c 033082E0 		add	r3, r2, r3
 3888 0ba0 0310A0E1 		mov	r1, r3
 3889 0ba4 1C201BE5 		ldr	r2, [fp, #-28]
 3890 0ba8 0230A0E1 		mov	r3, r2
 3891 0bac 0331A0E1 		mov	r3, r3, asl #2
 3892 0bb0 023083E0 		add	r3, r3, r2
 3893 0bb4 0333A0E1 		mov	r3, r3, asl #6
 3894 0bb8 A32FA0E1 		mov	r2, r3, lsr #31
 3895 0bbc 033082E0 		add	r3, r2, r3
 3896 0bc0 C330A0E1 		mov	r3, r3, asr #1
 3897 0bc4 C32683E2 		add	r2, r3, #204472320
 3898 0bc8 962C82E2 		add	r2, r2, #38400
 3899 0bcc 18001BE5 		ldr	r0, [fp, #-24]
 3900 0bd0 10301BE5 		ldr	r3, [fp, #-16]
 3901 0bd4 033080E0 		add	r3, r0, r3
 3902 0bd8 070083E2 		add	r0, r3, #7
 3903 0bdc 000053E3 		cmp	r3, #0
 3904 0be0 0030A0B1 		movlt	r3, r0
 3905 0be4 C331A0E1 		mov	r3, r3, asr #3
 3906 0be8 0331A0E1 		mov	r3, r3, asl #2
 3907 0bec 033082E0 		add	r3, r2, r3
 3908 0bf0 000093E5 		ldr	r0, [r3, #0]
 3909 0bf4 18201BE5 		ldr	r2, [fp, #-24]
 3910 0bf8 10301BE5 		ldr	r3, [fp, #-16]
 3911 0bfc 032082E0 		add	r2, r2, r3
 3912 0c00 C23FA0E1 		mov	r3, r2, asr #31
 3913 0c04 A33EA0E1 		mov	r3, r3, lsr #29
 3914 0c08 032082E0 		add	r2, r2, r3
 3915 0c0c 072002E2 		and	r2, r2, #7
 3916 0c10 023063E0 		rsb	r3, r3, r2
 3917 0c14 0331A0E1 		mov	r3, r3, asl #2
 3918 0c18 0F22A0E3 		mov	r2, #-268435456
 3919 0c1c 3233A0E1 		mov	r3, r2, lsr r3
 3920 0c20 0330E0E1 		mvn	r3, r3
 3921 0c24 030000E0 		and	r0, r0, r3
 3922 0c28 18201BE5 		ldr	r2, [fp, #-24]
 3923 0c2c 10301BE5 		ldr	r3, [fp, #-16]
 3924 0c30 032082E0 		add	r2, r2, r3
 3925 0c34 C23FA0E1 		mov	r3, r2, asr #31
 3926 0c38 A33EA0E1 		mov	r3, r3, lsr #29
 3927 0c3c 032082E0 		add	r2, r2, r3
 3928 0c40 072002E2 		and	r2, r2, #7
 3929 0c44 023063E0 		rsb	r3, r3, r2
 3930 0c48 073063E2 		rsb	r3, r3, #7
 3931 0c4c 0331A0E1 		mov	r3, r3, asl #2
 3932 0c50 0F20A0E3 		mov	r2, #15
 3933 0c54 1233A0E1 		mov	r3, r2, asl r3
 3934 0c58 033080E1 		orr	r3, r0, r3
 3935 0c5c 003081E5 		str	r3, [r1, #0]
 3936              	.L45:
 301:../tp.c       ****     for (i = -10; i <= 10; i++)
 3937              		.loc 1 301 0
 3938 0c60 10301BE5 		ldr	r3, [fp, #-16]
 3939 0c64 013083E2 		add	r3, r3, #1
 3940 0c68 10300BE5 		str	r3, [fp, #-16]
 3941              	.L44:
 301:../tp.c       ****     for (i = -10; i <= 10; i++)
 3942              		.loc 1 301 0 is_stmt 0 discriminator 1
 3943 0c6c 10301BE5 		ldr	r3, [fp, #-16]
 3944 0c70 0A0053E3 		cmp	r3, #10
 3945 0c74 ABFFFFDA 		ble	.L46
 305:../tp.c       ****     }
 306:../tp.c       ****     // Línea vertical
 307:../tp.c       ****     for (i = -10; i <= 10; i++)
 3946              		.loc 1 307 0 is_stmt 1
 3947 0c78 0930E0E3 		mvn	r3, #9
 3948 0c7c 10300BE5 		str	r3, [fp, #-16]
 3949 0c80 4B0000EA 		b	.L47
 3950              	.L49:
 308:../tp.c       ****     {
 309:../tp.c       ****         if (y + i >= 0 && y + i < SCR_YSIZE)
 3951              		.loc 1 309 0
 3952 0c84 1C201BE5 		ldr	r2, [fp, #-28]
 3953 0c88 10301BE5 		ldr	r3, [fp, #-16]
 3954 0c8c 033082E0 		add	r3, r2, r3
 3955 0c90 000053E3 		cmp	r3, #0
 3956 0c94 430000BA 		blt	.L48
 3957              		.loc 1 309 0 is_stmt 0 discriminator 1
 3958 0c98 1C201BE5 		ldr	r2, [fp, #-28]
 3959 0c9c 10301BE5 		ldr	r3, [fp, #-16]
 3960 0ca0 033082E0 		add	r3, r2, r3
 3961 0ca4 EF0053E3 		cmp	r3, #239
 3962 0ca8 3E0000CA 		bgt	.L48
 310:../tp.c       ****             (LCD_PutPixel(x, y + i, 0xf));
 3963              		.loc 1 310 0 is_stmt 1
 3964 0cac 1C201BE5 		ldr	r2, [fp, #-28]
 3965 0cb0 10301BE5 		ldr	r3, [fp, #-16]
 3966 0cb4 032082E0 		add	r2, r2, r3
 3967 0cb8 0230A0E1 		mov	r3, r2
 3968 0cbc 0331A0E1 		mov	r3, r3, asl #2
 3969 0cc0 023083E0 		add	r3, r3, r2
 3970 0cc4 0333A0E1 		mov	r3, r3, asl #6
 3971 0cc8 A32FA0E1 		mov	r2, r3, lsr #31
 3972 0ccc 033082E0 		add	r3, r2, r3
 3973 0cd0 C330A0E1 		mov	r3, r3, asr #1
 3974 0cd4 C32683E2 		add	r2, r3, #204472320
 3975 0cd8 962C82E2 		add	r2, r2, #38400
 3976 0cdc 18301BE5 		ldr	r3, [fp, #-24]
 3977 0ce0 071083E2 		add	r1, r3, #7
 3978 0ce4 000053E3 		cmp	r3, #0
 3979 0ce8 0130A0B1 		movlt	r3, r1
 3980 0cec C331A0E1 		mov	r3, r3, asr #3
 3981 0cf0 0331A0E1 		mov	r3, r3, asl #2
 3982 0cf4 033082E0 		add	r3, r2, r3
 3983 0cf8 0310A0E1 		mov	r1, r3
 3984 0cfc 1C201BE5 		ldr	r2, [fp, #-28]
 3985 0d00 10301BE5 		ldr	r3, [fp, #-16]
 3986 0d04 032082E0 		add	r2, r2, r3
 3987 0d08 0230A0E1 		mov	r3, r2
 3988 0d0c 0331A0E1 		mov	r3, r3, asl #2
 3989 0d10 023083E0 		add	r3, r3, r2
 3990 0d14 0333A0E1 		mov	r3, r3, asl #6
 3991 0d18 A32FA0E1 		mov	r2, r3, lsr #31
 3992 0d1c 033082E0 		add	r3, r2, r3
 3993 0d20 C330A0E1 		mov	r3, r3, asr #1
 3994 0d24 C32683E2 		add	r2, r3, #204472320
 3995 0d28 962C82E2 		add	r2, r2, #38400
 3996 0d2c 18301BE5 		ldr	r3, [fp, #-24]
 3997 0d30 070083E2 		add	r0, r3, #7
 3998 0d34 000053E3 		cmp	r3, #0
 3999 0d38 0030A0B1 		movlt	r3, r0
 4000 0d3c C331A0E1 		mov	r3, r3, asr #3
 4001 0d40 0331A0E1 		mov	r3, r3, asl #2
 4002 0d44 033082E0 		add	r3, r2, r3
 4003 0d48 000093E5 		ldr	r0, [r3, #0]
 4004 0d4c 18201BE5 		ldr	r2, [fp, #-24]
 4005 0d50 C23FA0E1 		mov	r3, r2, asr #31
 4006 0d54 A33EA0E1 		mov	r3, r3, lsr #29
 4007 0d58 032082E0 		add	r2, r2, r3
 4008 0d5c 072002E2 		and	r2, r2, #7
 4009 0d60 023063E0 		rsb	r3, r3, r2
 4010 0d64 0331A0E1 		mov	r3, r3, asl #2
 4011 0d68 0F22A0E3 		mov	r2, #-268435456
 4012 0d6c 3233A0E1 		mov	r3, r2, lsr r3
 4013 0d70 0330E0E1 		mvn	r3, r3
 4014 0d74 030000E0 		and	r0, r0, r3
 4015 0d78 18201BE5 		ldr	r2, [fp, #-24]
 4016 0d7c C23FA0E1 		mov	r3, r2, asr #31
 4017 0d80 A33EA0E1 		mov	r3, r3, lsr #29
 4018 0d84 032082E0 		add	r2, r2, r3
 4019 0d88 072002E2 		and	r2, r2, #7
 4020 0d8c 023063E0 		rsb	r3, r3, r2
 4021 0d90 073063E2 		rsb	r3, r3, #7
 4022 0d94 0331A0E1 		mov	r3, r3, asl #2
 4023 0d98 0F20A0E3 		mov	r2, #15
 4024 0d9c 1233A0E1 		mov	r3, r2, asl r3
 4025 0da0 033080E1 		orr	r3, r0, r3
 4026 0da4 003081E5 		str	r3, [r1, #0]
 4027              	.L48:
 307:../tp.c       ****     for (i = -10; i <= 10; i++)
 4028              		.loc 1 307 0
 4029 0da8 10301BE5 		ldr	r3, [fp, #-16]
 4030 0dac 013083E2 		add	r3, r3, #1
 4031 0db0 10300BE5 		str	r3, [fp, #-16]
 4032              	.L47:
 307:../tp.c       ****     for (i = -10; i <= 10; i++)
 4033              		.loc 1 307 0 is_stmt 0 discriminator 1
 4034 0db4 10301BE5 		ldr	r3, [fp, #-16]
 4035 0db8 0A0053E3 		cmp	r3, #10
 4036 0dbc B0FFFFDA 		ble	.L49
 311:../tp.c       ****     }
 312:../tp.c       **** }
 4037              		.loc 1 312 0 is_stmt 1
 4038 0dc0 0CD04BE2 		sub	sp, fp, #12
 4039 0dc4 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4040 0dc8 1EFF2FE1 		bx	lr
 4041              	.L51:
 4042              		.align	2
 4043              	.L50:
 4044 0dcc 3F010000 		.word	319
 4045              		.cfi_endproc
 4046              	.LFE8:
 4048              		.align	2
 4049              		.global	report_touch_data
 4051              	report_touch_data:
 4052              	.LFB9:
 313:../tp.c       **** 
 314:../tp.c       **** /*********************************************************************************************
 315:../tp.c       **** * name:     report_touch_data
 316:../tp.c       **** * func:     Llamada desde TSInt() para reportar coordenadas crudas
 317:../tp.c       **** *********************************************************************************************/
 318:../tp.c       **** void report_touch_data(int x, int y)
 319:../tp.c       **** {
 4053              		.loc 1 319 0
 4054              		.cfi_startproc
 4055              		@ Function supports interworking.
 4056              		@ args = 0, pretend = 0, frame = 8
 4057              		@ frame_needed = 1, uses_anonymous_args = 0
 4058 0dd0 0DC0A0E1 		mov	ip, sp
 4059              	.LCFI18:
 4060              		.cfi_def_cfa_register 12
 4061 0dd4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4062 0dd8 04B04CE2 		sub	fp, ip, #4
 4063              		.cfi_offset 14, -8
 4064              		.cfi_offset 13, -12
 4065              		.cfi_offset 11, -16
 4066              	.LCFI19:
 4067              		.cfi_def_cfa 11, 4
 4068 0ddc 08D04DE2 		sub	sp, sp, #8
 4069 0de0 10000BE5 		str	r0, [fp, #-16]
 4070 0de4 14100BE5 		str	r1, [fp, #-20]
 320:../tp.c       ****     if (g_ts_ready == 0)
 4071              		.loc 1 320 0
 4072 0de8 38309FE5 		ldr	r3, .L54
 4073 0dec 003093E5 		ldr	r3, [r3, #0]
 4074 0df0 000053E3 		cmp	r3, #0
 4075 0df4 0800001A 		bne	.L52
 321:../tp.c       ****     {
 322:../tp.c       ****         g_ts_raw_x = x;
 4076              		.loc 1 322 0
 4077 0df8 2C309FE5 		ldr	r3, .L54+4
 4078 0dfc 10201BE5 		ldr	r2, [fp, #-16]
 4079 0e00 002083E5 		str	r2, [r3, #0]
 323:../tp.c       ****         g_ts_raw_y = y;
 4080              		.loc 1 323 0
 4081 0e04 24309FE5 		ldr	r3, .L54+8
 4082 0e08 14201BE5 		ldr	r2, [fp, #-20]
 4083 0e0c 002083E5 		str	r2, [r3, #0]
 324:../tp.c       ****         g_ts_ready = 1;
 4084              		.loc 1 324 0
 4085 0e10 10309FE5 		ldr	r3, .L54
 4086 0e14 0120A0E3 		mov	r2, #1
 4087 0e18 002083E5 		str	r2, [r3, #0]
 4088              	.L52:
 325:../tp.c       ****     }
 326:../tp.c       **** }
 4089              		.loc 1 326 0
 4090 0e1c 0CD04BE2 		sub	sp, fp, #12
 4091 0e20 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4092 0e24 1EFF2FE1 		bx	lr
 4093              	.L55:
 4094              		.align	2
 4095              	.L54:
 4096 0e28 1C000000 		.word	g_ts_ready
 4097 0e2c 20000000 		.word	g_ts_raw_x
 4098 0e30 24000000 		.word	g_ts_raw_y
 4099              		.cfi_endproc
 4100              	.LFE9:
 4102              		.align	2
 4104              	ts_wait_for_touch:
 4105              	.LFB10:
 327:../tp.c       **** 
 328:../tp.c       **** /*********************************************************************************************
 329:../tp.c       **** * name:     ts_wait_for_touch
 330:../tp.c       **** * func:     Espera hasta detectar un toque
 331:../tp.c       **** *********************************************************************************************/
 332:../tp.c       **** static void ts_wait_for_touch(void)
 333:../tp.c       **** {
 4106              		.loc 1 333 0
 4107              		.cfi_startproc
 4108              		@ Function supports interworking.
 4109              		@ args = 0, pretend = 0, frame = 0
 4110              		@ frame_needed = 1, uses_anonymous_args = 0
 4111 0e34 0DC0A0E1 		mov	ip, sp
 4112              	.LCFI20:
 4113              		.cfi_def_cfa_register 12
 4114 0e38 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4115 0e3c 04B04CE2 		sub	fp, ip, #4
 4116              		.cfi_offset 14, -8
 4117              		.cfi_offset 13, -12
 4118              		.cfi_offset 11, -16
 4119              	.LCFI21:
 4120              		.cfi_def_cfa 11, 4
 334:../tp.c       ****     g_ts_ready = 0;
 4121              		.loc 1 334 0
 4122 0e40 24309FE5 		ldr	r3, .L58
 4123 0e44 0020A0E3 		mov	r2, #0
 4124 0e48 002083E5 		str	r2, [r3, #0]
 335:../tp.c       ****     while (g_ts_ready == 0)
 4125              		.loc 1 335 0
 4126 0e4c 0000A0E1 		mov	r0, r0	@ nop
 4127              	.L57:
 4128              		.loc 1 335 0 is_stmt 0 discriminator 1
 4129 0e50 14309FE5 		ldr	r3, .L58
 4130 0e54 003093E5 		ldr	r3, [r3, #0]
 4131 0e58 000053E3 		cmp	r3, #0
 4132 0e5c FBFFFF0A 		beq	.L57
 336:../tp.c       ****     {
 337:../tp.c       ****         // Esperar interrupción
 338:../tp.c       ****     }
 339:../tp.c       **** }
 4133              		.loc 1 339 0 is_stmt 1
 4134 0e60 0CD04BE2 		sub	sp, fp, #12
 4135 0e64 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4136 0e68 1EFF2FE1 		bx	lr
 4137              	.L59:
 4138              		.align	2
 4139              	.L58:
 4140 0e6c 1C000000 		.word	g_ts_ready
 4141              		.cfi_endproc
 4142              	.LFE10:
 4144              		.align	2
 4146              	ts_read_raw:
 4147              	.LFB11:
 340:../tp.c       **** 
 341:../tp.c       **** /*********************************************************************************************
 342:../tp.c       **** * name:     ts_read_raw
 343:../tp.c       **** * func:     Lee coordenadas crudas del ADC (bloqueante)
 344:../tp.c       **** *********************************************************************************************/
 345:../tp.c       **** static void ts_read_raw(int *xr, int *yr)
 346:../tp.c       **** {
 4148              		.loc 1 346 0
 4149              		.cfi_startproc
 4150              		@ Function supports interworking.
 4151              		@ args = 0, pretend = 0, frame = 8
 4152              		@ frame_needed = 1, uses_anonymous_args = 0
 4153 0e70 0DC0A0E1 		mov	ip, sp
 4154              	.LCFI22:
 4155              		.cfi_def_cfa_register 12
 4156 0e74 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4157 0e78 04B04CE2 		sub	fp, ip, #4
 4158              		.cfi_offset 14, -8
 4159              		.cfi_offset 13, -12
 4160              		.cfi_offset 11, -16
 4161              	.LCFI23:
 4162              		.cfi_def_cfa 11, 4
 4163 0e7c 08D04DE2 		sub	sp, sp, #8
 4164 0e80 10000BE5 		str	r0, [fp, #-16]
 4165 0e84 14100BE5 		str	r1, [fp, #-20]
 347:../tp.c       ****     ts_wait_for_touch();
 4166              		.loc 1 347 0
 4167 0e88 E9FFFFEB 		bl	ts_wait_for_touch
 348:../tp.c       ****     *xr = g_ts_raw_x;
 4168              		.loc 1 348 0
 4169 0e8c 24309FE5 		ldr	r3, .L61
 4170 0e90 002093E5 		ldr	r2, [r3, #0]
 4171 0e94 10301BE5 		ldr	r3, [fp, #-16]
 4172 0e98 002083E5 		str	r2, [r3, #0]
 349:../tp.c       ****     *yr = g_ts_raw_y;
 4173              		.loc 1 349 0
 4174 0e9c 18309FE5 		ldr	r3, .L61+4
 4175 0ea0 002093E5 		ldr	r2, [r3, #0]
 4176 0ea4 14301BE5 		ldr	r3, [fp, #-20]
 4177 0ea8 002083E5 		str	r2, [r3, #0]
 350:../tp.c       **** }
 4178              		.loc 1 350 0
 4179 0eac 0CD04BE2 		sub	sp, fp, #12
 4180 0eb0 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4181 0eb4 1EFF2FE1 		bx	lr
 4182              	.L62:
 4183              		.align	2
 4184              	.L61:
 4185 0eb8 20000000 		.word	g_ts_raw_x
 4186 0ebc 24000000 		.word	g_ts_raw_y
 4187              		.cfi_endproc
 4188              	.LFE11:
 4190              		.align	2
 4192              	get_cal_point:
 4193              	.LFB12:
 351:../tp.c       **** 
 352:../tp.c       **** /*********************************************************************************************
 353:../tp.c       **** * name:     get_cal_point
 354:../tp.c       **** * func:     Muestra cruz, espera 5 toques y captura promedio de coordenadas crudas
 355:../tp.c       **** *********************************************************************************************/
 356:../tp.c       **** static void get_cal_point(int lcd_x, int lcd_y, int *ts_x, int *ts_y)
 357:../tp.c       **** {
 4194              		.loc 1 357 0
 4195              		.cfi_startproc
 4196              		@ Function supports interworking.
 4197              		@ args = 0, pretend = 0, frame = 40
 4198              		@ frame_needed = 1, uses_anonymous_args = 0
 4199 0ec0 0DC0A0E1 		mov	ip, sp
 4200              	.LCFI24:
 4201              		.cfi_def_cfa_register 12
 4202 0ec4 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 4203 0ec8 04B04CE2 		sub	fp, ip, #4
 4204              		.cfi_offset 14, -8
 4205              		.cfi_offset 13, -12
 4206              		.cfi_offset 11, -16
 4207              	.LCFI25:
 4208              		.cfi_def_cfa 11, 4
 4209 0ecc 28D04DE2 		sub	sp, sp, #40
 4210 0ed0 28000BE5 		str	r0, [fp, #-40]
 4211 0ed4 2C100BE5 		str	r1, [fp, #-44]
 4212 0ed8 30200BE5 		str	r2, [fp, #-48]
 4213 0edc 34300BE5 		str	r3, [fp, #-52]
 358:../tp.c       ****     int i;
 359:../tp.c       ****     int sum_x = 0, sum_y = 0;
 4214              		.loc 1 359 0
 4215 0ee0 0030A0E3 		mov	r3, #0
 4216 0ee4 14300BE5 		str	r3, [fp, #-20]
 4217 0ee8 0030A0E3 		mov	r3, #0
 4218 0eec 18300BE5 		str	r3, [fp, #-24]
 360:../tp.c       ****     int temp_x, temp_y;
 361:../tp.c       ****     
 362:../tp.c       ****     draw_cross(lcd_x, lcd_y);
 4219              		.loc 1 362 0
 4220 0ef0 28001BE5 		ldr	r0, [fp, #-40]
 4221 0ef4 2C101BE5 		ldr	r1, [fp, #-44]
 4222 0ef8 01FFFFEB 		bl	draw_cross
 363:../tp.c       ****     Lcd_Dma_Trans();
 4223              		.loc 1 363 0
 4224 0efc FEFFFFEB 		bl	Lcd_Dma_Trans
 364:../tp.c       ****     Delay(50);
 4225              		.loc 1 364 0
 4226 0f00 3200A0E3 		mov	r0, #50
 4227 0f04 FEFFFFEB 		bl	Delay
 365:../tp.c       ****     
 366:../tp.c       ****     // Tomar 5 muestras y promediar
 367:../tp.c       ****     for (i = 0; i < 5; i++)
 4228              		.loc 1 367 0
 4229 0f08 0030A0E3 		mov	r3, #0
 4230 0f0c 10300BE5 		str	r3, [fp, #-16]
 4231 0f10 110000EA 		b	.L64
 4232              	.L65:
 368:../tp.c       ****     {
 369:../tp.c       ****         ts_read_raw(&temp_x, &temp_y);
 4233              		.loc 1 369 0 discriminator 2
 4234 0f14 1C204BE2 		sub	r2, fp, #28
 4235 0f18 20304BE2 		sub	r3, fp, #32
 4236 0f1c 0200A0E1 		mov	r0, r2
 4237 0f20 0310A0E1 		mov	r1, r3
 4238 0f24 D1FFFFEB 		bl	ts_read_raw
 370:../tp.c       ****         sum_x += temp_x;
 4239              		.loc 1 370 0 discriminator 2
 4240 0f28 1C301BE5 		ldr	r3, [fp, #-28]
 4241 0f2c 14201BE5 		ldr	r2, [fp, #-20]
 4242 0f30 033082E0 		add	r3, r2, r3
 4243 0f34 14300BE5 		str	r3, [fp, #-20]
 371:../tp.c       ****         sum_y += temp_y;
 4244              		.loc 1 371 0 discriminator 2
 4245 0f38 20301BE5 		ldr	r3, [fp, #-32]
 4246 0f3c 18201BE5 		ldr	r2, [fp, #-24]
 4247 0f40 033082E0 		add	r3, r2, r3
 4248 0f44 18300BE5 		str	r3, [fp, #-24]
 372:../tp.c       ****         Delay(20);  // Pequeña pausa entre muestras
 4249              		.loc 1 372 0 discriminator 2
 4250 0f48 1400A0E3 		mov	r0, #20
 4251 0f4c FEFFFFEB 		bl	Delay
 367:../tp.c       ****     for (i = 0; i < 5; i++)
 4252              		.loc 1 367 0 discriminator 2
 4253 0f50 10301BE5 		ldr	r3, [fp, #-16]
 4254 0f54 013083E2 		add	r3, r3, #1
 4255 0f58 10300BE5 		str	r3, [fp, #-16]
 4256              	.L64:
 367:../tp.c       ****     for (i = 0; i < 5; i++)
 4257              		.loc 1 367 0 is_stmt 0 discriminator 1
 4258 0f5c 10301BE5 		ldr	r3, [fp, #-16]
 4259 0f60 040053E3 		cmp	r3, #4
 4260 0f64 EAFFFFDA 		ble	.L65
 373:../tp.c       ****     }
 374:../tp.c       ****     
 375:../tp.c       ****     // Calcular promedio
 376:../tp.c       ****     *ts_x = sum_x / 5;
 4261              		.loc 1 376 0 is_stmt 1
 4262 0f68 14301BE5 		ldr	r3, [fp, #-20]
 4263 0f6c 58209FE5 		ldr	r2, .L66
 4264 0f70 9312C2E0 		smull	r1, r2, r3, r2
 4265 0f74 C220A0E1 		mov	r2, r2, asr #1
 4266 0f78 C33FA0E1 		mov	r3, r3, asr #31
 4267 0f7c 022063E0 		rsb	r2, r3, r2
 4268 0f80 30301BE5 		ldr	r3, [fp, #-48]
 4269 0f84 002083E5 		str	r2, [r3, #0]
 377:../tp.c       ****     *ts_y = sum_y / 5;
 4270              		.loc 1 377 0
 4271 0f88 18301BE5 		ldr	r3, [fp, #-24]
 4272 0f8c 38209FE5 		ldr	r2, .L66
 4273 0f90 9312C2E0 		smull	r1, r2, r3, r2
 4274 0f94 C220A0E1 		mov	r2, r2, asr #1
 4275 0f98 C33FA0E1 		mov	r3, r3, asr #31
 4276 0f9c 022063E0 		rsb	r2, r3, r2
 4277 0fa0 34301BE5 		ldr	r3, [fp, #-52]
 4278 0fa4 002083E5 		str	r2, [r3, #0]
 378:../tp.c       ****     
 379:../tp.c       ****     Delay(30);
 4279              		.loc 1 379 0
 4280 0fa8 1E00A0E3 		mov	r0, #30
 4281 0fac FEFFFFEB 		bl	Delay
 380:../tp.c       ****     draw_cross(lcd_x, lcd_y);
 4282              		.loc 1 380 0
 4283 0fb0 28001BE5 		ldr	r0, [fp, #-40]
 4284 0fb4 2C101BE5 		ldr	r1, [fp, #-44]
 4285 0fb8 D1FEFFEB 		bl	draw_cross
 381:../tp.c       ****     Lcd_Dma_Trans();
 4286              		.loc 1 381 0
 4287 0fbc FEFFFFEB 		bl	Lcd_Dma_Trans
 382:../tp.c       **** }
 4288              		.loc 1 382 0
 4289 0fc0 0CD04BE2 		sub	sp, fp, #12
 4290 0fc4 00689DE8 		ldmfd	sp, {fp, sp, lr}
 4291 0fc8 1EFF2FE1 		bx	lr
 4292              	.L67:
 4293              		.align	2
 4294              	.L66:
 4295 0fcc 67666666 		.word	1717986919
 4296              		.cfi_endproc
 4297              	.LFE12:
 4299              		.section	.rodata
 4300 003e 0000     		.align	2
 4301              	.LC16:
 4302 0040 43616C69 		.ascii	"Calibracion 5pts\000"
 4302      62726163 
 4302      696F6E20 
 4302      35707473 
 4302      00
 4303 0051 000000   		.align	2
 4304              	.LC17:
 4305 0054 546F6361 		.ascii	"Toca punto A\000"
 4305      2070756E 
 4305      746F2041 
 4305      00
 4306 0061 000000   		.align	2
 4307              	.LC18:
 4308 0064 546F6361 		.ascii	"Toca punto B\000"
 4308      2070756E 
 4308      746F2042 
 4308      00
 4309 0071 000000   		.align	2
 4310              	.LC19:
 4311 0074 546F6361 		.ascii	"Toca punto C\000"
 4311      2070756E 
 4311      746F2043 
 4311      00
 4312 0081 000000   		.align	2
 4313              	.LC20:
 4314 0084 546F6361 		.ascii	"Toca punto D\000"
 4314      2070756E 
 4314      746F2044 
 4314      00
 4315 0091 000000   		.align	2
 4316              	.LC21:
 4317 0094 546F6361 		.ascii	"Toca centro E\000"
 4317      2063656E 
 4317      74726F20 
 4317      4500
 4318              		.global	__aeabi_ldivmod
 4319 00a2 0000     		.align	2
 4320              	.LC22:
 4321 00a4 3D3D3D20 		.ascii	"=== CALIBRACION OK ===\000"
 4321      43414C49 
 4321      42524143 
 4321      494F4E20 
 4321      4F4B203D 
 4322 00bb 00       		.align	2
 4323              	.LC23:
 4324 00bc 53776170 		.ascii	"Swap XY: SI\000"
 4324      2058593A 
 4324      20534900 
 4325              		.align	2
 4326              	.LC24:
 4327 00c8 53776170 		.ascii	"Swap XY: NO\000"
 4327      2058593A 
 4327      204E4F00 
 4328              		.align	2
 4329              	.LC25:
 4330 00d4 50756E74 		.ascii	"Puntos capturados OK\000"
 4330      6F732063 
 4330      61707475 
 4330      7261646F 
 4330      73204F4B 
 4331 00e9 000000   		.align	2
 4332              	.LC26:
 4333 00ec 46616374 		.ascii	"Factores calculados\000"
 4333      6F726573 
 4333      2063616C 
 4333      63756C61 
 4333      646F7300 
 4334              		.align	2
 4335              	.LC27:
 4336 0100 6B783A20 		.ascii	"kx: POSITIVO\000"
 4336      504F5349 
 4336      5449564F 
 4336      00
 4337 010d 000000   		.align	2
 4338              	.LC28:
 4339 0110 6B783A20 		.ascii	"kx: NEGATIVO\000"
 4339      4E454741 
 4339      5449564F 
 4339      00
 4340 011d 000000   		.align	2
 4341              	.LC29:
 4342 0120 6B793A20 		.ascii	"ky: POSITIVO\000"
 4342      504F5349 
 4342      5449564F 
 4342      00
 4343 012d 000000   		.align	2
 4344              	.LC30:
 4345 0130 6B793A20 		.ascii	"ky: NEGATIVO\000"
 4345      4E454741 
 4345      5449564F 
 4345      00
 4346 013d 000000   		.align	2
 4347              	.LC31:
 4348 0140 5B546F63 		.ascii	"[Toca para continuar]\000"
 4348      61207061 
 4348      72612063 
 4348      6F6E7469 
 4348      6E756172 
 4349              		.text
 4350              		.align	2
 4351              		.global	ts_calibrate_5pt
 4353              	ts_calibrate_5pt:
 4354              	.LFB13:
 383:../tp.c       **** 
 384:../tp.c       **** /*********************************************************************************************
 385:../tp.c       **** * name:     ts_calibrate_5pt
 386:../tp.c       **** * func:     Calibración de 5 puntos del touchscreen
 387:../tp.c       **** * para:     XRES - resolución horizontal, YRES - vertical, M - margen
 388:../tp.c       **** * comment:  Implementa método con detección swap XY y escalas con signo (fixed-point 16.16)
 389:../tp.c       **** *********************************************************************************************/
 390:../tp.c       **** void ts_calibrate_5pt(int XRES, int YRES, int M)
 391:../tp.c       **** {
 4355              		.loc 1 391 0
 4356              		.cfi_startproc
 4357              		@ Function supports interworking.
 4358              		@ args = 0, pretend = 0, frame = 144
 4359              		@ frame_needed = 1, uses_anonymous_args = 0
 4360 0fd0 0DC0A0E1 		mov	ip, sp
 4361              	.LCFI26:
 4362              		.cfi_def_cfa_register 12
 4363 0fd4 10D82DE9 		stmfd	sp!, {r4, fp, ip, lr, pc}
 4364 0fd8 04B04CE2 		sub	fp, ip, #4
 4365              		.cfi_offset 14, -8
 4366              		.cfi_offset 13, -12
 4367              		.cfi_offset 11, -16
 4368              		.cfi_offset 4, -20
 4369              	.LCFI27:
 4370              		.cfi_def_cfa 11, 4
 4371 0fdc 94D04DE2 		sub	sp, sp, #148
 4372 0fe0 98000BE5 		str	r0, [fp, #-152]
 4373 0fe4 9C100BE5 		str	r1, [fp, #-156]
 4374 0fe8 A0200BE5 		str	r2, [fp, #-160]
 392:../tp.c       ****     int A_lcd_x, A_lcd_y, A_ts_x, A_ts_y;
 393:../tp.c       ****     int B_lcd_x, B_lcd_y, B_ts_x, B_ts_y;
 394:../tp.c       ****     int C_lcd_x, C_lcd_y, C_ts_x, C_ts_y;
 395:../tp.c       ****     int D_lcd_x, D_lcd_y, D_ts_x, D_ts_y;
 396:../tp.c       ****     int E_lcd_x, E_lcd_y, E_ts_x, E_ts_y;
 397:../tp.c       ****     
 398:../tp.c       ****     int dx, dy;
 399:../tp.c       ****     int lcd_s, lcd_d;
 400:../tp.c       ****     int ts_s1, ts_s2, ts_d1, ts_d2;
 401:../tp.c       ****     long long temp;
 402:../tp.c       ****     
 403:../tp.c       ****     Lcd_Clr();
 4375              		.loc 1 403 0
 4376 0fec FEFFFFEB 		bl	Lcd_Clr
 404:../tp.c       ****     Lcd_Active_Clr();
 4377              		.loc 1 404 0
 4378 0ff0 FEFFFFEB 		bl	Lcd_Active_Clr
 405:../tp.c       ****     Lcd_DspAscII8x16(60, 110, BLACK, (unsigned char *)"Calibracion 5pts");
 4379              		.loc 1 405 0
 4380 0ff4 3C00A0E3 		mov	r0, #60
 4381 0ff8 6E10A0E3 		mov	r1, #110
 4382 0ffc 0F20A0E3 		mov	r2, #15
 4383 1000 88359FE5 		ldr	r3, .L79
 4384 1004 FEFFFFEB 		bl	Lcd_DspAscII8x16
 406:../tp.c       ****     Lcd_Dma_Trans();
 4385              		.loc 1 406 0
 4386 1008 FEFFFFEB 		bl	Lcd_Dma_Trans
 407:../tp.c       ****     Delay(100);
 4387              		.loc 1 407 0
 4388 100c 6400A0E3 		mov	r0, #100
 4389 1010 FEFFFFEB 		bl	Delay
 408:../tp.c       ****     
 409:../tp.c       ****     Lcd_Clr();
 4390              		.loc 1 409 0
 4391 1014 FEFFFFEB 		bl	Lcd_Clr
 410:../tp.c       ****     Lcd_Dma_Trans();
 4392              		.loc 1 410 0
 4393 1018 FEFFFFEB 		bl	Lcd_Dma_Trans
 411:../tp.c       ****     
 412:../tp.c       ****     // Definir posiciones LCD de los 5 puntos
 413:../tp.c       ****     A_lcd_x = M;            A_lcd_y = M;
 4394              		.loc 1 413 0
 4395 101c A0301BE5 		ldr	r3, [fp, #-160]
 4396 1020 20300BE5 		str	r3, [fp, #-32]
 4397 1024 A0301BE5 		ldr	r3, [fp, #-160]
 4398 1028 24300BE5 		str	r3, [fp, #-36]
 414:../tp.c       ****     B_lcd_x = XRES - M;     B_lcd_y = M;
 4399              		.loc 1 414 0
 4400 102c 98201BE5 		ldr	r2, [fp, #-152]
 4401 1030 A0301BE5 		ldr	r3, [fp, #-160]
 4402 1034 023063E0 		rsb	r3, r3, r2
 4403 1038 28300BE5 		str	r3, [fp, #-40]
 4404 103c A0301BE5 		ldr	r3, [fp, #-160]
 4405 1040 2C300BE5 		str	r3, [fp, #-44]
 415:../tp.c       ****     C_lcd_x = XRES - M;     C_lcd_y = YRES - M;
 4406              		.loc 1 415 0
 4407 1044 98201BE5 		ldr	r2, [fp, #-152]
 4408 1048 A0301BE5 		ldr	r3, [fp, #-160]
 4409 104c 023063E0 		rsb	r3, r3, r2
 4410 1050 30300BE5 		str	r3, [fp, #-48]
 4411 1054 9C201BE5 		ldr	r2, [fp, #-156]
 4412 1058 A0301BE5 		ldr	r3, [fp, #-160]
 4413 105c 023063E0 		rsb	r3, r3, r2
 4414 1060 34300BE5 		str	r3, [fp, #-52]
 416:../tp.c       ****     D_lcd_x = M;            D_lcd_y = YRES - M;
 4415              		.loc 1 416 0
 4416 1064 A0301BE5 		ldr	r3, [fp, #-160]
 4417 1068 38300BE5 		str	r3, [fp, #-56]
 4418 106c 9C201BE5 		ldr	r2, [fp, #-156]
 4419 1070 A0301BE5 		ldr	r3, [fp, #-160]
 4420 1074 023063E0 		rsb	r3, r3, r2
 4421 1078 3C300BE5 		str	r3, [fp, #-60]
 417:../tp.c       ****     E_lcd_x = XRES / 2;     E_lcd_y = YRES / 2;
 4422              		.loc 1 417 0
 4423 107c 98301BE5 		ldr	r3, [fp, #-152]
 4424 1080 A32FA0E1 		mov	r2, r3, lsr #31
 4425 1084 033082E0 		add	r3, r2, r3
 4426 1088 C330A0E1 		mov	r3, r3, asr #1
 4427 108c 40300BE5 		str	r3, [fp, #-64]
 4428 1090 9C301BE5 		ldr	r3, [fp, #-156]
 4429 1094 A32FA0E1 		mov	r2, r3, lsr #31
 4430 1098 033082E0 		add	r3, r2, r3
 4431 109c C330A0E1 		mov	r3, r3, asr #1
 4432 10a0 44300BE5 		str	r3, [fp, #-68]
 418:../tp.c       ****     
 419:../tp.c       ****     // Capturar punto A
 420:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto A");
 4433              		.loc 1 420 0
 4434 10a4 0A00A0E3 		mov	r0, #10
 4435 10a8 0A10A0E3 		mov	r1, #10
 4436 10ac 0F20A0E3 		mov	r2, #15
 4437 10b0 DC349FE5 		ldr	r3, .L79+4
 4438 10b4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 421:../tp.c       ****     Lcd_Dma_Trans();
 4439              		.loc 1 421 0
 4440 10b8 FEFFFFEB 		bl	Lcd_Dma_Trans
 422:../tp.c       ****     get_cal_point(A_lcd_x, A_lcd_y, &A_ts_x, &A_ts_y);
 4441              		.loc 1 422 0
 4442 10bc 70204BE2 		sub	r2, fp, #112
 4443 10c0 74304BE2 		sub	r3, fp, #116
 4444 10c4 20001BE5 		ldr	r0, [fp, #-32]
 4445 10c8 24101BE5 		ldr	r1, [fp, #-36]
 4446 10cc 7BFFFFEB 		bl	get_cal_point
 423:../tp.c       ****     
 424:../tp.c       ****     // Capturar punto B
 425:../tp.c       ****     Lcd_Clr();
 4447              		.loc 1 425 0
 4448 10d0 FEFFFFEB 		bl	Lcd_Clr
 426:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto B");
 4449              		.loc 1 426 0
 4450 10d4 0A00A0E3 		mov	r0, #10
 4451 10d8 0A10A0E3 		mov	r1, #10
 4452 10dc 0F20A0E3 		mov	r2, #15
 4453 10e0 B0349FE5 		ldr	r3, .L79+8
 4454 10e4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 427:../tp.c       ****     Lcd_Dma_Trans();
 4455              		.loc 1 427 0
 4456 10e8 FEFFFFEB 		bl	Lcd_Dma_Trans
 428:../tp.c       ****     get_cal_point(B_lcd_x, B_lcd_y, &B_ts_x, &B_ts_y);
 4457              		.loc 1 428 0
 4458 10ec 78204BE2 		sub	r2, fp, #120
 4459 10f0 7C304BE2 		sub	r3, fp, #124
 4460 10f4 28001BE5 		ldr	r0, [fp, #-40]
 4461 10f8 2C101BE5 		ldr	r1, [fp, #-44]
 4462 10fc 6FFFFFEB 		bl	get_cal_point
 429:../tp.c       ****     
 430:../tp.c       ****     // Capturar punto C
 431:../tp.c       ****     Lcd_Clr();
 4463              		.loc 1 431 0
 4464 1100 FEFFFFEB 		bl	Lcd_Clr
 432:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto C");
 4465              		.loc 1 432 0
 4466 1104 0A00A0E3 		mov	r0, #10
 4467 1108 0A10A0E3 		mov	r1, #10
 4468 110c 0F20A0E3 		mov	r2, #15
 4469 1110 84349FE5 		ldr	r3, .L79+12
 4470 1114 FEFFFFEB 		bl	Lcd_DspAscII6x8
 433:../tp.c       ****     Lcd_Dma_Trans();
 4471              		.loc 1 433 0
 4472 1118 FEFFFFEB 		bl	Lcd_Dma_Trans
 434:../tp.c       ****     get_cal_point(C_lcd_x, C_lcd_y, &C_ts_x, &C_ts_y);
 4473              		.loc 1 434 0
 4474 111c 80204BE2 		sub	r2, fp, #128
 4475 1120 84304BE2 		sub	r3, fp, #132
 4476 1124 30001BE5 		ldr	r0, [fp, #-48]
 4477 1128 34101BE5 		ldr	r1, [fp, #-52]
 4478 112c 63FFFFEB 		bl	get_cal_point
 435:../tp.c       ****     
 436:../tp.c       ****     // Capturar punto D
 437:../tp.c       ****     Lcd_Clr();
 4479              		.loc 1 437 0
 4480 1130 FEFFFFEB 		bl	Lcd_Clr
 438:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca punto D");
 4481              		.loc 1 438 0
 4482 1134 0A00A0E3 		mov	r0, #10
 4483 1138 0A10A0E3 		mov	r1, #10
 4484 113c 0F20A0E3 		mov	r2, #15
 4485 1140 58349FE5 		ldr	r3, .L79+16
 4486 1144 FEFFFFEB 		bl	Lcd_DspAscII6x8
 439:../tp.c       ****     Lcd_Dma_Trans();
 4487              		.loc 1 439 0
 4488 1148 FEFFFFEB 		bl	Lcd_Dma_Trans
 440:../tp.c       ****     get_cal_point(D_lcd_x, D_lcd_y, &D_ts_x, &D_ts_y);
 4489              		.loc 1 440 0
 4490 114c 88204BE2 		sub	r2, fp, #136
 4491 1150 8C304BE2 		sub	r3, fp, #140
 4492 1154 38001BE5 		ldr	r0, [fp, #-56]
 4493 1158 3C101BE5 		ldr	r1, [fp, #-60]
 4494 115c 57FFFFEB 		bl	get_cal_point
 441:../tp.c       ****     
 442:../tp.c       ****     // Capturar punto E (centro)
 443:../tp.c       ****     Lcd_Clr();
 4495              		.loc 1 443 0
 4496 1160 FEFFFFEB 		bl	Lcd_Clr
 444:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"Toca centro E");
 4497              		.loc 1 444 0
 4498 1164 0A00A0E3 		mov	r0, #10
 4499 1168 0A10A0E3 		mov	r1, #10
 4500 116c 0F20A0E3 		mov	r2, #15
 4501 1170 2C349FE5 		ldr	r3, .L79+20
 4502 1174 FEFFFFEB 		bl	Lcd_DspAscII6x8
 445:../tp.c       ****     Lcd_Dma_Trans();
 4503              		.loc 1 445 0
 4504 1178 FEFFFFEB 		bl	Lcd_Dma_Trans
 446:../tp.c       ****     get_cal_point(E_lcd_x, E_lcd_y, &E_ts_x, &E_ts_y);
 4505              		.loc 1 446 0
 4506 117c 90204BE2 		sub	r2, fp, #144
 4507 1180 94304BE2 		sub	r3, fp, #148
 4508 1184 40001BE5 		ldr	r0, [fp, #-64]
 4509 1188 44101BE5 		ldr	r1, [fp, #-68]
 4510 118c 4BFFFFEB 		bl	get_cal_point
 447:../tp.c       ****     
 448:../tp.c       ****     // DETECCIÓN DE SWAP XY
 449:../tp.c       ****     dx = B_ts_x - A_ts_x;
 4511              		.loc 1 449 0
 4512 1190 78201BE5 		ldr	r2, [fp, #-120]
 4513 1194 70301BE5 		ldr	r3, [fp, #-112]
 4514 1198 023063E0 		rsb	r3, r3, r2
 4515 119c 18300BE5 		str	r3, [fp, #-24]
 450:../tp.c       ****     dy = B_ts_y - A_ts_y;
 4516              		.loc 1 450 0
 4517 11a0 7C201BE5 		ldr	r2, [fp, #-124]
 4518 11a4 74301BE5 		ldr	r3, [fp, #-116]
 4519 11a8 023063E0 		rsb	r3, r3, r2
 4520 11ac 1C300BE5 		str	r3, [fp, #-28]
 451:../tp.c       ****     if (dx < 0) dx = -dx;
 4521              		.loc 1 451 0
 4522 11b0 18301BE5 		ldr	r3, [fp, #-24]
 4523 11b4 000053E3 		cmp	r3, #0
 4524 11b8 020000AA 		bge	.L69
 4525              		.loc 1 451 0 is_stmt 0 discriminator 1
 4526 11bc 18301BE5 		ldr	r3, [fp, #-24]
 4527 11c0 003063E2 		rsb	r3, r3, #0
 4528 11c4 18300BE5 		str	r3, [fp, #-24]
 4529              	.L69:
 452:../tp.c       ****     if (dy < 0) dy = -dy;
 4530              		.loc 1 452 0 is_stmt 1
 4531 11c8 1C301BE5 		ldr	r3, [fp, #-28]
 4532 11cc 000053E3 		cmp	r3, #0
 4533 11d0 020000AA 		bge	.L70
 4534              		.loc 1 452 0 is_stmt 0 discriminator 1
 4535 11d4 1C301BE5 		ldr	r3, [fp, #-28]
 4536 11d8 003063E2 		rsb	r3, r3, #0
 4537 11dc 1C300BE5 		str	r3, [fp, #-28]
 4538              	.L70:
 453:../tp.c       ****     
 454:../tp.c       ****     if (dx > dy)
 4539              		.loc 1 454 0 is_stmt 1
 4540 11e0 18201BE5 		ldr	r2, [fp, #-24]
 4541 11e4 1C301BE5 		ldr	r3, [fp, #-28]
 4542 11e8 030052E1 		cmp	r2, r3
 4543 11ec 030000DA 		ble	.L71
 455:../tp.c       ****     {
 456:../tp.c       ****         g_swap_xy = 0;
 4544              		.loc 1 456 0
 4545 11f0 B0339FE5 		ldr	r3, .L79+24
 4546 11f4 0020A0E3 		mov	r2, #0
 4547 11f8 002083E5 		str	r2, [r3, #0]
 4548 11fc 200000EA 		b	.L72
 4549              	.L71:
 4550              	.LBB2:
 457:../tp.c       ****     }
 458:../tp.c       ****     else
 459:../tp.c       ****     {
 460:../tp.c       ****         g_swap_xy = 1;
 4551              		.loc 1 460 0
 4552 1200 A0339FE5 		ldr	r3, .L79+24
 4553 1204 0120A0E3 		mov	r2, #1
 4554 1208 002083E5 		str	r2, [r3, #0]
 461:../tp.c       ****         int tmp;
 462:../tp.c       ****         #define SWAP(a, b) { tmp = a; a = b; b = tmp; }
 463:../tp.c       ****         SWAP(A_ts_x, A_ts_y);
 4555              		.loc 1 463 0
 4556 120c 70301BE5 		ldr	r3, [fp, #-112]
 4557 1210 48300BE5 		str	r3, [fp, #-72]
 4558 1214 74301BE5 		ldr	r3, [fp, #-116]
 4559 1218 70300BE5 		str	r3, [fp, #-112]
 4560 121c 48301BE5 		ldr	r3, [fp, #-72]
 4561 1220 74300BE5 		str	r3, [fp, #-116]
 464:../tp.c       ****         SWAP(B_ts_x, B_ts_y);
 4562              		.loc 1 464 0
 4563 1224 78301BE5 		ldr	r3, [fp, #-120]
 4564 1228 48300BE5 		str	r3, [fp, #-72]
 4565 122c 7C301BE5 		ldr	r3, [fp, #-124]
 4566 1230 78300BE5 		str	r3, [fp, #-120]
 4567 1234 48301BE5 		ldr	r3, [fp, #-72]
 4568 1238 7C300BE5 		str	r3, [fp, #-124]
 465:../tp.c       ****         SWAP(C_ts_x, C_ts_y);
 4569              		.loc 1 465 0
 4570 123c 80301BE5 		ldr	r3, [fp, #-128]
 4571 1240 48300BE5 		str	r3, [fp, #-72]
 4572 1244 84301BE5 		ldr	r3, [fp, #-132]
 4573 1248 80300BE5 		str	r3, [fp, #-128]
 4574 124c 48301BE5 		ldr	r3, [fp, #-72]
 4575 1250 84300BE5 		str	r3, [fp, #-132]
 466:../tp.c       ****         SWAP(D_ts_x, D_ts_y);
 4576              		.loc 1 466 0
 4577 1254 88301BE5 		ldr	r3, [fp, #-136]
 4578 1258 48300BE5 		str	r3, [fp, #-72]
 4579 125c 8C301BE5 		ldr	r3, [fp, #-140]
 4580 1260 88300BE5 		str	r3, [fp, #-136]
 4581 1264 48301BE5 		ldr	r3, [fp, #-72]
 4582 1268 8C300BE5 		str	r3, [fp, #-140]
 467:../tp.c       ****         SWAP(E_ts_x, E_ts_y);
 4583              		.loc 1 467 0
 4584 126c 90301BE5 		ldr	r3, [fp, #-144]
 4585 1270 48300BE5 		str	r3, [fp, #-72]
 4586 1274 94301BE5 		ldr	r3, [fp, #-148]
 4587 1278 90300BE5 		str	r3, [fp, #-144]
 4588 127c 48301BE5 		ldr	r3, [fp, #-72]
 4589 1280 94300BE5 		str	r3, [fp, #-148]
 4590              	.L72:
 4591              	.LBE2:
 468:../tp.c       ****     }
 469:../tp.c       ****     
 470:../tp.c       ****     // CÁLCULO DEL CENTRO - usar promedio de los 4 puntos para mayor precisión
 471:../tp.c       ****     g_ts_xc = (A_ts_x + B_ts_x + C_ts_x + D_ts_x) / 4;
 4592              		.loc 1 471 0
 4593 1284 70201BE5 		ldr	r2, [fp, #-112]
 4594 1288 78301BE5 		ldr	r3, [fp, #-120]
 4595 128c 032082E0 		add	r2, r2, r3
 4596 1290 80301BE5 		ldr	r3, [fp, #-128]
 4597 1294 032082E0 		add	r2, r2, r3
 4598 1298 88301BE5 		ldr	r3, [fp, #-136]
 4599 129c 033082E0 		add	r3, r2, r3
 4600 12a0 032083E2 		add	r2, r3, #3
 4601 12a4 000053E3 		cmp	r3, #0
 4602 12a8 0230A0B1 		movlt	r3, r2
 4603 12ac 4331A0E1 		mov	r3, r3, asr #2
 4604 12b0 0320A0E1 		mov	r2, r3
 4605 12b4 F0329FE5 		ldr	r3, .L79+28
 4606 12b8 002083E5 		str	r2, [r3, #0]
 472:../tp.c       ****     g_ts_yc = (A_ts_y + B_ts_y + C_ts_y + D_ts_y) / 4;
 4607              		.loc 1 472 0
 4608 12bc 74201BE5 		ldr	r2, [fp, #-116]
 4609 12c0 7C301BE5 		ldr	r3, [fp, #-124]
 4610 12c4 032082E0 		add	r2, r2, r3
 4611 12c8 84301BE5 		ldr	r3, [fp, #-132]
 4612 12cc 032082E0 		add	r2, r2, r3
 4613 12d0 8C301BE5 		ldr	r3, [fp, #-140]
 4614 12d4 033082E0 		add	r3, r2, r3
 4615 12d8 032083E2 		add	r2, r3, #3
 4616 12dc 000053E3 		cmp	r3, #0
 4617 12e0 0230A0B1 		movlt	r3, r2
 4618 12e4 4331A0E1 		mov	r3, r3, asr #2
 4619 12e8 0320A0E1 		mov	r2, r3
 4620 12ec BC329FE5 		ldr	r3, .L79+32
 4621 12f0 002083E5 		str	r2, [r3, #0]
 473:../tp.c       ****     g_lcd_xc = XRES / 2;
 4622              		.loc 1 473 0
 4623 12f4 98301BE5 		ldr	r3, [fp, #-152]
 4624 12f8 A32FA0E1 		mov	r2, r3, lsr #31
 4625 12fc 033082E0 		add	r3, r2, r3
 4626 1300 C330A0E1 		mov	r3, r3, asr #1
 4627 1304 0320A0E1 		mov	r2, r3
 4628 1308 A4329FE5 		ldr	r3, .L79+36
 4629 130c 002083E5 		str	r2, [r3, #0]
 474:../tp.c       ****     g_lcd_yc = YRES / 2;
 4630              		.loc 1 474 0
 4631 1310 9C301BE5 		ldr	r3, [fp, #-156]
 4632 1314 A32FA0E1 		mov	r2, r3, lsr #31
 4633 1318 033082E0 		add	r3, r2, r3
 4634 131c C330A0E1 		mov	r3, r3, asr #1
 4635 1320 0320A0E1 		mov	r2, r3
 4636 1324 8C329FE5 		ldr	r3, .L79+40
 4637 1328 002083E5 		str	r2, [r3, #0]
 475:../tp.c       ****     
 476:../tp.c       ****     // CÁLCULO DE kx y ky (CON SIGNO - fixed-point 16.16)
 477:../tp.c       ****     lcd_s = XRES - 2 * M;
 4638              		.loc 1 477 0
 4639 132c A0201BE5 		ldr	r2, [fp, #-160]
 4640 1330 0230A0E1 		mov	r3, r2
 4641 1334 833FA0E1 		mov	r3, r3, asl #31
 4642 1338 033062E0 		rsb	r3, r2, r3
 4643 133c 8330A0E1 		mov	r3, r3, asl #1
 4644 1340 0320A0E1 		mov	r2, r3
 4645 1344 98301BE5 		ldr	r3, [fp, #-152]
 4646 1348 033082E0 		add	r3, r2, r3
 4647 134c 4C300BE5 		str	r3, [fp, #-76]
 478:../tp.c       ****     lcd_d = YRES - 2 * M;
 4648              		.loc 1 478 0
 4649 1350 A0201BE5 		ldr	r2, [fp, #-160]
 4650 1354 0230A0E1 		mov	r3, r2
 4651 1358 833FA0E1 		mov	r3, r3, asl #31
 4652 135c 033062E0 		rsb	r3, r2, r3
 4653 1360 8330A0E1 		mov	r3, r3, asl #1
 4654 1364 0320A0E1 		mov	r2, r3
 4655 1368 9C301BE5 		ldr	r3, [fp, #-156]
 4656 136c 033082E0 		add	r3, r2, r3
 4657 1370 50300BE5 		str	r3, [fp, #-80]
 479:../tp.c       ****     
 480:../tp.c       ****     ts_s1 = B_ts_x - A_ts_x;
 4658              		.loc 1 480 0
 4659 1374 78201BE5 		ldr	r2, [fp, #-120]
 4660 1378 70301BE5 		ldr	r3, [fp, #-112]
 4661 137c 023063E0 		rsb	r3, r3, r2
 4662 1380 54300BE5 		str	r3, [fp, #-84]
 481:../tp.c       ****     ts_s2 = C_ts_x - D_ts_x;
 4663              		.loc 1 481 0
 4664 1384 80201BE5 		ldr	r2, [fp, #-128]
 4665 1388 88301BE5 		ldr	r3, [fp, #-136]
 4666 138c 023063E0 		rsb	r3, r3, r2
 4667 1390 58300BE5 		str	r3, [fp, #-88]
 482:../tp.c       ****     ts_d1 = D_ts_y - A_ts_y;
 4668              		.loc 1 482 0
 4669 1394 8C201BE5 		ldr	r2, [fp, #-140]
 4670 1398 74301BE5 		ldr	r3, [fp, #-116]
 4671 139c 023063E0 		rsb	r3, r3, r2
 4672 13a0 5C300BE5 		str	r3, [fp, #-92]
 483:../tp.c       ****     ts_d2 = C_ts_y - B_ts_y;
 4673              		.loc 1 483 0
 4674 13a4 84201BE5 		ldr	r2, [fp, #-132]
 4675 13a8 7C301BE5 		ldr	r3, [fp, #-124]
 4676 13ac 023063E0 		rsb	r3, r3, r2
 4677 13b0 60300BE5 		str	r3, [fp, #-96]
 484:../tp.c       ****     
 485:../tp.c       ****     // Usar promedios para mayor precisión
 486:../tp.c       ****     temp = (long long)lcd_s << 17;  // Multiplicar por 2 usando shift (<<17 = <<16 * 2)
 4678              		.loc 1 486 0
 4679 13b4 4C301BE5 		ldr	r3, [fp, #-76]
 4680 13b8 C34FA0E1 		mov	r4, r3, asr #31
 4681 13bc A327A0E1 		mov	r2, r3, lsr #15
 4682 13c0 8418A0E1 		mov	r1, r4, asl #17
 4683 13c4 022081E1 		orr	r2, r1, r2
 4684 13c8 68200BE5 		str	r2, [fp, #-104]
 4685 13cc 8338A0E1 		mov	r3, r3, asl #17
 4686 13d0 6C300BE5 		str	r3, [fp, #-108]
 487:../tp.c       ****     g_kx_fp = (long)(temp / (ts_s1 + ts_s2));
 4687              		.loc 1 487 0
 4688 13d4 54201BE5 		ldr	r2, [fp, #-84]
 4689 13d8 58301BE5 		ldr	r3, [fp, #-88]
 4690 13dc 033082E0 		add	r3, r2, r3
 4691 13e0 C34FA0E1 		mov	r4, r3, asr #31
 4692 13e4 6C104BE2 		sub	r1, fp, #108
 4693 13e8 030091E8 		ldmia	r1, {r0-r1}
 4694 13ec 0320A0E1 		mov	r2, r3
 4695 13f0 0430A0E1 		mov	r3, r4
 4696 13f4 FEFFFFEB 		bl	__aeabi_ldivmod
 4697 13f8 0030A0E1 		mov	r3, r0
 4698 13fc 0140A0E1 		mov	r4, r1
 4699 1400 0320A0E1 		mov	r2, r3
 4700 1404 B0319FE5 		ldr	r3, .L79+44
 4701 1408 002083E5 		str	r2, [r3, #0]
 488:../tp.c       ****     
 489:../tp.c       ****     temp = (long long)lcd_d << 17;  // Multiplicar por 2 usando shift
 4702              		.loc 1 489 0
 4703 140c 50301BE5 		ldr	r3, [fp, #-80]
 4704 1410 C34FA0E1 		mov	r4, r3, asr #31
 4705 1414 A327A0E1 		mov	r2, r3, lsr #15
 4706 1418 8418A0E1 		mov	r1, r4, asl #17
 4707 141c 022081E1 		orr	r2, r1, r2
 4708 1420 68200BE5 		str	r2, [fp, #-104]
 4709 1424 8338A0E1 		mov	r3, r3, asl #17
 4710 1428 6C300BE5 		str	r3, [fp, #-108]
 490:../tp.c       ****     g_ky_fp = (long)(temp / (ts_d1 + ts_d2));
 4711              		.loc 1 490 0
 4712 142c 5C201BE5 		ldr	r2, [fp, #-92]
 4713 1430 60301BE5 		ldr	r3, [fp, #-96]
 4714 1434 033082E0 		add	r3, r2, r3
 4715 1438 C34FA0E1 		mov	r4, r3, asr #31
 4716 143c 6C104BE2 		sub	r1, fp, #108
 4717 1440 030091E8 		ldmia	r1, {r0-r1}
 4718 1444 0320A0E1 		mov	r2, r3
 4719 1448 0430A0E1 		mov	r3, r4
 4720 144c FEFFFFEB 		bl	__aeabi_ldivmod
 4721 1450 0030A0E1 		mov	r3, r0
 4722 1454 0140A0E1 		mov	r4, r1
 4723 1458 0320A0E1 		mov	r2, r3
 4724 145c 5C319FE5 		ldr	r3, .L79+48
 4725 1460 002083E5 		str	r2, [r3, #0]
 491:../tp.c       ****     
 492:../tp.c       ****     // Mostrar resultados de calibración
 493:../tp.c       ****     Lcd_Clr();
 4726              		.loc 1 493 0
 4727 1464 FEFFFFEB 		bl	Lcd_Clr
 494:../tp.c       ****     
 495:../tp.c       ****     Lcd_DspAscII6x8(10, 10, BLACK, (unsigned char *)"=== CALIBRACION OK ===");
 4728              		.loc 1 495 0
 4729 1468 0A00A0E3 		mov	r0, #10
 4730 146c 0A10A0E3 		mov	r1, #10
 4731 1470 0F20A0E3 		mov	r2, #15
 4732 1474 48319FE5 		ldr	r3, .L79+52
 4733 1478 FEFFFFEB 		bl	Lcd_DspAscII6x8
 496:../tp.c       ****     
 497:../tp.c       ****     if (g_swap_xy)
 4734              		.loc 1 497 0
 4735 147c 24319FE5 		ldr	r3, .L79+24
 4736 1480 003093E5 		ldr	r3, [r3, #0]
 4737 1484 000053E3 		cmp	r3, #0
 4738 1488 0500000A 		beq	.L73
 498:../tp.c       ****         Lcd_DspAscII6x8(10, 30, BLACK, (unsigned char *)"Swap XY: SI");
 4739              		.loc 1 498 0
 4740 148c 0A00A0E3 		mov	r0, #10
 4741 1490 1E10A0E3 		mov	r1, #30
 4742 1494 0F20A0E3 		mov	r2, #15
 4743 1498 28319FE5 		ldr	r3, .L79+56
 4744 149c FEFFFFEB 		bl	Lcd_DspAscII6x8
 4745 14a0 040000EA 		b	.L74
 4746              	.L73:
 499:../tp.c       ****     else
 500:../tp.c       ****         Lcd_DspAscII6x8(10, 30, BLACK, (unsigned char *)"Swap XY: NO");
 4747              		.loc 1 500 0
 4748 14a4 0A00A0E3 		mov	r0, #10
 4749 14a8 1E10A0E3 		mov	r1, #30
 4750 14ac 0F20A0E3 		mov	r2, #15
 4751 14b0 14319FE5 		ldr	r3, .L79+60
 4752 14b4 FEFFFFEB 		bl	Lcd_DspAscII6x8
 4753              	.L74:
 501:../tp.c       ****     
 502:../tp.c       ****     Lcd_DspAscII6x8(10, 50, BLACK, (unsigned char *)"Puntos capturados OK");
 4754              		.loc 1 502 0
 4755 14b8 0A00A0E3 		mov	r0, #10
 4756 14bc 3210A0E3 		mov	r1, #50
 4757 14c0 0F20A0E3 		mov	r2, #15
 4758 14c4 04319FE5 		ldr	r3, .L79+64
 4759 14c8 FEFFFFEB 		bl	Lcd_DspAscII6x8
 503:../tp.c       ****     Lcd_DspAscII6x8(10, 70, BLACK, (unsigned char *)"Factores calculados");
 4760              		.loc 1 503 0
 4761 14cc 0A00A0E3 		mov	r0, #10
 4762 14d0 4610A0E3 		mov	r1, #70
 4763 14d4 0F20A0E3 		mov	r2, #15
 4764 14d8 F4309FE5 		ldr	r3, .L79+68
 4765 14dc FEFFFFEB 		bl	Lcd_DspAscII6x8
 504:../tp.c       ****     
 505:../tp.c       ****     // Mostrar signo de las escalas
 506:../tp.c       ****     if (g_kx_fp > 0)
 4766              		.loc 1 506 0
 4767 14e0 D4309FE5 		ldr	r3, .L79+44
 4768 14e4 003093E5 		ldr	r3, [r3, #0]
 4769 14e8 000053E3 		cmp	r3, #0
 4770 14ec 050000DA 		ble	.L75
 507:../tp.c       ****         Lcd_DspAscII6x8(10, 90, BLACK, (unsigned char *)"kx: POSITIVO");
 4771              		.loc 1 507 0
 4772 14f0 0A00A0E3 		mov	r0, #10
 4773 14f4 5A10A0E3 		mov	r1, #90
 4774 14f8 0F20A0E3 		mov	r2, #15
 4775 14fc D4309FE5 		ldr	r3, .L79+72
 4776 1500 FEFFFFEB 		bl	Lcd_DspAscII6x8
 4777 1504 040000EA 		b	.L76
 4778              	.L75:
 508:../tp.c       ****     else
 509:../tp.c       ****         Lcd_DspAscII6x8(10, 90, BLACK, (unsigned char *)"kx: NEGATIVO");
 4779              		.loc 1 509 0
 4780 1508 0A00A0E3 		mov	r0, #10
 4781 150c 5A10A0E3 		mov	r1, #90
 4782 1510 0F20A0E3 		mov	r2, #15
 4783 1514 C0309FE5 		ldr	r3, .L79+76
 4784 1518 FEFFFFEB 		bl	Lcd_DspAscII6x8
 4785              	.L76:
 510:../tp.c       ****         
 511:../tp.c       ****     if (g_ky_fp > 0)
 4786              		.loc 1 511 0
 4787 151c 9C309FE5 		ldr	r3, .L79+48
 4788 1520 003093E5 		ldr	r3, [r3, #0]
 4789 1524 000053E3 		cmp	r3, #0
 4790 1528 050000DA 		ble	.L77
 512:../tp.c       ****         Lcd_DspAscII6x8(10, 110, BLACK, (unsigned char *)"ky: POSITIVO");
 4791              		.loc 1 512 0
 4792 152c 0A00A0E3 		mov	r0, #10
 4793 1530 6E10A0E3 		mov	r1, #110
 4794 1534 0F20A0E3 		mov	r2, #15
 4795 1538 A0309FE5 		ldr	r3, .L79+80
 4796 153c FEFFFFEB 		bl	Lcd_DspAscII6x8
 4797 1540 040000EA 		b	.L78
 4798              	.L77:
 513:../tp.c       ****     else
 514:../tp.c       ****         Lcd_DspAscII6x8(10, 110, BLACK, (unsigned char *)"ky: NEGATIVO");
 4799              		.loc 1 514 0
 4800 1544 0A00A0E3 		mov	r0, #10
 4801 1548 6E10A0E3 		mov	r1, #110
 4802 154c 0F20A0E3 		mov	r2, #15
 4803 1550 8C309FE5 		ldr	r3, .L79+84
 4804 1554 FEFFFFEB 		bl	Lcd_DspAscII6x8
 4805              	.L78:
 515:../tp.c       ****     
 516:../tp.c       ****     Lcd_DspAscII6x8(10, 140, BLACK, (unsigned char *)"[Toca para continuar]");
 4806              		.loc 1 516 0
 4807 1558 0A00A0E3 		mov	r0, #10
 4808 155c 8C10A0E3 		mov	r1, #140
 4809 1560 0F20A0E3 		mov	r2, #15
 4810 1564 7C309FE5 		ldr	r3, .L79+88
 4811 1568 FEFFFFEB 		bl	Lcd_DspAscII6x8
 517:../tp.c       ****     
 518:../tp.c       ****     Lcd_Dma_Trans();
 4812              		.loc 1 518 0
 4813 156c FEFFFFEB 		bl	Lcd_Dma_Trans
 519:../tp.c       ****     
 520:../tp.c       ****     // Esperar toque para continuar
 521:../tp.c       ****     ts_wait_for_touch();
 4814              		.loc 1 521 0
 4815 1570 2FFEFFEB 		bl	ts_wait_for_touch
 522:../tp.c       ****     Delay(50);
 4816              		.loc 1 522 0
 4817 1574 3200A0E3 		mov	r0, #50
 4818 1578 FEFFFFEB 		bl	Delay
 523:../tp.c       ****     
 524:../tp.c       ****     Lcd_Clr();
 4819              		.loc 1 524 0
 4820 157c FEFFFFEB 		bl	Lcd_Clr
 525:../tp.c       ****     Lcd_Dma_Trans();
 4821              		.loc 1 525 0
 4822 1580 FEFFFFEB 		bl	Lcd_Dma_Trans
 526:../tp.c       **** }
 4823              		.loc 1 526 0
 4824 1584 10D04BE2 		sub	sp, fp, #16
 4825 1588 10689DE8 		ldmfd	sp, {r4, fp, sp, lr}
 4826 158c 1EFF2FE1 		bx	lr
 4827              	.L80:
 4828              		.align	2
 4829              	.L79:
 4830 1590 40000000 		.word	.LC16
 4831 1594 54000000 		.word	.LC17
 4832 1598 64000000 		.word	.LC18
 4833 159c 74000000 		.word	.LC19
 4834 15a0 84000000 		.word	.LC20
 4835 15a4 94000000 		.word	.LC21
 4836 15a8 00000000 		.word	g_swap_xy
 4837 15ac 0C000000 		.word	g_ts_xc
 4838 15b0 10000000 		.word	g_ts_yc
 4839 15b4 14000000 		.word	g_lcd_xc
 4840 15b8 18000000 		.word	g_lcd_yc
 4841 15bc 04000000 		.word	g_kx_fp
 4842 15c0 08000000 		.word	g_ky_fp
 4843 15c4 A4000000 		.word	.LC22
 4844 15c8 BC000000 		.word	.LC23
 4845 15cc C8000000 		.word	.LC24
 4846 15d0 D4000000 		.word	.LC25
 4847 15d4 EC000000 		.word	.LC26
 4848 15d8 00010000 		.word	.LC27
 4849 15dc 10010000 		.word	.LC28
 4850 15e0 20010000 		.word	.LC29
 4851 15e4 30010000 		.word	.LC30
 4852 15e8 40010000 		.word	.LC31
 4853              		.cfi_endproc
 4854              	.LFE13:
 4856              		.align	2
 4857              		.global	ts_read_calibrated
 4859              	ts_read_calibrated:
 4860              	.LFB14:
 527:../tp.c       **** 
 528:../tp.c       **** /*********************************************************************************************
 529:../tp.c       **** * name:     ts_read_calibrated
 530:../tp.c       **** * func:     Lee coordenadas calibradas del touchscreen
 531:../tp.c       **** * ret:      0 si éxito, -1 si no hay toque
 532:../tp.c       **** *********************************************************************************************/
 533:../tp.c       **** int ts_read_calibrated(int *x, int *y)
 534:../tp.c       **** {
 4861              		.loc 1 534 0
 4862              		.cfi_startproc
 4863              		@ Function supports interworking.
 4864              		@ args = 0, pretend = 0, frame = 40
 4865              		@ frame_needed = 1, uses_anonymous_args = 0
 4866 15ec 0DC0A0E1 		mov	ip, sp
 4867              	.LCFI28:
 4868              		.cfi_def_cfa_register 12
 4869 15f0 F0DF2DE9 		stmfd	sp!, {r4, r5, r6, r7, r8, r9, sl, fp, ip, lr, pc}
 4870 15f4 04B04CE2 		sub	fp, ip, #4
 4871              		.cfi_offset 14, -8
 4872              		.cfi_offset 13, -12
 4873              		.cfi_offset 11, -16
 4874              		.cfi_offset 10, -20
 4875              		.cfi_offset 9, -24
 4876              		.cfi_offset 8, -28
 4877              		.cfi_offset 7, -32
 4878              		.cfi_offset 6, -36
 4879              		.cfi_offset 5, -40
 4880              		.cfi_offset 4, -44
 4881              	.LCFI29:
 4882              		.cfi_def_cfa 11, 4
 4883 15f8 2CD04DE2 		sub	sp, sp, #44
 4884 15fc 50000BE5 		str	r0, [fp, #-80]
 4885 1600 54100BE5 		str	r1, [fp, #-84]
 535:../tp.c       ****     int xr, yr;
 536:../tp.c       ****     long long temp_x, temp_y;
 537:../tp.c       ****     
 538:../tp.c       ****     if (g_ts_ready == 0)
 4886              		.loc 1 538 0
 4887 1604 C0219FE5 		ldr	r2, .L85
 4888 1608 002092E5 		ldr	r2, [r2, #0]
 4889 160c 000052E3 		cmp	r2, #0
 4890 1610 0100001A 		bne	.L82
 539:../tp.c       ****         return -1;
 4891              		.loc 1 539 0
 4892 1614 0030E0E3 		mvn	r3, #0
 4893 1618 670000EA 		b	.L83
 4894              	.L82:
 540:../tp.c       ****     
 541:../tp.c       ****     xr = g_ts_raw_x;
 4895              		.loc 1 541 0
 4896 161c AC219FE5 		ldr	r2, .L85+4
 4897 1620 002092E5 		ldr	r2, [r2, #0]
 4898 1624 30200BE5 		str	r2, [fp, #-48]
 542:../tp.c       ****     yr = g_ts_raw_y;
 4899              		.loc 1 542 0
 4900 1628 A4219FE5 		ldr	r2, .L85+8
 4901 162c 002092E5 		ldr	r2, [r2, #0]
 4902 1630 34200BE5 		str	r2, [fp, #-52]
 543:../tp.c       ****     g_ts_ready = 0;
 4903              		.loc 1 543 0
 4904 1634 90219FE5 		ldr	r2, .L85
 4905 1638 0010A0E3 		mov	r1, #0
 4906 163c 001082E5 		str	r1, [r2, #0]
 544:../tp.c       ****     
 545:../tp.c       ****     // Aplicar swap si necesario
 546:../tp.c       ****     if (g_swap_xy)
 4907              		.loc 1 546 0
 4908 1640 90219FE5 		ldr	r2, .L85+12
 4909 1644 002092E5 		ldr	r2, [r2, #0]
 4910 1648 000052E3 		cmp	r2, #0
 4911 164c 0500000A 		beq	.L84
 4912              	.LBB3:
 547:../tp.c       ****     {
 548:../tp.c       ****         int tmp = xr;
 4913              		.loc 1 548 0
 4914 1650 30201BE5 		ldr	r2, [fp, #-48]
 4915 1654 38200BE5 		str	r2, [fp, #-56]
 549:../tp.c       ****         xr = yr;
 4916              		.loc 1 549 0
 4917 1658 34201BE5 		ldr	r2, [fp, #-52]
 4918 165c 30200BE5 		str	r2, [fp, #-48]
 550:../tp.c       ****         yr = tmp;
 4919              		.loc 1 550 0
 4920 1660 38201BE5 		ldr	r2, [fp, #-56]
 4921 1664 34200BE5 		str	r2, [fp, #-52]
 4922              	.L84:
 4923              	.LBE3:
 551:../tp.c       ****     }
 552:../tp.c       ****     
 553:../tp.c       ****     // CONVERSIÓN con fixed-point 16.16
 554:../tp.c       ****     temp_x = (long long)g_kx_fp * (xr - g_ts_xc);
 4924              		.loc 1 554 0
 4925 1668 6C219FE5 		ldr	r2, .L85+16
 4926 166c 002092E5 		ldr	r2, [r2, #0]
 4927 1670 0290A0E1 		mov	r9, r2
 4928 1674 C9AFA0E1 		mov	sl, r9, asr #31
 4929 1678 60219FE5 		ldr	r2, .L85+20
 4930 167c 002092E5 		ldr	r2, [r2, #0]
 4931 1680 30101BE5 		ldr	r1, [fp, #-48]
 4932 1684 012062E0 		rsb	r2, r2, r1
 4933 1688 0270A0E1 		mov	r7, r2
 4934 168c C78FA0E1 		mov	r8, r7, asr #31
 4935 1690 970A00E0 		mul	r0, r7, sl
 4936 1694 990802E0 		mul	r2, r9, r8
 4937 1698 020080E0 		add	r0, r0, r2
 4938 169c 991782E0 		umull	r1, r2, r9, r7
 4939 16a0 020080E0 		add	r0, r0, r2
 4940 16a4 0020A0E1 		mov	r2, r0
 4941 16a8 44100BE5 		str	r1, [fp, #-68]
 4942 16ac 40200BE5 		str	r2, [fp, #-64]
 4943 16b0 44100BE5 		str	r1, [fp, #-68]
 4944 16b4 40200BE5 		str	r2, [fp, #-64]
 555:../tp.c       ****     *x = (int)(temp_x >> 16) + g_lcd_xc;
 4945              		.loc 1 555 0
 4946 16b8 40201BE5 		ldr	r2, [fp, #-64]
 4947 16bc 0228A0E1 		mov	r2, r2, asl #16
 4948 16c0 44101BE5 		ldr	r1, [fp, #-68]
 4949 16c4 2158A0E1 		mov	r5, r1, lsr #16
 4950 16c8 055082E1 		orr	r5, r2, r5
 4951 16cc 40201BE5 		ldr	r2, [fp, #-64]
 4952 16d0 4268A0E1 		mov	r6, r2, asr #16
 4953 16d4 0510A0E1 		mov	r1, r5
 4954 16d8 04219FE5 		ldr	r2, .L85+24
 4955 16dc 002092E5 		ldr	r2, [r2, #0]
 4956 16e0 021081E0 		add	r1, r1, r2
 4957 16e4 50201BE5 		ldr	r2, [fp, #-80]
 4958 16e8 001082E5 		str	r1, [r2, #0]
 556:../tp.c       ****     
 557:../tp.c       ****     temp_y = (long long)g_ky_fp * (yr - g_ts_yc);
 4959              		.loc 1 557 0
 4960 16ec F4209FE5 		ldr	r2, .L85+28
 4961 16f0 002092E5 		ldr	r2, [r2, #0]
 4962 16f4 0270A0E1 		mov	r7, r2
 4963 16f8 C78FA0E1 		mov	r8, r7, asr #31
 4964 16fc E8209FE5 		ldr	r2, .L85+32
 4965 1700 002092E5 		ldr	r2, [r2, #0]
 4966 1704 34101BE5 		ldr	r1, [fp, #-52]
 4967 1708 012062E0 		rsb	r2, r2, r1
 4968 170c 0250A0E1 		mov	r5, r2
 4969 1710 C56FA0E1 		mov	r6, r5, asr #31
 4970 1714 950800E0 		mul	r0, r5, r8
 4971 1718 970602E0 		mul	r2, r7, r6
 4972 171c 020080E0 		add	r0, r0, r2
 4973 1720 971582E0 		umull	r1, r2, r7, r5
 4974 1724 020080E0 		add	r0, r0, r2
 4975 1728 0020A0E1 		mov	r2, r0
 4976 172c 4C100BE5 		str	r1, [fp, #-76]
 4977 1730 48200BE5 		str	r2, [fp, #-72]
 4978 1734 4C100BE5 		str	r1, [fp, #-76]
 4979 1738 48200BE5 		str	r2, [fp, #-72]
 558:../tp.c       ****     *y = (int)(temp_y >> 16) + g_lcd_yc;
 4980              		.loc 1 558 0
 4981 173c 48201BE5 		ldr	r2, [fp, #-72]
 4982 1740 0228A0E1 		mov	r2, r2, asl #16
 4983 1744 4C101BE5 		ldr	r1, [fp, #-76]
 4984 1748 2138A0E1 		mov	r3, r1, lsr #16
 4985 174c 033082E1 		orr	r3, r2, r3
 4986 1750 48201BE5 		ldr	r2, [fp, #-72]
 4987 1754 4248A0E1 		mov	r4, r2, asr #16
 4988 1758 0320A0E1 		mov	r2, r3
 4989 175c 8C309FE5 		ldr	r3, .L85+36
 4990 1760 003093E5 		ldr	r3, [r3, #0]
 4991 1764 032082E0 		add	r2, r2, r3
 4992 1768 54301BE5 		ldr	r3, [fp, #-84]
 4993 176c 002083E5 		str	r2, [r3, #0]
 559:../tp.c       ****     
 560:../tp.c       ****     // Clampear
 561:../tp.c       ****     *x = clamp(*x, 0, SCR_XSIZE - 1);
 4994              		.loc 1 561 0
 4995 1770 50301BE5 		ldr	r3, [fp, #-80]
 4996 1774 003093E5 		ldr	r3, [r3, #0]
 4997 1778 0300A0E1 		mov	r0, r3
 4998 177c 0010A0E3 		mov	r1, #0
 4999 1780 6C209FE5 		ldr	r2, .L85+40
 5000 1784 C6FCFFEB 		bl	clamp
 5001 1788 0020A0E1 		mov	r2, r0
 5002 178c 50301BE5 		ldr	r3, [fp, #-80]
 5003 1790 002083E5 		str	r2, [r3, #0]
 562:../tp.c       ****     *y = clamp(*y, 0, SCR_YSIZE - 1);
 5004              		.loc 1 562 0
 5005 1794 54301BE5 		ldr	r3, [fp, #-84]
 5006 1798 003093E5 		ldr	r3, [r3, #0]
 5007 179c 0300A0E1 		mov	r0, r3
 5008 17a0 0010A0E3 		mov	r1, #0
 5009 17a4 EF20A0E3 		mov	r2, #239
 5010 17a8 BDFCFFEB 		bl	clamp
 5011 17ac 0020A0E1 		mov	r2, r0
 5012 17b0 54301BE5 		ldr	r3, [fp, #-84]
 5013 17b4 002083E5 		str	r2, [r3, #0]
 563:../tp.c       ****     
 564:../tp.c       ****     return 0;
 5014              		.loc 1 564 0
 5015 17b8 0030A0E3 		mov	r3, #0
 5016              	.L83:
 565:../tp.c       **** }
 5017              		.loc 1 565 0
 5018 17bc 0300A0E1 		mov	r0, r3
 5019 17c0 28D04BE2 		sub	sp, fp, #40
 5020 17c4 F06F9DE8 		ldmfd	sp, {r4, r5, r6, r7, r8, r9, sl, fp, sp, lr}
 5021 17c8 1EFF2FE1 		bx	lr
 5022              	.L86:
 5023              		.align	2
 5024              	.L85:
 5025 17cc 1C000000 		.word	g_ts_ready
 5026 17d0 20000000 		.word	g_ts_raw_x
 5027 17d4 24000000 		.word	g_ts_raw_y
 5028 17d8 00000000 		.word	g_swap_xy
 5029 17dc 04000000 		.word	g_kx_fp
 5030 17e0 0C000000 		.word	g_ts_xc
 5031 17e4 14000000 		.word	g_lcd_xc
 5032 17e8 08000000 		.word	g_ky_fp
 5033 17ec 10000000 		.word	g_ts_yc
 5034 17f0 18000000 		.word	g_lcd_yc
 5035 17f4 3F010000 		.word	319
 5036              		.cfi_endproc
 5037              	.LFE14:
 5039              		.section	.rodata
 5040 0156 0000     		.align	2
 5041              	.LC32:
 5042 0158 44696275 		.ascii	"Dibuja!\000"
 5042      6A612100 
 5043              		.text
 5044              		.align	2
 5045              		.global	ts_test_calibracion
 5047              	ts_test_calibracion:
 5048              	.LFB15:
 566:../tp.c       **** 
 567:../tp.c       **** /*********************************************************************************************
 568:../tp.c       **** * name:     ts_test_calibracion
 569:../tp.c       **** * func:     Función de test completa: calibra y permite dibujar
 570:../tp.c       **** *********************************************************************************************/
 571:../tp.c       **** void ts_test_calibracion(void)
 572:../tp.c       **** {
 5049              		.loc 1 572 0
 5050              		.cfi_startproc
 5051              		@ Function supports interworking.
 5052              		@ args = 0, pretend = 0, frame = 8
 5053              		@ frame_needed = 1, uses_anonymous_args = 0
 5054 17f8 0DC0A0E1 		mov	ip, sp
 5055              	.LCFI30:
 5056              		.cfi_def_cfa_register 12
 5057 17fc 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 5058 1800 04B04CE2 		sub	fp, ip, #4
 5059              		.cfi_offset 14, -8
 5060              		.cfi_offset 13, -12
 5061              		.cfi_offset 11, -16
 5062              	.LCFI31:
 5063              		.cfi_def_cfa 11, 4
 5064 1804 08D04DE2 		sub	sp, sp, #8
 573:../tp.c       ****     int x, y;
 574:../tp.c       ****     
 575:../tp.c       ****     Lcd_Init();
 5065              		.loc 1 575 0
 5066 1808 FEFFFFEB 		bl	Lcd_Init
 576:../tp.c       ****     TS_init();
 5067              		.loc 1 576 0
 5068 180c FEFFFFEB 		bl	TS_init
 577:../tp.c       ****     
 578:../tp.c       ****     // Calibrar con margen de 50 píxeles
 579:../tp.c       ****     ts_calibrate_5pt(SCR_XSIZE, SCR_YSIZE, 50);
 5069              		.loc 1 579 0
 5070 1810 050DA0E3 		mov	r0, #320
 5071 1814 F010A0E3 		mov	r1, #240
 5072 1818 3220A0E3 		mov	r2, #50
 5073 181c FEFFFFEB 		bl	ts_calibrate_5pt
 580:../tp.c       ****     
 581:../tp.c       ****     Lcd_Clr();
 5074              		.loc 1 581 0
 5075 1820 FEFFFFEB 		bl	Lcd_Clr
 582:../tp.c       ****     Lcd_Active_Clr();
 5076              		.loc 1 582 0
 5077 1824 FEFFFFEB 		bl	Lcd_Active_Clr
 583:../tp.c       ****     Lcd_DspAscII8x16(80, 110, BLACK, (unsigned char *)"Dibuja!");
 5078              		.loc 1 583 0
 5079 1828 5000A0E3 		mov	r0, #80
 5080 182c 6E10A0E3 		mov	r1, #110
 5081 1830 0F20A0E3 		mov	r2, #15
 5082 1834 68319FE5 		ldr	r3, .L92
 5083 1838 FEFFFFEB 		bl	Lcd_DspAscII8x16
 584:../tp.c       ****     Lcd_Dma_Trans();
 5084              		.loc 1 584 0
 5085 183c FEFFFFEB 		bl	Lcd_Dma_Trans
 585:../tp.c       ****     Delay(100);
 5086              		.loc 1 585 0
 5087 1840 6400A0E3 		mov	r0, #100
 5088 1844 FEFFFFEB 		bl	Delay
 586:../tp.c       ****     
 587:../tp.c       ****     Lcd_Clr();
 5089              		.loc 1 587 0
 5090 1848 FEFFFFEB 		bl	Lcd_Clr
 588:../tp.c       ****     Lcd_Dma_Trans();
 5091              		.loc 1 588 0
 5092 184c FEFFFFEB 		bl	Lcd_Dma_Trans
 5093 1850 020000EA 		b	.L89
 5094              	.L90:
 589:../tp.c       ****     
 590:../tp.c       ****     // Loop de dibujo
 591:../tp.c       ****     while (1)
 592:../tp.c       ****     {
 593:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 594:../tp.c       ****         {
 595:../tp.c       ****             (LCD_PutPixel(x, y, 0xf));
 596:../tp.c       ****             
 597:../tp.c       ****             static int count = 0;
 598:../tp.c       ****             if (++count >= 5)
 599:../tp.c       ****             {
 600:../tp.c       ****                 Lcd_Dma_Trans();
 601:../tp.c       ****                 count = 0;
 602:../tp.c       ****             }
 603:../tp.c       ****         }
 604:../tp.c       ****     }
 5095              		.loc 1 604 0
 5096 1854 0000A0E1 		mov	r0, r0	@ nop
 5097 1858 000000EA 		b	.L89
 5098              	.L91:
 5099 185c 0000A0E1 		mov	r0, r0	@ nop
 5100              	.L89:
 593:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 5101              		.loc 1 593 0
 5102 1860 10204BE2 		sub	r2, fp, #16
 5103 1864 14304BE2 		sub	r3, fp, #20
 5104 1868 0200A0E1 		mov	r0, r2
 5105 186c 0310A0E1 		mov	r1, r3
 5106 1870 FEFFFFEB 		bl	ts_read_calibrated
 5107 1874 0030A0E1 		mov	r3, r0
 5108 1878 000053E3 		cmp	r3, #0
 5109 187c F4FFFF1A 		bne	.L90
 5110              	.LBB4:
 595:../tp.c       ****             (LCD_PutPixel(x, y, 0xf));
 5111              		.loc 1 595 0
 5112 1880 14201BE5 		ldr	r2, [fp, #-20]
 5113 1884 0230A0E1 		mov	r3, r2
 5114 1888 0331A0E1 		mov	r3, r3, asl #2
 5115 188c 023083E0 		add	r3, r3, r2
 5116 1890 0333A0E1 		mov	r3, r3, asl #6
 5117 1894 A32FA0E1 		mov	r2, r3, lsr #31
 5118 1898 033082E0 		add	r3, r2, r3
 5119 189c C330A0E1 		mov	r3, r3, asr #1
 5120 18a0 C32683E2 		add	r2, r3, #204472320
 5121 18a4 962C82E2 		add	r2, r2, #38400
 5122 18a8 10301BE5 		ldr	r3, [fp, #-16]
 5123 18ac 071083E2 		add	r1, r3, #7
 5124 18b0 000053E3 		cmp	r3, #0
 5125 18b4 0130A0B1 		movlt	r3, r1
 5126 18b8 C331A0E1 		mov	r3, r3, asr #3
 5127 18bc 0331A0E1 		mov	r3, r3, asl #2
 5128 18c0 033082E0 		add	r3, r2, r3
 5129 18c4 0310A0E1 		mov	r1, r3
 5130 18c8 14201BE5 		ldr	r2, [fp, #-20]
 5131 18cc 0230A0E1 		mov	r3, r2
 5132 18d0 0331A0E1 		mov	r3, r3, asl #2
 5133 18d4 023083E0 		add	r3, r3, r2
 5134 18d8 0333A0E1 		mov	r3, r3, asl #6
 5135 18dc A32FA0E1 		mov	r2, r3, lsr #31
 5136 18e0 033082E0 		add	r3, r2, r3
 5137 18e4 C330A0E1 		mov	r3, r3, asr #1
 5138 18e8 C32683E2 		add	r2, r3, #204472320
 5139 18ec 962C82E2 		add	r2, r2, #38400
 5140 18f0 10301BE5 		ldr	r3, [fp, #-16]
 5141 18f4 070083E2 		add	r0, r3, #7
 5142 18f8 000053E3 		cmp	r3, #0
 5143 18fc 0030A0B1 		movlt	r3, r0
 5144 1900 C331A0E1 		mov	r3, r3, asr #3
 5145 1904 0331A0E1 		mov	r3, r3, asl #2
 5146 1908 033082E0 		add	r3, r2, r3
 5147 190c 000093E5 		ldr	r0, [r3, #0]
 5148 1910 10201BE5 		ldr	r2, [fp, #-16]
 5149 1914 C23FA0E1 		mov	r3, r2, asr #31
 5150 1918 A33EA0E1 		mov	r3, r3, lsr #29
 5151 191c 032082E0 		add	r2, r2, r3
 5152 1920 072002E2 		and	r2, r2, #7
 5153 1924 023063E0 		rsb	r3, r3, r2
 5154 1928 0331A0E1 		mov	r3, r3, asl #2
 5155 192c 0F22A0E3 		mov	r2, #-268435456
 5156 1930 3233A0E1 		mov	r3, r2, lsr r3
 5157 1934 0330E0E1 		mvn	r3, r3
 5158 1938 030000E0 		and	r0, r0, r3
 5159 193c 10201BE5 		ldr	r2, [fp, #-16]
 5160 1940 C23FA0E1 		mov	r3, r2, asr #31
 5161 1944 A33EA0E1 		mov	r3, r3, lsr #29
 5162 1948 032082E0 		add	r2, r2, r3
 5163 194c 072002E2 		and	r2, r2, #7
 5164 1950 023063E0 		rsb	r3, r3, r2
 5165 1954 073063E2 		rsb	r3, r3, #7
 5166 1958 0331A0E1 		mov	r3, r3, asl #2
 5167 195c 0F20A0E3 		mov	r2, #15
 5168 1960 1233A0E1 		mov	r3, r2, asl r3
 5169 1964 033080E1 		orr	r3, r0, r3
 5170 1968 003081E5 		str	r3, [r1, #0]
 598:../tp.c       ****             if (++count >= 5)
 5171              		.loc 1 598 0
 5172 196c 34309FE5 		ldr	r3, .L92+4
 5173 1970 003093E5 		ldr	r3, [r3, #0]
 5174 1974 012083E2 		add	r2, r3, #1
 5175 1978 28309FE5 		ldr	r3, .L92+4
 5176 197c 002083E5 		str	r2, [r3, #0]
 5177 1980 20309FE5 		ldr	r3, .L92+4
 5178 1984 003093E5 		ldr	r3, [r3, #0]
 5179 1988 040053E3 		cmp	r3, #4
 5180 198c B2FFFFDA 		ble	.L91
 600:../tp.c       ****                 Lcd_Dma_Trans();
 5181              		.loc 1 600 0
 5182 1990 FEFFFFEB 		bl	Lcd_Dma_Trans
 601:../tp.c       ****                 count = 0;
 5183              		.loc 1 601 0
 5184 1994 0C309FE5 		ldr	r3, .L92+4
 5185 1998 0020A0E3 		mov	r2, #0
 5186 199c 002083E5 		str	r2, [r3, #0]
 5187              	.LBE4:
 5188              		.loc 1 604 0
 5189 19a0 AEFFFFEA 		b	.L89
 5190              	.L93:
 5191              		.align	2
 5192              	.L92:
 5193 19a4 58010000 		.word	.LC32
 5194 19a8 28000000 		.word	count.4583
 5195              		.cfi_endproc
 5196              	.LFE15:
 5198              		.section	.rodata
 5199              		.align	2
 5200              	.LC33:
 5201 0160 546F6361 		.ascii	"Toca un numero\000"
 5201      20756E20 
 5201      6E756D65 
 5201      726F00
 5202 016f 00       		.align	2
 5203              	.LC34:
 5204 0170 546F7175 		.ascii	"Toque detectado:\000"
 5204      65206465 
 5204      74656374 
 5204      61646F3A 
 5204      00
 5205 0181 000000   		.align	2
 5206              	.LC35:
 5207 0184 436F6F72 		.ascii	"Coordenadas guardadas\000"
 5207      64656E61 
 5207      64617320 
 5207      67756172 
 5207      64616461 
 5208 019a 0000     		.align	2
 5209              	.LC36:
 5210 019c 4E554D45 		.ascii	"NUMERO 1\000"
 5210      524F2031 
 5210      00
 5211 01a5 000000   		.align	2
 5212              	.LC37:
 5213 01a8 4E554D45 		.ascii	"NUMERO 2\000"
 5213      524F2032 
 5213      00
 5214 01b1 000000   		.align	2
 5215              	.LC38:
 5216 01b4 46756572 		.ascii	"Fuera de zona\000"
 5216      61206465 
 5216      207A6F6E 
 5216      6100
 5217 01c2 0000     		.text
 5218              		.align	2
 5219              		.global	ts_test_numeros
 5221              	ts_test_numeros:
 5222              	.LFB16:
 605:../tp.c       **** }
 606:../tp.c       **** 
 607:../tp.c       **** /*********************************************************************************************
 608:../tp.c       **** * name:     ts_test_numeros
 609:../tp.c       **** * func:     Test con dos números: muestra coordenadas al tocar
 610:../tp.c       **** *********************************************************************************************/
 611:../tp.c       **** void ts_test_numeros(void)
 612:../tp.c       **** {
 5223              		.loc 1 612 0
 5224              		.cfi_startproc
 5225              		@ Function supports interworking.
 5226              		@ args = 0, pretend = 0, frame = 40
 5227              		@ frame_needed = 1, uses_anonymous_args = 0
 5228 19ac 0DC0A0E1 		mov	ip, sp
 5229              	.LCFI32:
 5230              		.cfi_def_cfa_register 12
 5231 19b0 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 5232 19b4 04B04CE2 		sub	fp, ip, #4
 5233              		.cfi_offset 14, -8
 5234              		.cfi_offset 13, -12
 5235              		.cfi_offset 11, -16
 5236              	.LCFI33:
 5237              		.cfi_def_cfa 11, 4
 5238 19b8 28D04DE2 		sub	sp, sp, #40
 613:../tp.c       ****     int x, y;
 614:../tp.c       ****     int num1_x = 60, num1_y = 100;   // Posición número 1 (izquierda)
 5239              		.loc 1 614 0
 5240 19bc 3C30A0E3 		mov	r3, #60
 5241 19c0 20300BE5 		str	r3, [fp, #-32]
 5242 19c4 6430A0E3 		mov	r3, #100
 5243 19c8 24300BE5 		str	r3, [fp, #-36]
 615:../tp.c       ****     int num2_x = 220, num2_y = 100;  // Posición número 2 (derecha)
 5244              		.loc 1 615 0
 5245 19cc DC30A0E3 		mov	r3, #220
 5246 19d0 28300BE5 		str	r3, [fp, #-40]
 5247 19d4 6430A0E3 		mov	r3, #100
 5248 19d8 2C300BE5 		str	r3, [fp, #-44]
 616:../tp.c       ****     
 617:../tp.c       ****     Lcd_Init();
 5249              		.loc 1 617 0
 5250 19dc FEFFFFEB 		bl	Lcd_Init
 618:../tp.c       ****     TS_init();
 5251              		.loc 1 618 0
 5252 19e0 FEFFFFEB 		bl	TS_init
 619:../tp.c       ****     
 620:../tp.c       ****     // Calibrar con margen de 30 píxeles (más cerca de los bordes)
 621:../tp.c       ****     ts_calibrate_5pt(SCR_XSIZE, SCR_YSIZE, 30);
 5253              		.loc 1 621 0
 5254 19e4 050DA0E3 		mov	r0, #320
 5255 19e8 F010A0E3 		mov	r1, #240
 5256 19ec 1E20A0E3 		mov	r2, #30
 5257 19f0 FEFFFFEB 		bl	ts_calibrate_5pt
 622:../tp.c       ****     
 623:../tp.c       ****     // Mostrar los dos números
 624:../tp.c       ****     Lcd_Clr();
 5258              		.loc 1 624 0
 5259 19f4 FEFFFFEB 		bl	Lcd_Clr
 625:../tp.c       ****     Lcd_DspAscII8x16(num1_x, num1_y, BLACK, (unsigned char *)"1");
 5260              		.loc 1 625 0
 5261 19f8 20301BE5 		ldr	r3, [fp, #-32]
 5262 19fc 0338A0E1 		mov	r3, r3, asl #16
 5263 1a00 2328A0E1 		mov	r2, r3, lsr #16
 5264 1a04 24301BE5 		ldr	r3, [fp, #-36]
 5265 1a08 0338A0E1 		mov	r3, r3, asl #16
 5266 1a0c 2338A0E1 		mov	r3, r3, lsr #16
 5267 1a10 0200A0E1 		mov	r0, r2
 5268 1a14 0310A0E1 		mov	r1, r3
 5269 1a18 0F20A0E3 		mov	r2, #15
 5270 1a1c 14349FE5 		ldr	r3, .L110
 5271 1a20 FEFFFFEB 		bl	Lcd_DspAscII8x16
 626:../tp.c       ****     Lcd_DspAscII8x16(num2_x, num2_y, BLACK, (unsigned char *)"2");
 5272              		.loc 1 626 0
 5273 1a24 28301BE5 		ldr	r3, [fp, #-40]
 5274 1a28 0338A0E1 		mov	r3, r3, asl #16
 5275 1a2c 2328A0E1 		mov	r2, r3, lsr #16
 5276 1a30 2C301BE5 		ldr	r3, [fp, #-44]
 5277 1a34 0338A0E1 		mov	r3, r3, asl #16
 5278 1a38 2338A0E1 		mov	r3, r3, lsr #16
 5279 1a3c 0200A0E1 		mov	r0, r2
 5280 1a40 0310A0E1 		mov	r1, r3
 5281 1a44 0F20A0E3 		mov	r2, #15
 5282 1a48 EC339FE5 		ldr	r3, .L110+4
 5283 1a4c FEFFFFEB 		bl	Lcd_DspAscII8x16
 627:../tp.c       ****     Lcd_DspAscII6x8(60, 20, BLACK, (unsigned char *)"Toca un numero");
 5284              		.loc 1 627 0
 5285 1a50 3C00A0E3 		mov	r0, #60
 5286 1a54 1410A0E3 		mov	r1, #20
 5287 1a58 0F20A0E3 		mov	r2, #15
 5288 1a5c DC339FE5 		ldr	r3, .L110+8
 5289 1a60 FEFFFFEB 		bl	Lcd_DspAscII6x8
 628:../tp.c       ****     Lcd_Dma_Trans();
 5290              		.loc 1 628 0
 5291 1a64 FEFFFFEB 		bl	Lcd_Dma_Trans
 5292 1a68 000000EA 		b	.L108
 5293              	.L109:
 629:../tp.c       ****     
 630:../tp.c       ****     // Loop de detección de toques
 631:../tp.c       ****     while (1)
 632:../tp.c       ****     {
 633:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 634:../tp.c       ****         {
 635:../tp.c       ****             // Limpiar zona de información
 636:../tp.c       ****             int i, j;
 637:../tp.c       ****             for (i = 0; i < 320; i++)
 638:../tp.c       ****                 for (j = 150; j < 200; j++)
 639:../tp.c       ****                     (LCD_PutPixel(i, j, 0x0));
 640:../tp.c       ****             
 641:../tp.c       ****             // Mostrar coordenadas
 642:../tp.c       ****             Lcd_DspAscII6x8(10, 160, BLACK, (unsigned char *)"Toque detectado:");
 643:../tp.c       ****             
 644:../tp.c       ****             // Mostrar X (solo texto fijo, sin sprintf)
 645:../tp.c       ****             Lcd_DspAscII6x8(10, 175, BLACK, (unsigned char *)"Coordenadas guardadas");
 646:../tp.c       ****             
 647:../tp.c       ****             // Dibujar punto donde se tocó
 648:../tp.c       ****             int px, py;
 649:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 650:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 651:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 652:../tp.c       ****                         (LCD_PutPixel(px, py, 0xf));
 653:../tp.c       ****             
 654:../tp.c       ****             // Detectar qué número se tocó (área más amplia para test)
 655:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 656:../tp.c       ****             {
 657:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 1");
 658:../tp.c       ****             }
 659:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 660:../tp.c       ****             {
 661:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 2");
 662:../tp.c       ****             }
 663:../tp.c       ****             else
 664:../tp.c       ****             {
 665:../tp.c       ****                 Lcd_DspAscII6x8(70, 195, BLACK, (unsigned char *)"Fuera de zona");
 666:../tp.c       ****             }
 667:../tp.c       ****             
 668:../tp.c       ****             Lcd_Dma_Trans();
 669:../tp.c       ****             Delay(50);
 670:../tp.c       ****         }
 671:../tp.c       ****     }
 5294              		.loc 1 671 0
 5295 1a6c 0000A0E1 		mov	r0, r0	@ nop
 5296              	.L108:
 633:../tp.c       ****         if (ts_read_calibrated(&x, &y) == 0)
 5297              		.loc 1 633 0
 5298 1a70 30204BE2 		sub	r2, fp, #48
 5299 1a74 34304BE2 		sub	r3, fp, #52
 5300 1a78 0200A0E1 		mov	r0, r2
 5301 1a7c 0310A0E1 		mov	r1, r3
 5302 1a80 FEFFFFEB 		bl	ts_read_calibrated
 5303 1a84 0030A0E1 		mov	r3, r0
 5304 1a88 000053E3 		cmp	r3, #0
 5305 1a8c F6FFFF1A 		bne	.L109
 5306              	.LBB5:
 637:../tp.c       ****             for (i = 0; i < 320; i++)
 5307              		.loc 1 637 0
 5308 1a90 0030A0E3 		mov	r3, #0
 5309 1a94 10300BE5 		str	r3, [fp, #-16]
 5310 1a98 3B0000EA 		b	.L96
 5311              	.L99:
 638:../tp.c       ****                 for (j = 150; j < 200; j++)
 5312              		.loc 1 638 0
 5313 1a9c 9630A0E3 		mov	r3, #150
 5314 1aa0 14300BE5 		str	r3, [fp, #-20]
 5315 1aa4 320000EA 		b	.L97
 5316              	.L98:
 639:../tp.c       ****                     (LCD_PutPixel(i, j, 0x0));
 5317              		.loc 1 639 0 discriminator 2
 5318 1aa8 14201BE5 		ldr	r2, [fp, #-20]
 5319 1aac 0230A0E1 		mov	r3, r2
 5320 1ab0 0331A0E1 		mov	r3, r3, asl #2
 5321 1ab4 023083E0 		add	r3, r3, r2
 5322 1ab8 0333A0E1 		mov	r3, r3, asl #6
 5323 1abc A32FA0E1 		mov	r2, r3, lsr #31
 5324 1ac0 033082E0 		add	r3, r2, r3
 5325 1ac4 C330A0E1 		mov	r3, r3, asr #1
 5326 1ac8 C32683E2 		add	r2, r3, #204472320
 5327 1acc 962C82E2 		add	r2, r2, #38400
 5328 1ad0 10301BE5 		ldr	r3, [fp, #-16]
 5329 1ad4 071083E2 		add	r1, r3, #7
 5330 1ad8 000053E3 		cmp	r3, #0
 5331 1adc 0130A0B1 		movlt	r3, r1
 5332 1ae0 C331A0E1 		mov	r3, r3, asr #3
 5333 1ae4 0331A0E1 		mov	r3, r3, asl #2
 5334 1ae8 033082E0 		add	r3, r2, r3
 5335 1aec 0310A0E1 		mov	r1, r3
 5336 1af0 14201BE5 		ldr	r2, [fp, #-20]
 5337 1af4 0230A0E1 		mov	r3, r2
 5338 1af8 0331A0E1 		mov	r3, r3, asl #2
 5339 1afc 023083E0 		add	r3, r3, r2
 5340 1b00 0333A0E1 		mov	r3, r3, asl #6
 5341 1b04 A32FA0E1 		mov	r2, r3, lsr #31
 5342 1b08 033082E0 		add	r3, r2, r3
 5343 1b0c C330A0E1 		mov	r3, r3, asr #1
 5344 1b10 C32683E2 		add	r2, r3, #204472320
 5345 1b14 962C82E2 		add	r2, r2, #38400
 5346 1b18 10301BE5 		ldr	r3, [fp, #-16]
 5347 1b1c 070083E2 		add	r0, r3, #7
 5348 1b20 000053E3 		cmp	r3, #0
 5349 1b24 0030A0B1 		movlt	r3, r0
 5350 1b28 C331A0E1 		mov	r3, r3, asr #3
 5351 1b2c 0331A0E1 		mov	r3, r3, asl #2
 5352 1b30 033082E0 		add	r3, r2, r3
 5353 1b34 000093E5 		ldr	r0, [r3, #0]
 5354 1b38 10201BE5 		ldr	r2, [fp, #-16]
 5355 1b3c C23FA0E1 		mov	r3, r2, asr #31
 5356 1b40 A33EA0E1 		mov	r3, r3, lsr #29
 5357 1b44 032082E0 		add	r2, r2, r3
 5358 1b48 072002E2 		and	r2, r2, #7
 5359 1b4c 023063E0 		rsb	r3, r3, r2
 5360 1b50 0331A0E1 		mov	r3, r3, asl #2
 5361 1b54 0F22A0E3 		mov	r2, #-268435456
 5362 1b58 3233A0E1 		mov	r3, r2, lsr r3
 5363 1b5c 0330E0E1 		mvn	r3, r3
 5364 1b60 033000E0 		and	r3, r0, r3
 5365 1b64 003081E5 		str	r3, [r1, #0]
 638:../tp.c       ****                 for (j = 150; j < 200; j++)
 5366              		.loc 1 638 0 discriminator 2
 5367 1b68 14301BE5 		ldr	r3, [fp, #-20]
 5368 1b6c 013083E2 		add	r3, r3, #1
 5369 1b70 14300BE5 		str	r3, [fp, #-20]
 5370              	.L97:
 638:../tp.c       ****                 for (j = 150; j < 200; j++)
 5371              		.loc 1 638 0 is_stmt 0 discriminator 1
 5372 1b74 14301BE5 		ldr	r3, [fp, #-20]
 5373 1b78 C70053E3 		cmp	r3, #199
 5374 1b7c C9FFFFDA 		ble	.L98
 637:../tp.c       ****             for (i = 0; i < 320; i++)
 5375              		.loc 1 637 0 is_stmt 1
 5376 1b80 10301BE5 		ldr	r3, [fp, #-16]
 5377 1b84 013083E2 		add	r3, r3, #1
 5378 1b88 10300BE5 		str	r3, [fp, #-16]
 5379              	.L96:
 637:../tp.c       ****             for (i = 0; i < 320; i++)
 5380              		.loc 1 637 0 is_stmt 0 discriminator 1
 5381 1b8c 10201BE5 		ldr	r2, [fp, #-16]
 5382 1b90 AC329FE5 		ldr	r3, .L110+12
 5383 1b94 030052E1 		cmp	r2, r3
 5384 1b98 BFFFFFDA 		ble	.L99
 642:../tp.c       ****             Lcd_DspAscII6x8(10, 160, BLACK, (unsigned char *)"Toque detectado:");
 5385              		.loc 1 642 0 is_stmt 1
 5386 1b9c 0A00A0E3 		mov	r0, #10
 5387 1ba0 A010A0E3 		mov	r1, #160
 5388 1ba4 0F20A0E3 		mov	r2, #15
 5389 1ba8 98329FE5 		ldr	r3, .L110+16
 5390 1bac FEFFFFEB 		bl	Lcd_DspAscII6x8
 645:../tp.c       ****             Lcd_DspAscII6x8(10, 175, BLACK, (unsigned char *)"Coordenadas guardadas");
 5391              		.loc 1 645 0
 5392 1bb0 0A00A0E3 		mov	r0, #10
 5393 1bb4 AF10A0E3 		mov	r1, #175
 5394 1bb8 0F20A0E3 		mov	r2, #15
 5395 1bbc 88329FE5 		ldr	r3, .L110+20
 5396 1bc0 FEFFFFEB 		bl	Lcd_DspAscII6x8
 649:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5397              		.loc 1 649 0
 5398 1bc4 30301BE5 		ldr	r3, [fp, #-48]
 5399 1bc8 033043E2 		sub	r3, r3, #3
 5400 1bcc 18300BE5 		str	r3, [fp, #-24]
 5401 1bd0 560000EA 		b	.L100
 5402              	.L104:
 650:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5403              		.loc 1 650 0
 5404 1bd4 34301BE5 		ldr	r3, [fp, #-52]
 5405 1bd8 033043E2 		sub	r3, r3, #3
 5406 1bdc 1C300BE5 		str	r3, [fp, #-28]
 5407 1be0 4A0000EA 		b	.L101
 5408              	.L103:
 651:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 5409              		.loc 1 651 0
 5410 1be4 18301BE5 		ldr	r3, [fp, #-24]
 5411 1be8 000053E3 		cmp	r3, #0
 5412 1bec 440000BA 		blt	.L102
 651:../tp.c       ****                     if (px >= 0 && px < SCR_XSIZE && py >= 0 && py < SCR_YSIZE)
 5413              		.loc 1 651 0 is_stmt 0 discriminator 1
 5414 1bf0 18201BE5 		ldr	r2, [fp, #-24]
 5415 1bf4 48329FE5 		ldr	r3, .L110+12
 5416 1bf8 030052E1 		cmp	r2, r3
 5417 1bfc 400000CA 		bgt	.L102
 5418 1c00 1C301BE5 		ldr	r3, [fp, #-28]
 5419 1c04 000053E3 		cmp	r3, #0
 5420 1c08 3D0000BA 		blt	.L102
 5421 1c0c 1C301BE5 		ldr	r3, [fp, #-28]
 5422 1c10 EF0053E3 		cmp	r3, #239
 5423 1c14 3A0000CA 		bgt	.L102
 652:../tp.c       ****                         (LCD_PutPixel(px, py, 0xf));
 5424              		.loc 1 652 0 is_stmt 1
 5425 1c18 1C201BE5 		ldr	r2, [fp, #-28]
 5426 1c1c 0230A0E1 		mov	r3, r2
 5427 1c20 0331A0E1 		mov	r3, r3, asl #2
 5428 1c24 023083E0 		add	r3, r3, r2
 5429 1c28 0333A0E1 		mov	r3, r3, asl #6
 5430 1c2c A32FA0E1 		mov	r2, r3, lsr #31
 5431 1c30 033082E0 		add	r3, r2, r3
 5432 1c34 C330A0E1 		mov	r3, r3, asr #1
 5433 1c38 C32683E2 		add	r2, r3, #204472320
 5434 1c3c 962C82E2 		add	r2, r2, #38400
 5435 1c40 18301BE5 		ldr	r3, [fp, #-24]
 5436 1c44 071083E2 		add	r1, r3, #7
 5437 1c48 000053E3 		cmp	r3, #0
 5438 1c4c 0130A0B1 		movlt	r3, r1
 5439 1c50 C331A0E1 		mov	r3, r3, asr #3
 5440 1c54 0331A0E1 		mov	r3, r3, asl #2
 5441 1c58 033082E0 		add	r3, r2, r3
 5442 1c5c 0310A0E1 		mov	r1, r3
 5443 1c60 1C201BE5 		ldr	r2, [fp, #-28]
 5444 1c64 0230A0E1 		mov	r3, r2
 5445 1c68 0331A0E1 		mov	r3, r3, asl #2
 5446 1c6c 023083E0 		add	r3, r3, r2
 5447 1c70 0333A0E1 		mov	r3, r3, asl #6
 5448 1c74 A32FA0E1 		mov	r2, r3, lsr #31
 5449 1c78 033082E0 		add	r3, r2, r3
 5450 1c7c C330A0E1 		mov	r3, r3, asr #1
 5451 1c80 C32683E2 		add	r2, r3, #204472320
 5452 1c84 962C82E2 		add	r2, r2, #38400
 5453 1c88 18301BE5 		ldr	r3, [fp, #-24]
 5454 1c8c 070083E2 		add	r0, r3, #7
 5455 1c90 000053E3 		cmp	r3, #0
 5456 1c94 0030A0B1 		movlt	r3, r0
 5457 1c98 C331A0E1 		mov	r3, r3, asr #3
 5458 1c9c 0331A0E1 		mov	r3, r3, asl #2
 5459 1ca0 033082E0 		add	r3, r2, r3
 5460 1ca4 000093E5 		ldr	r0, [r3, #0]
 5461 1ca8 18201BE5 		ldr	r2, [fp, #-24]
 5462 1cac C23FA0E1 		mov	r3, r2, asr #31
 5463 1cb0 A33EA0E1 		mov	r3, r3, lsr #29
 5464 1cb4 032082E0 		add	r2, r2, r3
 5465 1cb8 072002E2 		and	r2, r2, #7
 5466 1cbc 023063E0 		rsb	r3, r3, r2
 5467 1cc0 0331A0E1 		mov	r3, r3, asl #2
 5468 1cc4 0F22A0E3 		mov	r2, #-268435456
 5469 1cc8 3233A0E1 		mov	r3, r2, lsr r3
 5470 1ccc 0330E0E1 		mvn	r3, r3
 5471 1cd0 030000E0 		and	r0, r0, r3
 5472 1cd4 18201BE5 		ldr	r2, [fp, #-24]
 5473 1cd8 C23FA0E1 		mov	r3, r2, asr #31
 5474 1cdc A33EA0E1 		mov	r3, r3, lsr #29
 5475 1ce0 032082E0 		add	r2, r2, r3
 5476 1ce4 072002E2 		and	r2, r2, #7
 5477 1ce8 023063E0 		rsb	r3, r3, r2
 5478 1cec 073063E2 		rsb	r3, r3, #7
 5479 1cf0 0331A0E1 		mov	r3, r3, asl #2
 5480 1cf4 0F20A0E3 		mov	r2, #15
 5481 1cf8 1233A0E1 		mov	r3, r2, asl r3
 5482 1cfc 033080E1 		orr	r3, r0, r3
 5483 1d00 003081E5 		str	r3, [r1, #0]
 5484              	.L102:
 650:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5485              		.loc 1 650 0
 5486 1d04 1C301BE5 		ldr	r3, [fp, #-28]
 5487 1d08 013083E2 		add	r3, r3, #1
 5488 1d0c 1C300BE5 		str	r3, [fp, #-28]
 5489              	.L101:
 650:../tp.c       ****                 for (py = y-3; py <= y+3; py++)
 5490              		.loc 1 650 0 is_stmt 0 discriminator 1
 5491 1d10 34301BE5 		ldr	r3, [fp, #-52]
 5492 1d14 032083E2 		add	r2, r3, #3
 5493 1d18 1C301BE5 		ldr	r3, [fp, #-28]
 5494 1d1c 030052E1 		cmp	r2, r3
 5495 1d20 AFFFFFAA 		bge	.L103
 649:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5496              		.loc 1 649 0 is_stmt 1
 5497 1d24 18301BE5 		ldr	r3, [fp, #-24]
 5498 1d28 013083E2 		add	r3, r3, #1
 5499 1d2c 18300BE5 		str	r3, [fp, #-24]
 5500              	.L100:
 649:../tp.c       ****             for (px = x-3; px <= x+3; px++)
 5501              		.loc 1 649 0 is_stmt 0 discriminator 1
 5502 1d30 30301BE5 		ldr	r3, [fp, #-48]
 5503 1d34 032083E2 		add	r2, r3, #3
 5504 1d38 18301BE5 		ldr	r3, [fp, #-24]
 5505 1d3c 030052E1 		cmp	r2, r3
 5506 1d40 A3FFFFAA 		bge	.L104
 655:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 5507              		.loc 1 655 0 is_stmt 1
 5508 1d44 20301BE5 		ldr	r3, [fp, #-32]
 5509 1d48 1E2043E2 		sub	r2, r3, #30
 5510 1d4c 30301BE5 		ldr	r3, [fp, #-48]
 5511 1d50 030052E1 		cmp	r2, r3
 5512 1d54 140000CA 		bgt	.L105
 655:../tp.c       ****             if (x >= (num1_x-30) && x <= (num1_x+30) && y >= (num1_y-30) && y <= (num1_y+30))
 5513              		.loc 1 655 0 is_stmt 0 discriminator 1
 5514 1d58 20301BE5 		ldr	r3, [fp, #-32]
 5515 1d5c 1E2083E2 		add	r2, r3, #30
 5516 1d60 30301BE5 		ldr	r3, [fp, #-48]
 5517 1d64 030052E1 		cmp	r2, r3
 5518 1d68 0F0000BA 		blt	.L105
 5519 1d6c 24301BE5 		ldr	r3, [fp, #-36]
 5520 1d70 1E2043E2 		sub	r2, r3, #30
 5521 1d74 34301BE5 		ldr	r3, [fp, #-52]
 5522 1d78 030052E1 		cmp	r2, r3
 5523 1d7c 0A0000CA 		bgt	.L105
 5524 1d80 24301BE5 		ldr	r3, [fp, #-36]
 5525 1d84 1E2083E2 		add	r2, r3, #30
 5526 1d88 34301BE5 		ldr	r3, [fp, #-52]
 5527 1d8c 030052E1 		cmp	r2, r3
 5528 1d90 050000BA 		blt	.L105
 657:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 1");
 5529              		.loc 1 657 0 is_stmt 1
 5530 1d94 5000A0E3 		mov	r0, #80
 5531 1d98 BE10A0E3 		mov	r1, #190
 5532 1d9c 0F20A0E3 		mov	r2, #15
 5533 1da0 A8309FE5 		ldr	r3, .L110+24
 5534 1da4 FEFFFFEB 		bl	Lcd_DspAscII8x16
 5535 1da8 1E0000EA 		b	.L106
 5536              	.L105:
 659:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 5537              		.loc 1 659 0
 5538 1dac 28301BE5 		ldr	r3, [fp, #-40]
 5539 1db0 1E2043E2 		sub	r2, r3, #30
 5540 1db4 30301BE5 		ldr	r3, [fp, #-48]
 5541 1db8 030052E1 		cmp	r2, r3
 5542 1dbc 140000CA 		bgt	.L107
 659:../tp.c       ****             else if (x >= (num2_x-30) && x <= (num2_x+30) && y >= (num2_y-30) && y <= (num2_y+30))
 5543              		.loc 1 659 0 is_stmt 0 discriminator 1
 5544 1dc0 28301BE5 		ldr	r3, [fp, #-40]
 5545 1dc4 1E2083E2 		add	r2, r3, #30
 5546 1dc8 30301BE5 		ldr	r3, [fp, #-48]
 5547 1dcc 030052E1 		cmp	r2, r3
 5548 1dd0 0F0000BA 		blt	.L107
 5549 1dd4 2C301BE5 		ldr	r3, [fp, #-44]
 5550 1dd8 1E2043E2 		sub	r2, r3, #30
 5551 1ddc 34301BE5 		ldr	r3, [fp, #-52]
 5552 1de0 030052E1 		cmp	r2, r3
 5553 1de4 0A0000CA 		bgt	.L107
 5554 1de8 2C301BE5 		ldr	r3, [fp, #-44]
 5555 1dec 1E2083E2 		add	r2, r3, #30
 5556 1df0 34301BE5 		ldr	r3, [fp, #-52]
 5557 1df4 030052E1 		cmp	r2, r3
 5558 1df8 050000BA 		blt	.L107
 661:../tp.c       ****                 Lcd_DspAscII8x16(80, 190, BLACK, (unsigned char *)"NUMERO 2");
 5559              		.loc 1 661 0 is_stmt 1
 5560 1dfc 5000A0E3 		mov	r0, #80
 5561 1e00 BE10A0E3 		mov	r1, #190
 5562 1e04 0F20A0E3 		mov	r2, #15
 5563 1e08 44309FE5 		ldr	r3, .L110+28
 5564 1e0c FEFFFFEB 		bl	Lcd_DspAscII8x16
 5565 1e10 040000EA 		b	.L106
 5566              	.L107:
 665:../tp.c       ****                 Lcd_DspAscII6x8(70, 195, BLACK, (unsigned char *)"Fuera de zona");
 5567              		.loc 1 665 0
 5568 1e14 4600A0E3 		mov	r0, #70
 5569 1e18 C310A0E3 		mov	r1, #195
 5570 1e1c 0F20A0E3 		mov	r2, #15
 5571 1e20 30309FE5 		ldr	r3, .L110+32
 5572 1e24 FEFFFFEB 		bl	Lcd_DspAscII6x8
 5573              	.L106:
 668:../tp.c       ****             Lcd_Dma_Trans();
 5574              		.loc 1 668 0
 5575 1e28 FEFFFFEB 		bl	Lcd_Dma_Trans
 669:../tp.c       ****             Delay(50);
 5576              		.loc 1 669 0
 5577 1e2c 3200A0E3 		mov	r0, #50
 5578 1e30 FEFFFFEB 		bl	Delay
 5579              	.LBE5:
 5580              		.loc 1 671 0
 5581 1e34 0DFFFFEA 		b	.L108
 5582              	.L111:
 5583              		.align	2
 5584              	.L110:
 5585 1e38 04000000 		.word	.LC1
 5586 1e3c 08000000 		.word	.LC2
 5587 1e40 60010000 		.word	.LC33
 5588 1e44 3F010000 		.word	319
 5589 1e48 70010000 		.word	.LC34
 5590 1e4c 84010000 		.word	.LC35
 5591 1e50 9C010000 		.word	.LC36
 5592 1e54 A8010000 		.word	.LC37
 5593 1e58 B4010000 		.word	.LC38
 5594              		.cfi_endproc
 5595              	.LFE16:
 5597              		.bss
 5598              		.align	2
 5599              	count.4583:
 5600 0028 00000000 		.space	4
 5601              		.text
 5602              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 tp.c
                            *COM*:00000004 CheckTSP
                            *COM*:00000004 oneTouch
                            *COM*:00000004 Vx
                            *COM*:00000004 Vy
                            *COM*:00000004 Xmax
                            *COM*:00000004 Ymax
                            *COM*:00000004 Xmin
                            *COM*:00000004 Ymin
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2712   .bss:00000000 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2713   .bss:00000000 g_swap_xy
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2716   .bss:00000004 g_kx_fp
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2719   .bss:00000008 g_ky_fp
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2722   .bss:0000000c g_ts_xc
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2725   .bss:00000010 g_ts_yc
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2728   .bss:00000014 g_lcd_xc
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2731   .bss:00000018 g_lcd_yc
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2734   .bss:0000001c g_ts_ready
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2737   .bss:00000020 g_ts_raw_x
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2740   .bss:00000024 g_ts_raw_y
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2743   .text:00000000 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2746   .text:00000000 TS_Test
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3274   .text:000004f0 Lcd_TC
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3087   .text:000003c4 TS_init
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3674   .text:0000099c Check_Sel
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:2780   .text:00000024 TSInt
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4051   .text:00000dd0 report_touch_data
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3557   .text:00000868 DesignREC
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3071   .text:0000039c $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3084   .text:000003c4 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3164   .text:00000480 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3179   .text:000004b0 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3182   .text:000004b0 TS_close
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3216   .text:000004e8 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3222   .rodata:00000000 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3271   .text:000004f0 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3534   .text:00000824 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3554   .text:00000868 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3660   .text:0000097c $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3671   .text:0000099c $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3764   .text:00000a80 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3776   .text:00000aa4 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3778   .text:00000aa4 clamp
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:3830   .text:00000b04 draw_cross
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4044   .text:00000dcc $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4048   .text:00000dd0 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4096   .text:00000e28 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4102   .text:00000e34 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4104   .text:00000e34 ts_wait_for_touch
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4140   .text:00000e6c $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4144   .text:00000e70 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4146   .text:00000e70 ts_read_raw
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4185   .text:00000eb8 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4190   .text:00000ec0 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4192   .text:00000ec0 get_cal_point
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4295   .text:00000fcc $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4350   .text:00000fd0 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4353   .text:00000fd0 ts_calibrate_5pt
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4830   .text:00001590 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4856   .text:000015ec $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:4859   .text:000015ec ts_read_calibrated
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5025   .text:000017cc $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5044   .text:000017f8 $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5047   .text:000017f8 ts_test_calibracion
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5193   .text:000019a4 $d
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5599   .bss:00000028 count.4583
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5218   .text:000019ac $a
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5221   .text:000019ac ts_test_numeros
C:\Users\jaime\AppData\Local\Temp\ccNXCBrr.s:5585   .text:00001e38 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
__aeabi_uidiv
DelayTime
Lcd_Init
Lcd_Clr
Lcd_Active_Clr
Lcd_Draw_Box
Lcd_DspAscII6x8
Lcd_Dma_Trans
Delay
__aeabi_ldivmod
Lcd_DspAscII8x16
